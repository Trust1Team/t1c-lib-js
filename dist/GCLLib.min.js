var GCLLib=function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(3);t.GCLConfig=a.GCLConfig;var i=r(4),o=r(10),u=r(36),s=r(37),l=r(6),c=r(38),f=r(163),h=function(){function e(t,r){var n=this;this.core=function(){return n.coreService},this.config=function(){return n.cfg},this.ds=function(){return n.dsClient},this.ocv=function(){return n.ocvClient},this.beid=function(e){return n.pluginFactory.createEidBE(e)},this.dni=function(e){return n.pluginFactory.createDNI(e)},this.luxeid=function(e,t){return n.pluginFactory.createEidLUX(e,t)},this.luxtrust=function(e,t){return n.pluginFactory.createLuxTrust(e)},this.emv=function(e){return n.pluginFactory.createEmv(e)},this.mobib=function(e){return n.pluginFactory.createMobib(e)},this.ocra=function(e){return n.pluginFactory.createOcra(e)},this.aventra=function(e){return n.pluginFactory.createAventraNO(e)},this.oberthur=function(e){return n.pluginFactory.createOberthurNO(e)},this.piv=function(e){return n.pluginFactory.createPIV(e)},this.safenet=function(e,t){return n.pluginFactory.createSafeNet(t)};var a=this;this.cfg=e.resolveConfig(t),this.connection=new o.LocalConnection(this.cfg),this.authConnection=new o.LocalAuthConnection(this.cfg),this.remoteConnection=new o.RemoteConnection(this.cfg),this.localTestConnection=new o.LocalTestConnection(this.cfg),this.pluginFactory=new c.PluginFactory(this.cfg.gclUrl,this.connection),this.coreService=new i.CoreService(this.cfg.gclUrl,this.authConnection),this.cfg.localTestMode?this.dsClient=new u.DSClient(this.cfg.dsUrl,this.localTestConnection,this.cfg):this.dsClient=new u.DSClient(this.cfg.dsUrl,this.remoteConnection,this.cfg),this.ocvClient=new s.OCVClient(this.cfg.ocvUrl,this.remoteConnection),this.cfg.implicitDownload&&this.implicitDownload(),r||this.initSecurityContext(function(e){e||a.registerAndActivate()}),this.initOCVContext(function(e){})}return e.initialize=function(t,r){function n(n,a){var i=new e(t,!0);i.initSecurityContext(function(e){e?a?a(e):r(e,null):i.registerAndActivate().then(function(){n?n(i):r(null,i)},function(e){a?a(e):r(e,null)})})}return r?void n():new l.Promise(function(e,t){n(e,t)})},e.resolveConfig=function(e){var t=new a.GCLConfig(e.dsUrlBase,e.apiKey);return t.allowAutoUpdate=e.allowAutoUpdate,t.client_id=e.client_id,t.client_secret=e.client_secret,t.jwt=e.jwt,t.gclUrl=e.gclUrl,t.implicitDownload=e.implicitDownload,t.localTestMode=e.localTestMode,t.forceHardwarePinpad=e.forceHardwarePinpad,t},e.prototype.readersCanAuthenticate=function(e){return f.GenericService.authenticateCapable(this,e)},e.prototype.authenticate=function(e,t,r){return f.GenericService.authenticate(this,e,t,r)},e.prototype.readersCanSign=function(e){return f.GenericService.signCapable(this,e)},e.prototype.sign=function(e,t,r){return f.GenericService.sign(this,e,t,r)},e.prototype.readersCanVerifyPin=function(e){return f.GenericService.verifyPinCapable(this,e)},e.prototype.verifyPin=function(e,t,r){return f.GenericService.verifyPin(this,e,t,r)},e.prototype.initOCVContext=function(e){return this.ocvClient.getInfo(e)},e.prototype.initSecurityContext=function(e){var t=this,r=e;this.core().getPubKey(function(n){return n&&n.data&&!n.data.success&&t.dsClient.getPubKey(function(e,a){if(e)return r(n,null);var i=r;t.core().setPubKey(a.pubkey,function(e){return e?i(n,null):i(null,{})})}),e(null,{})})},e.prototype.registerAndActivate=function(){var e=this,t=this.cfg;return new l.Promise(function(r,a){e.core().info(function(u,s){if(u)return void a(u);var l=s.data.activated,c=s.data.managed,f=s.data.version,h=s.data.uid,m=e.core().infoBrowserSync(),d=n.merge({managed:c,core_version:f,activated:l},m.data);l?e.dsClient.sync(d,h,function(e,n){return e?void a(e):(t.jwt=n.token,void r())}):e.dsClient.register(d,h,function(n,s){return u?void a(u):(t.jwt=s.token,e.authConnection=new o.LocalAuthConnection(e.cfg),e.coreService=new i.CoreService(e.cfg.gclUrl,e.authConnection),void e.core().activate(function(t){return t?void a(u):(d.activated=!0,void e.dsClient.sync(d,h,function(e){return e?void a(e):void r()}))}))})})})},e.prototype.implicitDownload=function(){var e=this;this.core().info(function(t){if(t){var r=e.core().infoBrowserSync();e.ds().downloadLink(r,function(e,t){window.open(t.url)})}})},e}();t.GCLClient=h},function(e,t,r){var n;(function(e,a){(function(){function i(e,t){return e.set(t[0],t[1]),e}function o(e,t){return e.add(t),e}function u(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function s(e,t,r,n){for(var a=-1,i=null==e?0:e.length;++a<i;){var o=e[a];t(n,o,r(o),e)}return n}function l(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}function c(e,t){for(var r=null==e?0:e.length;r--&&t(e[r],r,e)!==!1;);return e}function f(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function h(e,t){for(var r=-1,n=null==e?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}function m(e,t){var r=null==e?0:e.length;return!!r&&P(e,t,0)>-1}function d(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}function v(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}function p(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}function g(e,t,r,n){var a=-1,i=null==e?0:e.length;for(n&&i&&(r=e[++a]);++a<i;)r=t(r,e[a],a,e);return r}function y(e,t,r,n){var a=null==e?0:e.length;for(n&&a&&(r=e[--a]);a--;)r=t(r,e[a],a,e);return r}function b(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function w(e){return e.split("")}function k(e){return e.match(Lt)||[]}function S(e,t,r){var n;return r(e,function(e,r,a){if(t(e,r,a))return n=r,!1}),n}function C(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}function P(e,t,r){return t===t?X(e,t,r):C(e,I,r)}function A(e,t,r,n){for(var a=r-1,i=e.length;++a<i;)if(n(e[a],t))return a;return-1}function I(e){return e!==e}function _(e,t){var r=null==e?0:e.length;return r?j(e,t)/r:Te}function O(e){return function(t){return null==t?ae:t[e]}}function B(e){return function(t){return null==e?ae:e[t]}}function E(e,t,r,n,a){return a(e,function(e,a,i){r=n?(n=!1,e):t(r,e,a,i)}),r}function N(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function j(e,t){for(var r,n=-1,a=e.length;++n<a;){var i=t(e[n]);i!==ae&&(r=r===ae?i:r+i)}return r}function V(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function x(e,t){return v(t,function(t){return[t,e[t]]})}function R(e){return function(t){return e(t)}}function D(e,t){return v(t,function(t){return e[t]})}function T(e,t){return e.has(t)}function U(e,t){for(var r=-1,n=e.length;++r<n&&P(t,e[r],0)>-1;);return r}function H(e,t){for(var r=e.length;r--&&P(t,e[r],0)>-1;);return r}function K(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}function q(e){return"\\"+tn[e]}function M(e,t){return null==e?ae:e[t]}function L(e){return Wr.test(e)}function J(e){return Gr.test(e)}function F(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}function W(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function G(e,t){return function(r){return e(t(r))}}function z(e,t){for(var r=-1,n=e.length,a=0,i=[];++r<n;){var o=e[r];o!==t&&o!==fe||(e[r]=fe,i[a++]=r)}return i}function $(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}function Q(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=[e,e]}),r}function X(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}function Y(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}function Z(e){return L(e)?te(e):bn(e)}function ee(e){return L(e)?re(e):w(e)}function te(e){for(var t=Jr.lastIndex=0;Jr.test(e);)++t;return t}function re(e){return e.match(Jr)||[]}function ne(e){return e.match(Fr)||[]}var ae,ie="4.17.4",oe=200,ue="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",se="Expected a function",le="__lodash_hash_undefined__",ce=500,fe="__lodash_placeholder__",he=1,me=2,de=4,ve=1,pe=2,ge=1,ye=2,be=4,we=8,ke=16,Se=32,Ce=64,Pe=128,Ae=256,Ie=512,_e=30,Oe="...",Be=800,Ee=16,Ne=1,je=2,Ve=3,xe=1/0,Re=9007199254740991,De=1.7976931348623157e308,Te=NaN,Ue=4294967295,He=Ue-1,Ke=Ue>>>1,qe=[["ary",Pe],["bind",ge],["bindKey",ye],["curry",we],["curryRight",ke],["flip",Ie],["partial",Se],["partialRight",Ce],["rearg",Ae]],Me="[object Arguments]",Le="[object Array]",Je="[object AsyncFunction]",Fe="[object Boolean]",We="[object Date]",Ge="[object DOMException]",ze="[object Error]",$e="[object Function]",Qe="[object GeneratorFunction]",Xe="[object Map]",Ye="[object Number]",Ze="[object Null]",et="[object Object]",tt="[object Promise]",rt="[object Proxy]",nt="[object RegExp]",at="[object Set]",it="[object String]",ot="[object Symbol]",ut="[object Undefined]",st="[object WeakMap]",lt="[object WeakSet]",ct="[object ArrayBuffer]",ft="[object DataView]",ht="[object Float32Array]",mt="[object Float64Array]",dt="[object Int8Array]",vt="[object Int16Array]",pt="[object Int32Array]",gt="[object Uint8Array]",yt="[object Uint8ClampedArray]",bt="[object Uint16Array]",wt="[object Uint32Array]",kt=/\b__p \+= '';/g,St=/\b(__p \+=) '' \+/g,Ct=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pt=/&(?:amp|lt|gt|quot|#39);/g,At=/[&<>"']/g,It=RegExp(Pt.source),_t=RegExp(At.source),Ot=/<%-([\s\S]+?)%>/g,Bt=/<%([\s\S]+?)%>/g,Et=/<%=([\s\S]+?)%>/g,Nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jt=/^\w*$/,Vt=/^\./,xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rt=/[\\^$.*+?()[\]{}|]/g,Dt=RegExp(Rt.source),Tt=/^\s+|\s+$/g,Ut=/^\s+/,Ht=/\s+$/,Kt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qt=/\{\n\/\* \[wrapped with (.+)\] \*/,Mt=/,? & /,Lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Jt=/\\(\\)?/g,Ft=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Wt=/\w*$/,Gt=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,$t=/^\[object .+?Constructor\]$/,Qt=/^0o[0-7]+$/i,Xt=/^(?:0|[1-9]\d*)$/,Yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,er=/['\n\r\u2028\u2029\\]/g,tr="\\ud800-\\udfff",rr="\\u0300-\\u036f",nr="\\ufe20-\\ufe2f",ar="\\u20d0-\\u20ff",ir=rr+nr+ar,or="\\u2700-\\u27bf",ur="a-z\\xdf-\\xf6\\xf8-\\xff",sr="\\xac\\xb1\\xd7\\xf7",lr="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cr="\\u2000-\\u206f",fr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hr="A-Z\\xc0-\\xd6\\xd8-\\xde",mr="\\ufe0e\\ufe0f",dr=sr+lr+cr+fr,vr="['’]",pr="["+tr+"]",gr="["+dr+"]",yr="["+ir+"]",br="\\d+",wr="["+or+"]",kr="["+ur+"]",Sr="[^"+tr+dr+br+or+ur+hr+"]",Cr="\\ud83c[\\udffb-\\udfff]",Pr="(?:"+yr+"|"+Cr+")",Ar="[^"+tr+"]",Ir="(?:\\ud83c[\\udde6-\\uddff]){2}",_r="[\\ud800-\\udbff][\\udc00-\\udfff]",Or="["+hr+"]",Br="\\u200d",Er="(?:"+kr+"|"+Sr+")",Nr="(?:"+Or+"|"+Sr+")",jr="(?:"+vr+"(?:d|ll|m|re|s|t|ve))?",Vr="(?:"+vr+"(?:D|LL|M|RE|S|T|VE))?",xr=Pr+"?",Rr="["+mr+"]?",Dr="(?:"+Br+"(?:"+[Ar,Ir,_r].join("|")+")"+Rr+xr+")*",Tr="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Ur="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Hr=Rr+xr+Dr,Kr="(?:"+[wr,Ir,_r].join("|")+")"+Hr,qr="(?:"+[Ar+yr+"?",yr,Ir,_r,pr].join("|")+")",Mr=RegExp(vr,"g"),Lr=RegExp(yr,"g"),Jr=RegExp(Cr+"(?="+Cr+")|"+qr+Hr,"g"),Fr=RegExp([Or+"?"+kr+"+"+jr+"(?="+[gr,Or,"$"].join("|")+")",Nr+"+"+Vr+"(?="+[gr,Or+Er,"$"].join("|")+")",Or+"?"+Er+"+"+jr,Or+"+"+Vr,Ur,Tr,br,Kr].join("|"),"g"),Wr=RegExp("["+Br+tr+ir+mr+"]"),Gr=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,zr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$r=-1,Qr={};Qr[ht]=Qr[mt]=Qr[dt]=Qr[vt]=Qr[pt]=Qr[gt]=Qr[yt]=Qr[bt]=Qr[wt]=!0,Qr[Me]=Qr[Le]=Qr[ct]=Qr[Fe]=Qr[ft]=Qr[We]=Qr[ze]=Qr[$e]=Qr[Xe]=Qr[Ye]=Qr[et]=Qr[nt]=Qr[at]=Qr[it]=Qr[st]=!1;var Xr={};Xr[Me]=Xr[Le]=Xr[ct]=Xr[ft]=Xr[Fe]=Xr[We]=Xr[ht]=Xr[mt]=Xr[dt]=Xr[vt]=Xr[pt]=Xr[Xe]=Xr[Ye]=Xr[et]=Xr[nt]=Xr[at]=Xr[it]=Xr[ot]=Xr[gt]=Xr[yt]=Xr[bt]=Xr[wt]=!0,Xr[ze]=Xr[$e]=Xr[st]=!1;var Yr={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Zr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},en={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rn=parseFloat,nn=parseInt,an="object"==typeof e&&e&&e.Object===Object&&e,on="object"==typeof self&&self&&self.Object===Object&&self,un=an||on||Function("return this")(),sn="object"==typeof t&&t&&!t.nodeType&&t,ln=sn&&"object"==typeof a&&a&&!a.nodeType&&a,cn=ln&&ln.exports===sn,fn=cn&&an.process,hn=function(){try{return fn&&fn.binding&&fn.binding("util")}catch(e){}}(),mn=hn&&hn.isArrayBuffer,dn=hn&&hn.isDate,vn=hn&&hn.isMap,pn=hn&&hn.isRegExp,gn=hn&&hn.isSet,yn=hn&&hn.isTypedArray,bn=O("length"),wn=B(Yr),kn=B(Zr),Sn=B(en),Cn=function e(t){function r(e){if(ls(e)&&!kh(e)&&!(e instanceof w)){if(e instanceof a)return e;if(wc.call(e,"__wrapped__"))return io(e)}return new a(e)}function n(){}function a(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=ae}function w(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ue,this.__views__=[]}function B(){var e=new w(this.__wrapped__);return e.__actions__=Ka(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ka(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ka(this.__views__),e}function X(){if(this.__filtered__){var e=new w(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function te(){var e=this.__wrapped__.value(),t=this.__dir__,r=kh(e),n=t<0,a=r?e.length:0,i=Bi(0,a,this.__views__),o=i.start,u=i.end,s=u-o,l=n?u:o-1,c=this.__iteratees__,f=c.length,h=0,m=Qc(s,this.__takeCount__);if(!r||!n&&a==s&&m==s)return ka(e,this.__actions__);var d=[];e:for(;s--&&h<m;){l+=t;for(var v=-1,p=e[l];++v<f;){var g=c[v],y=g.iteratee,b=g.type,w=y(p);if(b==je)p=w;else if(!w){if(b==Ne)continue e;break e}}d[h++]=p}return d}function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Lt(){this.__data__=uf?uf(null):{},this.size=0}function tr(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function rr(e){var t=this.__data__;if(uf){var r=t[e];return r===le?ae:r}return wc.call(t,e)?t[e]:ae}function nr(e){var t=this.__data__;return uf?t[e]!==ae:wc.call(t,e)}function ar(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=uf&&t===ae?le:t,this}function ir(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function or(){this.__data__=[],this.size=0}function ur(e){var t=this.__data__,r=jr(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():xc.call(t,r,1),--this.size,!0}function sr(e){var t=this.__data__,r=jr(t,e);return r<0?ae:t[r][1]}function lr(e){return jr(this.__data__,e)>-1}function cr(e,t){var r=this.__data__,n=jr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function hr(){this.size=0,this.__data__={hash:new re,map:new(rf||ir),string:new re}}function mr(e){var t=Ai(this,e).delete(e);return this.size-=t?1:0,t}function dr(e){return Ai(this,e).get(e)}function vr(e){return Ai(this,e).has(e)}function pr(e,t){var r=Ai(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function gr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new fr;++t<r;)this.add(e[t])}function yr(e){return this.__data__.set(e,le),this}function br(e){return this.__data__.has(e)}function wr(e){var t=this.__data__=new ir(e);this.size=t.size}function kr(){this.__data__=new ir,this.size=0}function Sr(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function Cr(e){return this.__data__.get(e)}function Pr(e){return this.__data__.has(e)}function Ar(e,t){var r=this.__data__;if(r instanceof ir){var n=r.__data__;if(!rf||n.length<oe-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new fr(n)}return r.set(e,t),this.size=r.size,this}function Ir(e,t){var r=kh(e),n=!r&&wh(e),a=!r&&!n&&Ch(e),i=!r&&!n&&!a&&Oh(e),o=r||n||a||i,u=o?V(e.length,mc):[],s=u.length;for(var l in e)!t&&!wc.call(e,l)||o&&("length"==l||a&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ti(l,s))||u.push(l);return u}function _r(e){var t=e.length;return t?e[ra(0,t-1)]:ae}function Or(e,t){return to(Ka(e),Ur(t,0,e.length))}function Br(e){return to(Ka(e))}function Er(e,t,r){(r===ae||$u(e[t],r))&&(r!==ae||t in e)||Dr(e,t,r)}function Nr(e,t,r){var n=e[t];wc.call(e,t)&&$u(n,r)&&(r!==ae||t in e)||Dr(e,t,r)}function jr(e,t){for(var r=e.length;r--;)if($u(e[r][0],t))return r;return-1}function Vr(e,t,r,n){return bf(e,function(e,a,i){t(n,e,r(e),i)}),n}function xr(e,t){return e&&qa(t,Js(t),e)}function Rr(e,t){return e&&qa(t,Fs(t),e)}function Dr(e,t,r){"__proto__"==t&&Uc?Uc(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Tr(e,t){for(var r=-1,n=t.length,a=oc(n),i=null==e;++r<n;)a[r]=i?ae:qs(e,t[r]);return a}function Ur(e,t,r){return e===e&&(r!==ae&&(e=e<=r?e:r),t!==ae&&(e=e>=t?e:t)),e}function Hr(e,t,r,n,a,i){var o,u=t&he,s=t&me,c=t&de;if(r&&(o=a?r(e,n,a,i):r(e)),o!==ae)return o;if(!ss(e))return e;var f=kh(e);if(f){if(o=ji(e),!u)return Ka(e,o)}else{var h=Nf(e),m=h==$e||h==Qe;if(Ch(e))return Oa(e,u);if(h==et||h==Me||m&&!a){if(o=s||m?{}:Vi(e),!u)return s?La(e,Rr(o,e)):Ma(e,xr(o,e))}else{if(!Xr[h])return a?e:{};o=xi(e,h,Hr,u)}}i||(i=new wr);var d=i.get(e);if(d)return d;i.set(e,o);var v=c?s?ki:wi:s?Fs:Js,p=f?ae:v(e);return l(p||e,function(n,a){p&&(a=n,n=e[a]),Nr(o,a,Hr(n,t,r,a,e,i))}),o}function Kr(e){var t=Js(e);return function(r){return qr(r,e,t)}}function qr(e,t,r){var n=r.length;if(null==e)return!n;for(e=fc(e);n--;){var a=r[n],i=t[a],o=e[a];if(o===ae&&!(a in e)||!i(o))return!1}return!0}function Jr(e,t,r){if("function"!=typeof e)throw new dc(se);return xf(function(){e.apply(ae,r)},t)}function Fr(e,t,r,n){var a=-1,i=m,o=!0,u=e.length,s=[],l=t.length;if(!u)return s;r&&(t=v(t,R(r))),n?(i=d,o=!1):t.length>=oe&&(i=T,o=!1,t=new gr(t));e:for(;++a<u;){var c=e[a],f=null==r?c:r(c);if(c=n||0!==c?c:0,o&&f===f){for(var h=l;h--;)if(t[h]===f)continue e;s.push(c)}else i(t,f,n)||s.push(c)}return s}function Wr(e,t){var r=!0;return bf(e,function(e,n,a){return r=!!t(e,n,a)}),r}function Gr(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(null!=o&&(u===ae?o===o&&!ws(o):r(o,u)))var u=o,s=i}return s}function Yr(e,t,r,n){var a=e.length;for(r=Is(r),r<0&&(r=-r>a?0:a+r),n=n===ae||n>a?a:Is(n),n<0&&(n+=a),n=r>n?0:_s(n);r<n;)e[r++]=t;return e}function Zr(e,t){var r=[];return bf(e,function(e,n,a){t(e,n,a)&&r.push(e)}),r}function en(e,t,r,n,a){var i=-1,o=e.length;for(r||(r=Di),a||(a=[]);++i<o;){var u=e[i];t>0&&r(u)?t>1?en(u,t-1,r,n,a):p(a,u):n||(a[a.length]=u)}return a}function tn(e,t){return e&&kf(e,t,Js)}function an(e,t){return e&&Sf(e,t,Js)}function on(e,t){return h(t,function(t){return is(e[t])})}function sn(e,t){t=Ia(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[ro(t[r++])];return r&&r==n?e:ae}function ln(e,t,r){var n=t(e);return kh(e)?n:p(n,r(e))}function fn(e){return null==e?e===ae?ut:Ze:Tc&&Tc in fc(e)?Oi(e):$i(e)}function hn(e,t){return e>t}function bn(e,t){return null!=e&&wc.call(e,t)}function Cn(e,t){return null!=e&&t in fc(e)}function An(e,t,r){return e>=Qc(t,r)&&e<$c(t,r)}function In(e,t,r){for(var n=r?d:m,a=e[0].length,i=e.length,o=i,u=oc(i),s=1/0,l=[];o--;){var c=e[o];o&&t&&(c=v(c,R(t))),s=Qc(c.length,s),u[o]=!r&&(t||a>=120&&c.length>=120)?new gr(o&&c):ae}c=e[0];var f=-1,h=u[0];e:for(;++f<a&&l.length<s;){var p=c[f],g=t?t(p):p;if(p=r||0!==p?p:0,!(h?T(h,g):n(l,g,r))){for(o=i;--o;){var y=u[o];if(!(y?T(y,g):n(e[o],g,r)))continue e}h&&h.push(g),l.push(p)}}return l}function _n(e,t,r,n){return tn(e,function(e,a,i){t(n,r(e),a,i)}),n}function On(e,t,r){t=Ia(t,e),e=Xi(e,t);var n=null==e?e:e[ro(Ao(t))];return null==n?ae:u(n,e,r)}function Bn(e){return ls(e)&&fn(e)==Me}function En(e){return ls(e)&&fn(e)==ct}function Nn(e){return ls(e)&&fn(e)==We}function jn(e,t,r,n,a){return e===t||(null==e||null==t||!ls(e)&&!ls(t)?e!==e&&t!==t:Vn(e,t,r,n,jn,a))}function Vn(e,t,r,n,a,i){var o=kh(e),u=kh(t),s=o?Le:Nf(e),l=u?Le:Nf(t);s=s==Me?et:s,l=l==Me?et:l;var c=s==et,f=l==et,h=s==l;if(h&&Ch(e)){if(!Ch(t))return!1;o=!0,c=!1}if(h&&!c)return i||(i=new wr),o||Oh(e)?pi(e,t,r,n,a,i):gi(e,t,s,r,n,a,i);if(!(r&ve)){var m=c&&wc.call(e,"__wrapped__"),d=f&&wc.call(t,"__wrapped__");if(m||d){var v=m?e.value():e,p=d?t.value():t;return i||(i=new wr),a(v,p,r,n,i)}}return!!h&&(i||(i=new wr),yi(e,t,r,n,a,i))}function xn(e){return ls(e)&&Nf(e)==Xe}function Rn(e,t,r,n){var a=r.length,i=a,o=!n;if(null==e)return!i;for(e=fc(e);a--;){var u=r[a];if(o&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<i;){u=r[a];var s=u[0],l=e[s],c=u[1];if(o&&u[2]){if(l===ae&&!(s in e))return!1}else{var f=new wr;if(n)var h=n(l,c,s,e,t,f);if(!(h===ae?jn(c,l,ve|pe,n,f):h))return!1}}return!0}function Dn(e){if(!ss(e)||Mi(e))return!1;var t=is(e)?Ic:$t;return t.test(no(e))}function Tn(e){return ls(e)&&fn(e)==nt}function Un(e){return ls(e)&&Nf(e)==at}function Hn(e){return ls(e)&&us(e.length)&&!!Qr[fn(e)]}function Kn(e){return"function"==typeof e?e:null==e?xl:"object"==typeof e?kh(e)?Wn(e[0],e[1]):Fn(e):Ml(e)}function qn(e){if(!Li(e))return zc(e);var t=[];for(var r in fc(e))wc.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Mn(e){if(!ss(e))return zi(e);var t=Li(e),r=[];for(var n in e)("constructor"!=n||!t&&wc.call(e,n))&&r.push(n);return r}function Ln(e,t){return e<t}function Jn(e,t){var r=-1,n=Qu(e)?oc(e.length):[];return bf(e,function(e,a,i){n[++r]=t(e,a,i)}),n}function Fn(e){var t=Ii(e);return 1==t.length&&t[0][2]?Fi(t[0][0],t[0][1]):function(r){return r===e||Rn(r,e,t)}}function Wn(e,t){return Hi(e)&&Ji(t)?Fi(ro(e),t):function(r){var n=qs(r,e);return n===ae&&n===t?Ls(r,e):jn(t,n,ve|pe)}}function Gn(e,t,r,n,a){e!==t&&kf(t,function(i,o){if(ss(i))a||(a=new wr),zn(e,t,o,r,Gn,n,a);else{var u=n?n(e[o],i,o+"",e,t,a):ae;u===ae&&(u=i),Er(e,o,u)}},Fs)}function zn(e,t,r,n,a,i,o){var u=e[r],s=t[r],l=o.get(s);if(l)return void Er(e,r,l);var c=i?i(u,s,r+"",e,t,o):ae,f=c===ae;if(f){var h=kh(s),m=!h&&Ch(s),d=!h&&!m&&Oh(s);c=s,h||m||d?kh(u)?c=u:Xu(u)?c=Ka(u):m?(f=!1,c=Oa(s,!0)):d?(f=!1,c=Ra(s,!0)):c=[]:gs(s)||wh(s)?(c=u,wh(u)?c=Bs(u):(!ss(u)||n&&is(u))&&(c=Vi(s))):f=!1}f&&(o.set(s,c),a(c,s,n,i,o),o.delete(s)),Er(e,r,c)}function $n(e,t){var r=e.length;if(r)return t+=t<0?r:0,Ti(t,r)?e[t]:ae}function Qn(e,t,r){var n=-1;t=v(t.length?t:[xl],R(Pi()));var a=Jn(e,function(e,r,a){var i=v(t,function(t){return t(e)});return{criteria:i,index:++n,value:e}});return N(a,function(e,t){return Ta(e,t,r)})}function Xn(e,t){return Yn(e,t,function(t,r){return Ls(e,r)})}function Yn(e,t,r){for(var n=-1,a=t.length,i={};++n<a;){var o=t[n],u=sn(e,o);r(u,o)&&sa(i,Ia(o,e),u)}return i}function Zn(e){return function(t){return sn(t,e)}}function ea(e,t,r,n){var a=n?A:P,i=-1,o=t.length,u=e;for(e===t&&(t=Ka(t)),r&&(u=v(e,R(r)));++i<o;)for(var s=0,l=t[i],c=r?r(l):l;(s=a(u,c,s,n))>-1;)u!==e&&xc.call(u,s,1),xc.call(e,s,1);return e}function ta(e,t){for(var r=e?t.length:0,n=r-1;r--;){var a=t[r];if(r==n||a!==i){var i=a;Ti(a)?xc.call(e,a,1):ya(e,a)}}return e}function ra(e,t){return e+Lc(Zc()*(t-e+1))}function na(e,t,r,n){for(var a=-1,i=$c(Mc((t-e)/(r||1)),0),o=oc(i);i--;)o[n?i:++a]=e,e+=r;return o}function aa(e,t){var r="";if(!e||t<1||t>Re)return r;do t%2&&(r+=e),t=Lc(t/2),t&&(e+=e);while(t);return r}function ia(e,t){return Rf(Qi(e,t,xl),e+"")}function oa(e){return _r(nl(e))}function ua(e,t){var r=nl(e);return to(r,Ur(t,0,r.length))}function sa(e,t,r,n){if(!ss(e))return e;t=Ia(t,e);for(var a=-1,i=t.length,o=i-1,u=e;null!=u&&++a<i;){var s=ro(t[a]),l=r;if(a!=o){var c=u[s];l=n?n(c,s,u):ae,l===ae&&(l=ss(c)?c:Ti(t[a+1])?[]:{})}Nr(u,s,l),u=u[s]}return e}function la(e){return to(nl(e))}function ca(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=oc(a);++n<a;)i[n]=e[n+t];return i}function fa(e,t){var r;return bf(e,function(e,n,a){return r=t(e,n,a),!r}),!!r}function ha(e,t,r){var n=0,a=null==e?n:e.length;if("number"==typeof t&&t===t&&a<=Ke){for(;n<a;){var i=n+a>>>1,o=e[i];null!==o&&!ws(o)&&(r?o<=t:o<t)?n=i+1:a=i}return a}return ma(e,t,xl,r)}function ma(e,t,r,n){t=r(t);for(var a=0,i=null==e?0:e.length,o=t!==t,u=null===t,s=ws(t),l=t===ae;a<i;){var c=Lc((a+i)/2),f=r(e[c]),h=f!==ae,m=null===f,d=f===f,v=ws(f);if(o)var p=n||d;else p=l?d&&(n||h):u?d&&h&&(n||!m):s?d&&h&&!m&&(n||!v):!m&&!v&&(n?f<=t:f<t);p?a=c+1:i=c}return Qc(i,He)}function da(e,t){for(var r=-1,n=e.length,a=0,i=[];++r<n;){var o=e[r],u=t?t(o):o;if(!r||!$u(u,s)){var s=u;i[a++]=0===o?0:o}}return i}function va(e){return"number"==typeof e?e:ws(e)?Te:+e}function pa(e){if("string"==typeof e)return e;if(kh(e))return v(e,pa)+"";if(ws(e))return gf?gf.call(e):"";var t=e+"";return"0"==t&&1/e==-xe?"-0":t}function ga(e,t,r){var n=-1,a=m,i=e.length,o=!0,u=[],s=u;if(r)o=!1,a=d;else if(i>=oe){var l=t?null:_f(e);if(l)return $(l);o=!1,a=T,s=new gr}else s=t?[]:u;e:for(;++n<i;){var c=e[n],f=t?t(c):c;if(c=r||0!==c?c:0,o&&f===f){for(var h=s.length;h--;)if(s[h]===f)continue e;t&&s.push(f),u.push(c)}else a(s,f,r)||(s!==u&&s.push(f),u.push(c))}return u}function ya(e,t){return t=Ia(t,e),e=Xi(e,t),null==e||delete e[ro(Ao(t))]}function ba(e,t,r,n){return sa(e,t,r(sn(e,t)),n)}function wa(e,t,r,n){for(var a=e.length,i=n?a:-1;(n?i--:++i<a)&&t(e[i],i,e););return r?ca(e,n?0:i,n?i+1:a):ca(e,n?i+1:0,n?a:i)}function ka(e,t){var r=e;return r instanceof w&&(r=r.value()),g(t,function(e,t){return t.func.apply(t.thisArg,p([e],t.args))},r)}function Sa(e,t,r){var n=e.length;if(n<2)return n?ga(e[0]):[];for(var a=-1,i=oc(n);++a<n;)for(var o=e[a],u=-1;++u<n;)u!=a&&(i[a]=Fr(i[a]||o,e[u],t,r));return ga(en(i,1),t,r)}function Ca(e,t,r){for(var n=-1,a=e.length,i=t.length,o={};++n<a;){var u=n<i?t[n]:ae;r(o,e[n],u)}return o}function Pa(e){return Xu(e)?e:[]}function Aa(e){return"function"==typeof e?e:xl}function Ia(e,t){return kh(e)?e:Hi(e,t)?[e]:Df(Ns(e))}function _a(e,t,r){var n=e.length;return r=r===ae?n:r,!t&&r>=n?e:ca(e,t,r)}function Oa(e,t){if(t)return e.slice();var r=e.length,n=Ec?Ec(r):new e.constructor(r);return e.copy(n),n}function Ba(e){var t=new e.constructor(e.byteLength);return new Bc(t).set(new Bc(e)),t}function Ea(e,t){var r=t?Ba(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function Na(e,t,r){var n=t?r(W(e),he):W(e);return g(n,i,new e.constructor)}function ja(e){var t=new e.constructor(e.source,Wt.exec(e));return t.lastIndex=e.lastIndex,t}function Va(e,t,r){var n=t?r($(e),he):$(e);return g(n,o,new e.constructor)}function xa(e){return pf?fc(pf.call(e)):{}}function Ra(e,t){var r=t?Ba(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function Da(e,t){if(e!==t){var r=e!==ae,n=null===e,a=e===e,i=ws(e),o=t!==ae,u=null===t,s=t===t,l=ws(t);if(!u&&!l&&!i&&e>t||i&&o&&s&&!u&&!l||n&&o&&s||!r&&s||!a)return 1;if(!n&&!i&&!l&&e<t||l&&r&&a&&!n&&!i||u&&r&&a||!o&&a||!s)return-1}return 0}function Ta(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,o=a.length,u=r.length;++n<o;){var s=Da(a[n],i[n]);if(s){if(n>=u)return s;var l=r[n];return s*("desc"==l?-1:1)}}return e.index-t.index}function Ua(e,t,r,n){for(var a=-1,i=e.length,o=r.length,u=-1,s=t.length,l=$c(i-o,0),c=oc(s+l),f=!n;++u<s;)c[u]=t[u];for(;++a<o;)(f||a<i)&&(c[r[a]]=e[a]);for(;l--;)c[u++]=e[a++];return c}function Ha(e,t,r,n){for(var a=-1,i=e.length,o=-1,u=r.length,s=-1,l=t.length,c=$c(i-u,0),f=oc(c+l),h=!n;++a<c;)f[a]=e[a];for(var m=a;++s<l;)f[m+s]=t[s];for(;++o<u;)(h||a<i)&&(f[m+r[o]]=e[a++]);return f}function Ka(e,t){var r=-1,n=e.length;for(t||(t=oc(n));++r<n;)t[r]=e[r];return t}function qa(e,t,r,n){var a=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var u=t[i],s=n?n(r[u],e[u],u,r,e):ae;s===ae&&(s=e[u]),a?Dr(r,u,s):Nr(r,u,s)}return r}function Ma(e,t){return qa(e,Bf(e),t)}function La(e,t){return qa(e,Ef(e),t)}function Ja(e,t){return function(r,n){var a=kh(r)?s:Vr,i=t?t():{};return a(r,e,Pi(n,2),i)}}function Fa(e){return ia(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:ae,o=a>2?r[2]:ae;for(i=e.length>3&&"function"==typeof i?(a--,i):ae,o&&Ui(r[0],r[1],o)&&(i=a<3?ae:i,a=1),t=fc(t);++n<a;){var u=r[n];u&&e(t,u,n,i)}return t})}function Wa(e,t){return function(r,n){if(null==r)return r;if(!Qu(r))return e(r,n);for(var a=r.length,i=t?a:-1,o=fc(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}function Ga(e){return function(t,r,n){for(var a=-1,i=fc(t),o=n(t),u=o.length;u--;){var s=o[e?u:++a];if(r(i[s],s,i)===!1)break}return t}}function za(e,t,r){function n(){var t=this&&this!==un&&this instanceof n?i:e;return t.apply(a?r:this,arguments)}var a=t&ge,i=Xa(e);return n}function $a(e){return function(t){t=Ns(t);var r=L(t)?ee(t):ae,n=r?r[0]:t.charAt(0),a=r?_a(r,1).join(""):t.slice(1);return n[e]()+a}}function Qa(e){return function(t){return g(Bl(ll(t).replace(Mr,"")),e,"")}}function Xa(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=yf(e.prototype),n=e.apply(r,t);return ss(n)?n:r}}function Ya(e,t,r){function n(){for(var i=arguments.length,o=oc(i),s=i,l=Ci(n);s--;)o[s]=arguments[s];var c=i<3&&o[0]!==l&&o[i-1]!==l?[]:z(o,l);if(i-=c.length,i<r)return li(e,t,ti,n.placeholder,ae,o,c,ae,ae,r-i);var f=this&&this!==un&&this instanceof n?a:e;return u(f,this,o)}var a=Xa(e);return n}function Za(e){return function(t,r,n){var a=fc(t);if(!Qu(t)){var i=Pi(r,3);t=Js(t),r=function(e){return i(a[e],e,a)}}var o=e(t,r,n);return o>-1?a[i?t[o]:o]:ae}}function ei(e){return bi(function(t){var r=t.length,n=r,i=a.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new dc(se);if(i&&!u&&"wrapper"==Si(o))var u=new a([],!0);
}for(n=u?n:r;++n<r;){o=t[n];var s=Si(o),l="wrapper"==s?Of(o):ae;u=l&&qi(l[0])&&l[1]==(Pe|we|Se|Ae)&&!l[4].length&&1==l[9]?u[Si(l[0])].apply(u,l[3]):1==o.length&&qi(o)?u[s]():u.thru(o)}return function(){var e=arguments,n=e[0];if(u&&1==e.length&&kh(n))return u.plant(n).value();for(var a=0,i=r?t[a].apply(this,e):n;++a<r;)i=t[a].call(this,i);return i}})}function ti(e,t,r,n,a,i,o,u,s,l){function c(){for(var g=arguments.length,y=oc(g),b=g;b--;)y[b]=arguments[b];if(d)var w=Ci(c),k=K(y,w);if(n&&(y=Ua(y,n,a,d)),i&&(y=Ha(y,i,o,d)),g-=k,d&&g<l){var S=z(y,w);return li(e,t,ti,c.placeholder,r,y,S,u,s,l-g)}var C=h?r:this,P=m?C[e]:e;return g=y.length,u?y=Yi(y,u):v&&g>1&&y.reverse(),f&&s<g&&(y.length=s),this&&this!==un&&this instanceof c&&(P=p||Xa(P)),P.apply(C,y)}var f=t&Pe,h=t&ge,m=t&ye,d=t&(we|ke),v=t&Ie,p=m?ae:Xa(e);return c}function ri(e,t){return function(r,n){return _n(r,e,t(n),{})}}function ni(e,t){return function(r,n){var a;if(r===ae&&n===ae)return t;if(r!==ae&&(a=r),n!==ae){if(a===ae)return n;"string"==typeof r||"string"==typeof n?(r=pa(r),n=pa(n)):(r=va(r),n=va(n)),a=e(r,n)}return a}}function ai(e){return bi(function(t){return t=v(t,R(Pi())),ia(function(r){var n=this;return e(t,function(e){return u(e,n,r)})})})}function ii(e,t){t=t===ae?" ":pa(t);var r=t.length;if(r<2)return r?aa(t,e):t;var n=aa(t,Mc(e/Z(t)));return L(t)?_a(ee(n),0,e).join(""):n.slice(0,e)}function oi(e,t,r,n){function a(){for(var t=-1,s=arguments.length,l=-1,c=n.length,f=oc(c+s),h=this&&this!==un&&this instanceof a?o:e;++l<c;)f[l]=n[l];for(;s--;)f[l++]=arguments[++t];return u(h,i?r:this,f)}var i=t&ge,o=Xa(e);return a}function ui(e){return function(t,r,n){return n&&"number"!=typeof n&&Ui(t,r,n)&&(r=n=ae),t=As(t),r===ae?(r=t,t=0):r=As(r),n=n===ae?t<r?1:-1:As(n),na(t,r,n,e)}}function si(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=Os(t),r=Os(r)),e(t,r)}}function li(e,t,r,n,a,i,o,u,s,l){var c=t&we,f=c?o:ae,h=c?ae:o,m=c?i:ae,d=c?ae:i;t|=c?Se:Ce,t&=~(c?Ce:Se),t&be||(t&=~(ge|ye));var v=[e,t,a,m,f,d,h,u,s,l],p=r.apply(ae,v);return qi(e)&&Vf(p,v),p.placeholder=n,Zi(p,e,t)}function ci(e){var t=cc[e];return function(e,r){if(e=Os(e),r=null==r?0:Qc(Is(r),292)){var n=(Ns(e)+"e").split("e"),a=t(n[0]+"e"+(+n[1]+r));return n=(Ns(a)+"e").split("e"),+(n[0]+"e"+(+n[1]-r))}return t(e)}}function fi(e){return function(t){var r=Nf(t);return r==Xe?W(t):r==at?Q(t):x(t,e(t))}}function hi(e,t,r,n,a,i,o,u){var s=t&ye;if(!s&&"function"!=typeof e)throw new dc(se);var l=n?n.length:0;if(l||(t&=~(Se|Ce),n=a=ae),o=o===ae?o:$c(Is(o),0),u=u===ae?u:Is(u),l-=a?a.length:0,t&Ce){var c=n,f=a;n=a=ae}var h=s?ae:Of(e),m=[e,t,r,n,a,c,f,i,o,u];if(h&&Gi(m,h),e=m[0],t=m[1],r=m[2],n=m[3],a=m[4],u=m[9]=m[9]===ae?s?0:e.length:$c(m[9]-l,0),!u&&t&(we|ke)&&(t&=~(we|ke)),t&&t!=ge)d=t==we||t==ke?Ya(e,t,u):t!=Se&&t!=(ge|Se)||a.length?ti.apply(ae,m):oi(e,t,r,n);else var d=za(e,t,r);var v=h?Cf:Vf;return Zi(v(d,m),e,t)}function mi(e,t,r,n){return e===ae||$u(e,gc[r])&&!wc.call(n,r)?t:e}function di(e,t,r,n,a,i){return ss(e)&&ss(t)&&(i.set(t,e),Gn(e,t,ae,di,i),i.delete(t)),e}function vi(e){return gs(e)?ae:e}function pi(e,t,r,n,a,i){var o=r&ve,u=e.length,s=t.length;if(u!=s&&!(o&&s>u))return!1;var l=i.get(e);if(l&&i.get(t))return l==t;var c=-1,f=!0,h=r&pe?new gr:ae;for(i.set(e,t),i.set(t,e);++c<u;){var m=e[c],d=t[c];if(n)var v=o?n(d,m,c,t,e,i):n(m,d,c,e,t,i);if(v!==ae){if(v)continue;f=!1;break}if(h){if(!b(t,function(e,t){if(!T(h,t)&&(m===e||a(m,e,r,n,i)))return h.push(t)})){f=!1;break}}else if(m!==d&&!a(m,d,r,n,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function gi(e,t,r,n,a,i,o){switch(r){case ft:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ct:return!(e.byteLength!=t.byteLength||!i(new Bc(e),new Bc(t)));case Fe:case We:case Ye:return $u(+e,+t);case ze:return e.name==t.name&&e.message==t.message;case nt:case it:return e==t+"";case Xe:var u=W;case at:var s=n&ve;if(u||(u=$),e.size!=t.size&&!s)return!1;var l=o.get(e);if(l)return l==t;n|=pe,o.set(e,t);var c=pi(u(e),u(t),n,a,i,o);return o.delete(e),c;case ot:if(pf)return pf.call(e)==pf.call(t)}return!1}function yi(e,t,r,n,a,i){var o=r&ve,u=wi(e),s=u.length,l=wi(t),c=l.length;if(s!=c&&!o)return!1;for(var f=s;f--;){var h=u[f];if(!(o?h in t:wc.call(t,h)))return!1}var m=i.get(e);if(m&&i.get(t))return m==t;var d=!0;i.set(e,t),i.set(t,e);for(var v=o;++f<s;){h=u[f];var p=e[h],g=t[h];if(n)var y=o?n(g,p,h,t,e,i):n(p,g,h,e,t,i);if(!(y===ae?p===g||a(p,g,r,n,i):y)){d=!1;break}v||(v="constructor"==h)}if(d&&!v){var b=e.constructor,w=t.constructor;b!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(d=!1)}return i.delete(e),i.delete(t),d}function bi(e){return Rf(Qi(e,ae,go),e+"")}function wi(e){return ln(e,Js,Bf)}function ki(e){return ln(e,Fs,Ef)}function Si(e){for(var t=e.name+"",r=lf[t],n=wc.call(lf,t)?r.length:0;n--;){var a=r[n],i=a.func;if(null==i||i==e)return a.name}return t}function Ci(e){var t=wc.call(r,"placeholder")?r:e;return t.placeholder}function Pi(){var e=r.iteratee||Rl;return e=e===Rl?Kn:e,arguments.length?e(arguments[0],arguments[1]):e}function Ai(e,t){var r=e.__data__;return Ki(t)?r["string"==typeof t?"string":"hash"]:r.map}function Ii(e){for(var t=Js(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,Ji(a)]}return t}function _i(e,t){var r=M(e,t);return Dn(r)?r:ae}function Oi(e){var t=wc.call(e,Tc),r=e[Tc];try{e[Tc]=ae;var n=!0}catch(e){}var a=Cc.call(e);return n&&(t?e[Tc]=r:delete e[Tc]),a}function Bi(e,t,r){for(var n=-1,a=r.length;++n<a;){var i=r[n],o=i.size;switch(i.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=Qc(t,e+o);break;case"takeRight":e=$c(e,t-o)}}return{start:e,end:t}}function Ei(e){var t=e.match(qt);return t?t[1].split(Mt):[]}function Ni(e,t,r){t=Ia(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var o=ro(t[n]);if(!(i=null!=e&&r(e,o)))break;e=e[o]}return i||++n!=a?i:(a=null==e?0:e.length,!!a&&us(a)&&Ti(o,a)&&(kh(e)||wh(e)))}function ji(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&wc.call(e,"index")&&(r.index=e.index,r.input=e.input),r}function Vi(e){return"function"!=typeof e.constructor||Li(e)?{}:yf(Nc(e))}function xi(e,t,r,n){var a=e.constructor;switch(t){case ct:return Ba(e);case Fe:case We:return new a(+e);case ft:return Ea(e,n);case ht:case mt:case dt:case vt:case pt:case gt:case yt:case bt:case wt:return Ra(e,n);case Xe:return Na(e,n,r);case Ye:case it:return new a(e);case nt:return ja(e);case at:return Va(e,n,r);case ot:return xa(e)}}function Ri(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(Kt,"{\n/* [wrapped with "+t+"] */\n")}function Di(e){return kh(e)||wh(e)||!!(Rc&&e&&e[Rc])}function Ti(e,t){return t=null==t?Re:t,!!t&&("number"==typeof e||Xt.test(e))&&e>-1&&e%1==0&&e<t}function Ui(e,t,r){if(!ss(r))return!1;var n=typeof t;return!!("number"==n?Qu(r)&&Ti(t,r.length):"string"==n&&t in r)&&$u(r[t],e)}function Hi(e,t){if(kh(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ws(e))||(jt.test(e)||!Nt.test(e)||null!=t&&e in fc(t))}function Ki(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function qi(e){var t=Si(e),n=r[t];if("function"!=typeof n||!(t in w.prototype))return!1;if(e===n)return!0;var a=Of(n);return!!a&&e===a[0]}function Mi(e){return!!Sc&&Sc in e}function Li(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||gc;return e===r}function Ji(e){return e===e&&!ss(e)}function Fi(e,t){return function(r){return null!=r&&(r[e]===t&&(t!==ae||e in fc(r)))}}function Wi(e){var t=Ru(e,function(e){return r.size===ce&&r.clear(),e}),r=t.cache;return t}function Gi(e,t){var r=e[1],n=t[1],a=r|n,i=a<(ge|ye|Pe),o=n==Pe&&r==we||n==Pe&&r==Ae&&e[7].length<=t[8]||n==(Pe|Ae)&&t[7].length<=t[8]&&r==we;if(!i&&!o)return e;n&ge&&(e[2]=t[2],a|=r&ge?0:be);var u=t[3];if(u){var s=e[3];e[3]=s?Ua(s,u,t[4]):u,e[4]=s?z(e[3],fe):t[4]}return u=t[5],u&&(s=e[5],e[5]=s?Ha(s,u,t[6]):u,e[6]=s?z(e[5],fe):t[6]),u=t[7],u&&(e[7]=u),n&Pe&&(e[8]=null==e[8]?t[8]:Qc(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function zi(e){var t=[];if(null!=e)for(var r in fc(e))t.push(r);return t}function $i(e){return Cc.call(e)}function Qi(e,t,r){return t=$c(t===ae?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=$c(n.length-t,0),o=oc(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=oc(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),u(e,this,s)}}function Xi(e,t){return t.length<2?e:sn(e,ca(t,0,-1))}function Yi(e,t){for(var r=e.length,n=Qc(t.length,r),a=Ka(e);n--;){var i=t[n];e[n]=Ti(i,r)?a[i]:ae}return e}function Zi(e,t,r){var n=t+"";return Rf(e,Ri(n,ao(Ei(n),r)))}function eo(e){var t=0,r=0;return function(){var n=Xc(),a=Ee-(n-r);if(r=n,a>0){if(++t>=Be)return arguments[0]}else t=0;return e.apply(ae,arguments)}}function to(e,t){var r=-1,n=e.length,a=n-1;for(t=t===ae?n:t;++r<t;){var i=ra(r,a),o=e[i];e[i]=e[r],e[r]=o}return e.length=t,e}function ro(e){if("string"==typeof e||ws(e))return e;var t=e+"";return"0"==t&&1/e==-xe?"-0":t}function no(e){if(null!=e){try{return bc.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ao(e,t){return l(qe,function(r){var n="_."+r[0];t&r[1]&&!m(e,n)&&e.push(n)}),e.sort()}function io(e){if(e instanceof w)return e.clone();var t=new a(e.__wrapped__,e.__chain__);return t.__actions__=Ka(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function oo(e,t,r){t=(r?Ui(e,t,r):t===ae)?1:$c(Is(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var a=0,i=0,o=oc(Mc(n/t));a<n;)o[i++]=ca(e,a,a+=t);return o}function uo(e){for(var t=-1,r=null==e?0:e.length,n=0,a=[];++t<r;){var i=e[t];i&&(a[n++]=i)}return a}function so(){var e=arguments.length;if(!e)return[];for(var t=oc(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return p(kh(r)?Ka(r):[r],en(t,1))}function lo(e,t,r){var n=null==e?0:e.length;return n?(t=r||t===ae?1:Is(t),ca(e,t<0?0:t,n)):[]}function co(e,t,r){var n=null==e?0:e.length;return n?(t=r||t===ae?1:Is(t),t=n-t,ca(e,0,t<0?0:t)):[]}function fo(e,t){return e&&e.length?wa(e,Pi(t,3),!0,!0):[]}function ho(e,t){return e&&e.length?wa(e,Pi(t,3),!0):[]}function mo(e,t,r,n){var a=null==e?0:e.length;return a?(r&&"number"!=typeof r&&Ui(e,t,r)&&(r=0,n=a),Yr(e,t,r,n)):[]}function vo(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=null==r?0:Is(r);return a<0&&(a=$c(n+a,0)),C(e,Pi(t,3),a)}function po(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=n-1;return r!==ae&&(a=Is(r),a=r<0?$c(n+a,0):Qc(a,n-1)),C(e,Pi(t,3),a,!0)}function go(e){var t=null==e?0:e.length;return t?en(e,1):[]}function yo(e){var t=null==e?0:e.length;return t?en(e,xe):[]}function bo(e,t){var r=null==e?0:e.length;return r?(t=t===ae?1:Is(t),en(e,t)):[]}function wo(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var a=e[t];n[a[0]]=a[1]}return n}function ko(e){return e&&e.length?e[0]:ae}function So(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=null==r?0:Is(r);return a<0&&(a=$c(n+a,0)),P(e,t,a)}function Co(e){var t=null==e?0:e.length;return t?ca(e,0,-1):[]}function Po(e,t){return null==e?"":Gc.call(e,t)}function Ao(e){var t=null==e?0:e.length;return t?e[t-1]:ae}function Io(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=n;return r!==ae&&(a=Is(r),a=a<0?$c(n+a,0):Qc(a,n-1)),t===t?Y(e,t,a):C(e,I,a,!0)}function _o(e,t){return e&&e.length?$n(e,Is(t)):ae}function Oo(e,t){return e&&e.length&&t&&t.length?ea(e,t):e}function Bo(e,t,r){return e&&e.length&&t&&t.length?ea(e,t,Pi(r,2)):e}function Eo(e,t,r){return e&&e.length&&t&&t.length?ea(e,t,ae,r):e}function No(e,t){var r=[];if(!e||!e.length)return r;var n=-1,a=[],i=e.length;for(t=Pi(t,3);++n<i;){var o=e[n];t(o,n,e)&&(r.push(o),a.push(n))}return ta(e,a),r}function jo(e){return null==e?e:ef.call(e)}function Vo(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&Ui(e,t,r)?(t=0,r=n):(t=null==t?0:Is(t),r=r===ae?n:Is(r)),ca(e,t,r)):[]}function xo(e,t){return ha(e,t)}function Ro(e,t,r){return ma(e,t,Pi(r,2))}function Do(e,t){var r=null==e?0:e.length;if(r){var n=ha(e,t);if(n<r&&$u(e[n],t))return n}return-1}function To(e,t){return ha(e,t,!0)}function Uo(e,t,r){return ma(e,t,Pi(r,2),!0)}function Ho(e,t){var r=null==e?0:e.length;if(r){var n=ha(e,t,!0)-1;if($u(e[n],t))return n}return-1}function Ko(e){return e&&e.length?da(e):[]}function qo(e,t){return e&&e.length?da(e,Pi(t,2)):[]}function Mo(e){var t=null==e?0:e.length;return t?ca(e,1,t):[]}function Lo(e,t,r){return e&&e.length?(t=r||t===ae?1:Is(t),ca(e,0,t<0?0:t)):[]}function Jo(e,t,r){var n=null==e?0:e.length;return n?(t=r||t===ae?1:Is(t),t=n-t,ca(e,t<0?0:t,n)):[]}function Fo(e,t){return e&&e.length?wa(e,Pi(t,3),!1,!0):[]}function Wo(e,t){return e&&e.length?wa(e,Pi(t,3)):[]}function Go(e){return e&&e.length?ga(e):[]}function zo(e,t){return e&&e.length?ga(e,Pi(t,2)):[]}function $o(e,t){return t="function"==typeof t?t:ae,e&&e.length?ga(e,ae,t):[]}function Qo(e){if(!e||!e.length)return[];var t=0;return e=h(e,function(e){if(Xu(e))return t=$c(e.length,t),!0}),V(t,function(t){return v(e,O(t))})}function Xo(e,t){if(!e||!e.length)return[];var r=Qo(e);return null==t?r:v(r,function(e){return u(t,ae,e)})}function Yo(e,t){return Ca(e||[],t||[],Nr)}function Zo(e,t){return Ca(e||[],t||[],sa)}function eu(e){var t=r(e);return t.__chain__=!0,t}function tu(e,t){return t(e),e}function ru(e,t){return t(e)}function nu(){return eu(this)}function au(){return new a(this.value(),this.__chain__)}function iu(){this.__values__===ae&&(this.__values__=Ps(this.value()));var e=this.__index__>=this.__values__.length,t=e?ae:this.__values__[this.__index__++];return{done:e,value:t}}function ou(){return this}function uu(e){for(var t,r=this;r instanceof n;){var a=io(r);a.__index__=0,a.__values__=ae,t?i.__wrapped__=a:t=a;var i=a;r=r.__wrapped__}return i.__wrapped__=e,t}function su(){var e=this.__wrapped__;if(e instanceof w){var t=e;return this.__actions__.length&&(t=new w(this)),t=t.reverse(),t.__actions__.push({func:ru,args:[jo],thisArg:ae}),new a(t,this.__chain__)}return this.thru(jo)}function lu(){return ka(this.__wrapped__,this.__actions__)}function cu(e,t,r){var n=kh(e)?f:Wr;return r&&Ui(e,t,r)&&(t=ae),n(e,Pi(t,3))}function fu(e,t){var r=kh(e)?h:Zr;return r(e,Pi(t,3))}function hu(e,t){return en(yu(e,t),1)}function mu(e,t){return en(yu(e,t),xe)}function du(e,t,r){return r=r===ae?1:Is(r),en(yu(e,t),r)}function vu(e,t){var r=kh(e)?l:bf;return r(e,Pi(t,3))}function pu(e,t){var r=kh(e)?c:wf;return r(e,Pi(t,3))}function gu(e,t,r,n){e=Qu(e)?e:nl(e),r=r&&!n?Is(r):0;var a=e.length;return r<0&&(r=$c(a+r,0)),bs(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&P(e,t,r)>-1}function yu(e,t){var r=kh(e)?v:Jn;return r(e,Pi(t,3))}function bu(e,t,r,n){return null==e?[]:(kh(t)||(t=null==t?[]:[t]),r=n?ae:r,kh(r)||(r=null==r?[]:[r]),Qn(e,t,r))}function wu(e,t,r){var n=kh(e)?g:E,a=arguments.length<3;return n(e,Pi(t,4),r,a,bf)}function ku(e,t,r){var n=kh(e)?y:E,a=arguments.length<3;return n(e,Pi(t,4),r,a,wf)}function Su(e,t){var r=kh(e)?h:Zr;return r(e,Du(Pi(t,3)))}function Cu(e){var t=kh(e)?_r:oa;return t(e)}function Pu(e,t,r){t=(r?Ui(e,t,r):t===ae)?1:Is(t);var n=kh(e)?Or:ua;return n(e,t)}function Au(e){var t=kh(e)?Br:la;return t(e)}function Iu(e){if(null==e)return 0;if(Qu(e))return bs(e)?Z(e):e.length;var t=Nf(e);return t==Xe||t==at?e.size:qn(e).length}function _u(e,t,r){var n=kh(e)?b:fa;return r&&Ui(e,t,r)&&(t=ae),n(e,Pi(t,3))}function Ou(e,t){if("function"!=typeof t)throw new dc(se);return e=Is(e),function(){if(--e<1)return t.apply(this,arguments)}}function Bu(e,t,r){return t=r?ae:t,t=e&&null==t?e.length:t,hi(e,Pe,ae,ae,ae,ae,t)}function Eu(e,t){var r;if("function"!=typeof t)throw new dc(se);return e=Is(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=ae),r}}function Nu(e,t,r){t=r?ae:t;var n=hi(e,we,ae,ae,ae,ae,ae,t);return n.placeholder=Nu.placeholder,n}function ju(e,t,r){t=r?ae:t;var n=hi(e,ke,ae,ae,ae,ae,ae,t);return n.placeholder=ju.placeholder,n}function Vu(e,t,r){function n(t){var r=h,n=m;return h=m=ae,y=t,v=e.apply(n,r)}function a(e){return y=e,p=xf(u,t),b?n(e):v}function i(e){var r=e-g,n=e-y,a=t-r;return w?Qc(a,d-n):a}function o(e){var r=e-g,n=e-y;return g===ae||r>=t||r<0||w&&n>=d}function u(){var e=lh();return o(e)?s(e):void(p=xf(u,i(e)))}function s(e){return p=ae,k&&h?n(e):(h=m=ae,v)}function l(){p!==ae&&If(p),y=0,h=g=m=p=ae}function c(){return p===ae?v:s(lh())}function f(){var e=lh(),r=o(e);if(h=arguments,m=this,g=e,r){if(p===ae)return a(g);if(w)return p=xf(u,t),n(g)}return p===ae&&(p=xf(u,t)),v}var h,m,d,v,p,g,y=0,b=!1,w=!1,k=!0;if("function"!=typeof e)throw new dc(se);return t=Os(t)||0,ss(r)&&(b=!!r.leading,w="maxWait"in r,d=w?$c(Os(r.maxWait)||0,t):d,k="trailing"in r?!!r.trailing:k),f.cancel=l,f.flush=c,f}function xu(e){return hi(e,Ie)}function Ru(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new dc(se);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(Ru.Cache||fr),r}function Du(e){if("function"!=typeof e)throw new dc(se);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Tu(e){return Eu(2,e)}function Uu(e,t){if("function"!=typeof e)throw new dc(se);return t=t===ae?t:Is(t),ia(e,t)}function Hu(e,t){if("function"!=typeof e)throw new dc(se);return t=null==t?0:$c(Is(t),0),ia(function(r){var n=r[t],a=_a(r,0,t);return n&&p(a,n),u(e,this,a)})}function Ku(e,t,r){var n=!0,a=!0;if("function"!=typeof e)throw new dc(se);return ss(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),Vu(e,t,{leading:n,maxWait:t,trailing:a})}function qu(e){return Bu(e,1)}function Mu(e,t){return vh(Aa(t),e)}function Lu(){if(!arguments.length)return[];var e=arguments[0];return kh(e)?e:[e]}function Ju(e){return Hr(e,de)}function Fu(e,t){return t="function"==typeof t?t:ae,Hr(e,de,t)}function Wu(e){return Hr(e,he|de)}function Gu(e,t){return t="function"==typeof t?t:ae,Hr(e,he|de,t)}function zu(e,t){return null==t||qr(e,t,Js(t))}function $u(e,t){return e===t||e!==e&&t!==t}function Qu(e){return null!=e&&us(e.length)&&!is(e)}function Xu(e){return ls(e)&&Qu(e)}function Yu(e){return e===!0||e===!1||ls(e)&&fn(e)==Fe}function Zu(e){return ls(e)&&1===e.nodeType&&!gs(e)}function es(e){if(null==e)return!0;if(Qu(e)&&(kh(e)||"string"==typeof e||"function"==typeof e.splice||Ch(e)||Oh(e)||wh(e)))return!e.length;var t=Nf(e);if(t==Xe||t==at)return!e.size;if(Li(e))return!qn(e).length;for(var r in e)if(wc.call(e,r))return!1;return!0}function ts(e,t){return jn(e,t)}function rs(e,t,r){r="function"==typeof r?r:ae;var n=r?r(e,t):ae;return n===ae?jn(e,t,ae,r):!!n}function ns(e){if(!ls(e))return!1;var t=fn(e);return t==ze||t==Ge||"string"==typeof e.message&&"string"==typeof e.name&&!gs(e)}function as(e){return"number"==typeof e&&Wc(e)}function is(e){if(!ss(e))return!1;var t=fn(e);return t==$e||t==Qe||t==Je||t==rt}function os(e){return"number"==typeof e&&e==Is(e)}function us(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Re}function ss(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ls(e){return null!=e&&"object"==typeof e}function cs(e,t){return e===t||Rn(e,t,Ii(t))}function fs(e,t,r){return r="function"==typeof r?r:ae,Rn(e,t,Ii(t),r)}function hs(e){return ps(e)&&e!=+e}function ms(e){if(jf(e))throw new sc(ue);return Dn(e)}function ds(e){return null===e}function vs(e){return null==e}function ps(e){return"number"==typeof e||ls(e)&&fn(e)==Ye}function gs(e){if(!ls(e)||fn(e)!=et)return!1;var t=Nc(e);if(null===t)return!0;var r=wc.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&bc.call(r)==Pc}function ys(e){return os(e)&&e>=-Re&&e<=Re}function bs(e){return"string"==typeof e||!kh(e)&&ls(e)&&fn(e)==it}function ws(e){return"symbol"==typeof e||ls(e)&&fn(e)==ot}function ks(e){return e===ae}function Ss(e){return ls(e)&&Nf(e)==st}function Cs(e){return ls(e)&&fn(e)==lt}function Ps(e){if(!e)return[];if(Qu(e))return bs(e)?ee(e):Ka(e);if(Dc&&e[Dc])return F(e[Dc]());var t=Nf(e),r=t==Xe?W:t==at?$:nl;return r(e)}function As(e){if(!e)return 0===e?e:0;if(e=Os(e),e===xe||e===-xe){var t=e<0?-1:1;return t*De}return e===e?e:0}function Is(e){var t=As(e),r=t%1;return t===t?r?t-r:t:0}function _s(e){return e?Ur(Is(e),0,Ue):0}function Os(e){if("number"==typeof e)return e;if(ws(e))return Te;if(ss(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ss(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Tt,"");var r=zt.test(e);return r||Qt.test(e)?nn(e.slice(2),r?2:8):Gt.test(e)?Te:+e}function Bs(e){return qa(e,Fs(e))}function Es(e){return e?Ur(Is(e),-Re,Re):0===e?e:0}function Ns(e){return null==e?"":pa(e)}function js(e,t){var r=yf(e);return null==t?r:xr(r,t)}function Vs(e,t){return S(e,Pi(t,3),tn)}function xs(e,t){return S(e,Pi(t,3),an)}function Rs(e,t){return null==e?e:kf(e,Pi(t,3),Fs)}function Ds(e,t){return null==e?e:Sf(e,Pi(t,3),Fs)}function Ts(e,t){return e&&tn(e,Pi(t,3))}function Us(e,t){return e&&an(e,Pi(t,3))}function Hs(e){return null==e?[]:on(e,Js(e))}function Ks(e){return null==e?[]:on(e,Fs(e))}function qs(e,t,r){var n=null==e?ae:sn(e,t);return n===ae?r:n}function Ms(e,t){return null!=e&&Ni(e,t,bn)}function Ls(e,t){return null!=e&&Ni(e,t,Cn)}function Js(e){return Qu(e)?Ir(e):qn(e)}function Fs(e){return Qu(e)?Ir(e,!0):Mn(e)}function Ws(e,t){var r={};return t=Pi(t,3),tn(e,function(e,n,a){Dr(r,t(e,n,a),e)}),r}function Gs(e,t){var r={};return t=Pi(t,3),tn(e,function(e,n,a){Dr(r,n,t(e,n,a))}),r}function zs(e,t){return $s(e,Du(Pi(t)))}function $s(e,t){if(null==e)return{};var r=v(ki(e),function(e){return[e]});return t=Pi(t),Yn(e,r,function(e,r){return t(e,r[0])})}function Qs(e,t,r){t=Ia(t,e);var n=-1,a=t.length;for(a||(a=1,e=ae);++n<a;){var i=null==e?ae:e[ro(t[n])];i===ae&&(n=a,i=r),e=is(i)?i.call(e):i}return e}function Xs(e,t,r){return null==e?e:sa(e,t,r)}function Ys(e,t,r,n){return n="function"==typeof n?n:ae,null==e?e:sa(e,t,r,n)}function Zs(e,t,r){var n=kh(e),a=n||Ch(e)||Oh(e);if(t=Pi(t,4),null==r){var i=e&&e.constructor;r=a?n?new i:[]:ss(e)&&is(i)?yf(Nc(e)):{}}return(a?l:tn)(e,function(e,n,a){return t(r,e,n,a)}),r}function el(e,t){return null==e||ya(e,t)}function tl(e,t,r){return null==e?e:ba(e,t,Aa(r))}function rl(e,t,r,n){return n="function"==typeof n?n:ae,null==e?e:ba(e,t,Aa(r),n)}function nl(e){return null==e?[]:D(e,Js(e))}function al(e){return null==e?[]:D(e,Fs(e))}function il(e,t,r){return r===ae&&(r=t,t=ae),r!==ae&&(r=Os(r),r=r===r?r:0),t!==ae&&(t=Os(t),t=t===t?t:0),Ur(Os(e),t,r)}function ol(e,t,r){return t=As(t),r===ae?(r=t,t=0):r=As(r),e=Os(e),An(e,t,r)}function ul(e,t,r){if(r&&"boolean"!=typeof r&&Ui(e,t,r)&&(t=r=ae),r===ae&&("boolean"==typeof t?(r=t,t=ae):"boolean"==typeof e&&(r=e,e=ae)),e===ae&&t===ae?(e=0,t=1):(e=As(e),t===ae?(t=e,e=0):t=As(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var a=Zc();return Qc(e+a*(t-e+rn("1e-"+((a+"").length-1))),t)}return ra(e,t)}function sl(e){return em(Ns(e).toLowerCase())}function ll(e){return e=Ns(e),e&&e.replace(Yt,wn).replace(Lr,"")}function cl(e,t,r){e=Ns(e),t=pa(t);var n=e.length;r=r===ae?n:Ur(Is(r),0,n);var a=r;return r-=t.length,r>=0&&e.slice(r,a)==t}function fl(e){return e=Ns(e),e&&_t.test(e)?e.replace(At,kn):e}function hl(e){return e=Ns(e),e&&Dt.test(e)?e.replace(Rt,"\\$&"):e}function ml(e,t,r){e=Ns(e),t=Is(t);var n=t?Z(e):0;if(!t||n>=t)return e;var a=(t-n)/2;return ii(Lc(a),r)+e+ii(Mc(a),r)}function dl(e,t,r){e=Ns(e),t=Is(t);var n=t?Z(e):0;return t&&n<t?e+ii(t-n,r):e}function vl(e,t,r){e=Ns(e),t=Is(t);var n=t?Z(e):0;return t&&n<t?ii(t-n,r)+e:e}function pl(e,t,r){return r||null==t?t=0:t&&(t=+t),Yc(Ns(e).replace(Ut,""),t||0)}function gl(e,t,r){return t=(r?Ui(e,t,r):t===ae)?1:Is(t),aa(Ns(e),t)}function yl(){var e=arguments,t=Ns(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function bl(e,t,r){return r&&"number"!=typeof r&&Ui(e,t,r)&&(t=r=ae),(r=r===ae?Ue:r>>>0)?(e=Ns(e),e&&("string"==typeof t||null!=t&&!Ih(t))&&(t=pa(t),!t&&L(e))?_a(ee(e),0,r):e.split(t,r)):[]}function wl(e,t,r){return e=Ns(e),r=null==r?0:Ur(Is(r),0,e.length),t=pa(t),e.slice(r,r+t.length)==t}function kl(e,t,n){var a=r.templateSettings;n&&Ui(e,t,n)&&(t=ae),e=Ns(e),t=Vh({},t,a,mi);var i,o,u=Vh({},t.imports,a.imports,mi),s=Js(u),l=D(u,s),c=0,f=t.interpolate||Zt,h="__p += '",m=hc((t.escape||Zt).source+"|"+f.source+"|"+(f===Et?Ft:Zt).source+"|"+(t.evaluate||Zt).source+"|$","g"),d="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++$r+"]")+"\n";e.replace(m,function(t,r,n,a,u,s){return n||(n=a),h+=e.slice(c,s).replace(er,q),r&&(i=!0,h+="' +\n__e("+r+") +\n'"),u&&(o=!0,h+="';\n"+u+";\n__p += '"),n&&(h+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=s+t.length,t}),h+="';\n";var v=t.variable;v||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(kt,""):h).replace(St,"$1").replace(Ct,"$1;"),h="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var p=tm(function(){return lc(s,d+"return "+h).apply(ae,l)});if(p.source=h,ns(p))throw p;return p}function Sl(e){return Ns(e).toLowerCase()}function Cl(e){return Ns(e).toUpperCase()}function Pl(e,t,r){if(e=Ns(e),e&&(r||t===ae))return e.replace(Tt,"");if(!e||!(t=pa(t)))return e;var n=ee(e),a=ee(t),i=U(n,a),o=H(n,a)+1;return _a(n,i,o).join("")}function Al(e,t,r){if(e=Ns(e),e&&(r||t===ae))return e.replace(Ht,"");if(!e||!(t=pa(t)))return e;var n=ee(e),a=H(n,ee(t))+1;return _a(n,0,a).join("")}function Il(e,t,r){if(e=Ns(e),e&&(r||t===ae))return e.replace(Ut,"");if(!e||!(t=pa(t)))return e;var n=ee(e),a=U(n,ee(t));return _a(n,a).join("")}function _l(e,t){var r=_e,n=Oe;if(ss(t)){var a="separator"in t?t.separator:a;r="length"in t?Is(t.length):r,n="omission"in t?pa(t.omission):n}e=Ns(e);var i=e.length;if(L(e)){var o=ee(e);i=o.length}if(r>=i)return e;var u=r-Z(n);if(u<1)return n;var s=o?_a(o,0,u).join(""):e.slice(0,u);if(a===ae)return s+n;if(o&&(u+=s.length-u),Ih(a)){if(e.slice(u).search(a)){var l,c=s;for(a.global||(a=hc(a.source,Ns(Wt.exec(a))+"g")),a.lastIndex=0;l=a.exec(c);)var f=l.index;s=s.slice(0,f===ae?u:f)}}else if(e.indexOf(pa(a),u)!=u){var h=s.lastIndexOf(a);h>-1&&(s=s.slice(0,h))}return s+n}function Ol(e){return e=Ns(e),e&&It.test(e)?e.replace(Pt,Sn):e}function Bl(e,t,r){return e=Ns(e),t=r?ae:t,t===ae?J(e)?ne(e):k(e):e.match(t)||[]}function El(e){var t=null==e?0:e.length,r=Pi();return e=t?v(e,function(e){if("function"!=typeof e[1])throw new dc(se);return[r(e[0]),e[1]]}):[],ia(function(r){for(var n=-1;++n<t;){var a=e[n];if(u(a[0],this,r))return u(a[1],this,r)}})}function Nl(e){return Kr(Hr(e,he))}function jl(e){return function(){return e}}function Vl(e,t){return null==e||e!==e?t:e}function xl(e){return e}function Rl(e){return Kn("function"==typeof e?e:Hr(e,he))}function Dl(e){return Fn(Hr(e,he))}function Tl(e,t){return Wn(e,Hr(t,he))}function Ul(e,t,r){var n=Js(t),a=on(t,n);null!=r||ss(t)&&(a.length||!n.length)||(r=t,t=e,e=this,a=on(t,Js(t)));var i=!(ss(r)&&"chain"in r&&!r.chain),o=is(e);return l(a,function(r){var n=t[r];e[r]=n,o&&(e.prototype[r]=function(){var t=this.__chain__;if(i||t){var r=e(this.__wrapped__),a=r.__actions__=Ka(this.__actions__);return a.push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,p([this.value()],arguments))})}),e}function Hl(){return un._===this&&(un._=Ac),this}function Kl(){}function ql(e){return e=Is(e),ia(function(t){return $n(t,e)})}function Ml(e){return Hi(e)?O(ro(e)):Zn(e)}function Ll(e){return function(t){return null==e?ae:sn(e,t)}}function Jl(){return[]}function Fl(){return!1}function Wl(){return{}}function Gl(){return""}function zl(){return!0}function $l(e,t){if(e=Is(e),e<1||e>Re)return[];var r=Ue,n=Qc(e,Ue);t=Pi(t),e-=Ue;for(var a=V(n,t);++r<e;)t(r);return a}function Ql(e){return kh(e)?v(e,ro):ws(e)?[e]:Ka(Df(Ns(e)))}function Xl(e){var t=++kc;return Ns(e)+t}function Yl(e){return e&&e.length?Gr(e,xl,hn):ae}function Zl(e,t){return e&&e.length?Gr(e,Pi(t,2),hn):ae}function ec(e){return _(e,xl)}function tc(e,t){return _(e,Pi(t,2))}function rc(e){return e&&e.length?Gr(e,xl,Ln):ae}function nc(e,t){return e&&e.length?Gr(e,Pi(t,2),Ln):ae}function ac(e){return e&&e.length?j(e,xl):0}function ic(e,t){return e&&e.length?j(e,Pi(t,2)):0}t=null==t?un:Pn.defaults(un.Object(),t,Pn.pick(un,zr));var oc=t.Array,uc=t.Date,sc=t.Error,lc=t.Function,cc=t.Math,fc=t.Object,hc=t.RegExp,mc=t.String,dc=t.TypeError,vc=oc.prototype,pc=lc.prototype,gc=fc.prototype,yc=t["__core-js_shared__"],bc=pc.toString,wc=gc.hasOwnProperty,kc=0,Sc=function(){var e=/[^.]+$/.exec(yc&&yc.keys&&yc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Cc=gc.toString,Pc=bc.call(fc),Ac=un._,Ic=hc("^"+bc.call(wc).replace(Rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_c=cn?t.Buffer:ae,Oc=t.Symbol,Bc=t.Uint8Array,Ec=_c?_c.allocUnsafe:ae,Nc=G(fc.getPrototypeOf,fc),jc=fc.create,Vc=gc.propertyIsEnumerable,xc=vc.splice,Rc=Oc?Oc.isConcatSpreadable:ae,Dc=Oc?Oc.iterator:ae,Tc=Oc?Oc.toStringTag:ae,Uc=function(){try{var e=_i(fc,"defineProperty");return e({},"",{}),e}catch(e){}}(),Hc=t.clearTimeout!==un.clearTimeout&&t.clearTimeout,Kc=uc&&uc.now!==un.Date.now&&uc.now,qc=t.setTimeout!==un.setTimeout&&t.setTimeout,Mc=cc.ceil,Lc=cc.floor,Jc=fc.getOwnPropertySymbols,Fc=_c?_c.isBuffer:ae,Wc=t.isFinite,Gc=vc.join,zc=G(fc.keys,fc),$c=cc.max,Qc=cc.min,Xc=uc.now,Yc=t.parseInt,Zc=cc.random,ef=vc.reverse,tf=_i(t,"DataView"),rf=_i(t,"Map"),nf=_i(t,"Promise"),af=_i(t,"Set"),of=_i(t,"WeakMap"),uf=_i(fc,"create"),sf=of&&new of,lf={},cf=no(tf),ff=no(rf),hf=no(nf),mf=no(af),df=no(of),vf=Oc?Oc.prototype:ae,pf=vf?vf.valueOf:ae,gf=vf?vf.toString:ae,yf=function(){function e(){}return function(t){if(!ss(t))return{};if(jc)return jc(t);e.prototype=t;var r=new e;return e.prototype=ae,r}}();r.templateSettings={escape:Ot,evaluate:Bt,interpolate:Et,variable:"",imports:{_:r}},r.prototype=n.prototype,r.prototype.constructor=r,a.prototype=yf(n.prototype),a.prototype.constructor=a,w.prototype=yf(n.prototype),w.prototype.constructor=w,re.prototype.clear=Lt,re.prototype.delete=tr,re.prototype.get=rr,re.prototype.has=nr,re.prototype.set=ar,ir.prototype.clear=or,ir.prototype.delete=ur,ir.prototype.get=sr,ir.prototype.has=lr,ir.prototype.set=cr,fr.prototype.clear=hr,fr.prototype.delete=mr,fr.prototype.get=dr,fr.prototype.has=vr,fr.prototype.set=pr,gr.prototype.add=gr.prototype.push=yr,gr.prototype.has=br,wr.prototype.clear=kr,wr.prototype.delete=Sr,wr.prototype.get=Cr,wr.prototype.has=Pr,wr.prototype.set=Ar;var bf=Wa(tn),wf=Wa(an,!0),kf=Ga(),Sf=Ga(!0),Cf=sf?function(e,t){return sf.set(e,t),e}:xl,Pf=Uc?function(e,t){return Uc(e,"toString",{configurable:!0,enumerable:!1,value:jl(t),writable:!0})}:xl,Af=ia,If=Hc||function(e){return un.clearTimeout(e)},_f=af&&1/$(new af([,-0]))[1]==xe?function(e){return new af(e)}:Kl,Of=sf?function(e){return sf.get(e)}:Kl,Bf=Jc?function(e){return null==e?[]:(e=fc(e),h(Jc(e),function(t){return Vc.call(e,t)}))}:Jl,Ef=Jc?function(e){for(var t=[];e;)p(t,Bf(e)),e=Nc(e);return t}:Jl,Nf=fn;(tf&&Nf(new tf(new ArrayBuffer(1)))!=ft||rf&&Nf(new rf)!=Xe||nf&&Nf(nf.resolve())!=tt||af&&Nf(new af)!=at||of&&Nf(new of)!=st)&&(Nf=function(e){var t=fn(e),r=t==et?e.constructor:ae,n=r?no(r):"";if(n)switch(n){case cf:return ft;case ff:return Xe;case hf:return tt;case mf:return at;case df:return st}return t});var jf=yc?is:Fl,Vf=eo(Cf),xf=qc||function(e,t){return un.setTimeout(e,t)},Rf=eo(Pf),Df=Wi(function(e){var t=[];return Vt.test(e)&&t.push(""),e.replace(xt,function(e,r,n,a){t.push(n?a.replace(Jt,"$1"):r||e)}),t}),Tf=ia(function(e,t){return Xu(e)?Fr(e,en(t,1,Xu,!0)):[]}),Uf=ia(function(e,t){var r=Ao(t);return Xu(r)&&(r=ae),Xu(e)?Fr(e,en(t,1,Xu,!0),Pi(r,2)):[]}),Hf=ia(function(e,t){var r=Ao(t);return Xu(r)&&(r=ae),Xu(e)?Fr(e,en(t,1,Xu,!0),ae,r):[]}),Kf=ia(function(e){var t=v(e,Pa);return t.length&&t[0]===e[0]?In(t):[]}),qf=ia(function(e){var t=Ao(e),r=v(e,Pa);return t===Ao(r)?t=ae:r.pop(),r.length&&r[0]===e[0]?In(r,Pi(t,2)):[];
}),Mf=ia(function(e){var t=Ao(e),r=v(e,Pa);return t="function"==typeof t?t:ae,t&&r.pop(),r.length&&r[0]===e[0]?In(r,ae,t):[]}),Lf=ia(Oo),Jf=bi(function(e,t){var r=null==e?0:e.length,n=Tr(e,t);return ta(e,v(t,function(e){return Ti(e,r)?+e:e}).sort(Da)),n}),Ff=ia(function(e){return ga(en(e,1,Xu,!0))}),Wf=ia(function(e){var t=Ao(e);return Xu(t)&&(t=ae),ga(en(e,1,Xu,!0),Pi(t,2))}),Gf=ia(function(e){var t=Ao(e);return t="function"==typeof t?t:ae,ga(en(e,1,Xu,!0),ae,t)}),zf=ia(function(e,t){return Xu(e)?Fr(e,t):[]}),$f=ia(function(e){return Sa(h(e,Xu))}),Qf=ia(function(e){var t=Ao(e);return Xu(t)&&(t=ae),Sa(h(e,Xu),Pi(t,2))}),Xf=ia(function(e){var t=Ao(e);return t="function"==typeof t?t:ae,Sa(h(e,Xu),ae,t)}),Yf=ia(Qo),Zf=ia(function(e){var t=e.length,r=t>1?e[t-1]:ae;return r="function"==typeof r?(e.pop(),r):ae,Xo(e,r)}),eh=bi(function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,i=function(t){return Tr(t,e)};return!(t>1||this.__actions__.length)&&n instanceof w&&Ti(r)?(n=n.slice(r,+r+(t?1:0)),n.__actions__.push({func:ru,args:[i],thisArg:ae}),new a(n,this.__chain__).thru(function(e){return t&&!e.length&&e.push(ae),e})):this.thru(i)}),th=Ja(function(e,t,r){wc.call(e,r)?++e[r]:Dr(e,r,1)}),rh=Za(vo),nh=Za(po),ah=Ja(function(e,t,r){wc.call(e,r)?e[r].push(t):Dr(e,r,[t])}),ih=ia(function(e,t,r){var n=-1,a="function"==typeof t,i=Qu(e)?oc(e.length):[];return bf(e,function(e){i[++n]=a?u(t,e,r):On(e,t,r)}),i}),oh=Ja(function(e,t,r){Dr(e,r,t)}),uh=Ja(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),sh=ia(function(e,t){if(null==e)return[];var r=t.length;return r>1&&Ui(e,t[0],t[1])?t=[]:r>2&&Ui(t[0],t[1],t[2])&&(t=[t[0]]),Qn(e,en(t,1),[])}),lh=Kc||function(){return un.Date.now()},ch=ia(function(e,t,r){var n=ge;if(r.length){var a=z(r,Ci(ch));n|=Se}return hi(e,n,t,r,a)}),fh=ia(function(e,t,r){var n=ge|ye;if(r.length){var a=z(r,Ci(fh));n|=Se}return hi(t,n,e,r,a)}),hh=ia(function(e,t){return Jr(e,1,t)}),mh=ia(function(e,t,r){return Jr(e,Os(t)||0,r)});Ru.Cache=fr;var dh=Af(function(e,t){t=1==t.length&&kh(t[0])?v(t[0],R(Pi())):v(en(t,1),R(Pi()));var r=t.length;return ia(function(n){for(var a=-1,i=Qc(n.length,r);++a<i;)n[a]=t[a].call(this,n[a]);return u(e,this,n)})}),vh=ia(function(e,t){var r=z(t,Ci(vh));return hi(e,Se,ae,t,r)}),ph=ia(function(e,t){var r=z(t,Ci(ph));return hi(e,Ce,ae,t,r)}),gh=bi(function(e,t){return hi(e,Ae,ae,ae,ae,t)}),yh=si(hn),bh=si(function(e,t){return e>=t}),wh=Bn(function(){return arguments}())?Bn:function(e){return ls(e)&&wc.call(e,"callee")&&!Vc.call(e,"callee")},kh=oc.isArray,Sh=mn?R(mn):En,Ch=Fc||Fl,Ph=dn?R(dn):Nn,Ah=vn?R(vn):xn,Ih=pn?R(pn):Tn,_h=gn?R(gn):Un,Oh=yn?R(yn):Hn,Bh=si(Ln),Eh=si(function(e,t){return e<=t}),Nh=Fa(function(e,t){if(Li(t)||Qu(t))return void qa(t,Js(t),e);for(var r in t)wc.call(t,r)&&Nr(e,r,t[r])}),jh=Fa(function(e,t){qa(t,Fs(t),e)}),Vh=Fa(function(e,t,r,n){qa(t,Fs(t),e,n)}),xh=Fa(function(e,t,r,n){qa(t,Js(t),e,n)}),Rh=bi(Tr),Dh=ia(function(e){return e.push(ae,mi),u(Vh,ae,e)}),Th=ia(function(e){return e.push(ae,di),u(Mh,ae,e)}),Uh=ri(function(e,t,r){e[t]=r},jl(xl)),Hh=ri(function(e,t,r){wc.call(e,t)?e[t].push(r):e[t]=[r]},Pi),Kh=ia(On),qh=Fa(function(e,t,r){Gn(e,t,r)}),Mh=Fa(function(e,t,r,n){Gn(e,t,r,n)}),Lh=bi(function(e,t){var r={};if(null==e)return r;var n=!1;t=v(t,function(t){return t=Ia(t,e),n||(n=t.length>1),t}),qa(e,ki(e),r),n&&(r=Hr(r,he|me|de,vi));for(var a=t.length;a--;)ya(r,t[a]);return r}),Jh=bi(function(e,t){return null==e?{}:Xn(e,t)}),Fh=fi(Js),Wh=fi(Fs),Gh=Qa(function(e,t,r){return t=t.toLowerCase(),e+(r?sl(t):t)}),zh=Qa(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),$h=Qa(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),Qh=$a("toLowerCase"),Xh=Qa(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}),Yh=Qa(function(e,t,r){return e+(r?" ":"")+em(t)}),Zh=Qa(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),em=$a("toUpperCase"),tm=ia(function(e,t){try{return u(e,ae,t)}catch(e){return ns(e)?e:new sc(e)}}),rm=bi(function(e,t){return l(t,function(t){t=ro(t),Dr(e,t,ch(e[t],e))}),e}),nm=ei(),am=ei(!0),im=ia(function(e,t){return function(r){return On(r,e,t)}}),om=ia(function(e,t){return function(r){return On(e,r,t)}}),um=ai(v),sm=ai(f),lm=ai(b),cm=ui(),fm=ui(!0),hm=ni(function(e,t){return e+t},0),mm=ci("ceil"),dm=ni(function(e,t){return e/t},1),vm=ci("floor"),pm=ni(function(e,t){return e*t},1),gm=ci("round"),ym=ni(function(e,t){return e-t},0);return r.after=Ou,r.ary=Bu,r.assign=Nh,r.assignIn=jh,r.assignInWith=Vh,r.assignWith=xh,r.at=Rh,r.before=Eu,r.bind=ch,r.bindAll=rm,r.bindKey=fh,r.castArray=Lu,r.chain=eu,r.chunk=oo,r.compact=uo,r.concat=so,r.cond=El,r.conforms=Nl,r.constant=jl,r.countBy=th,r.create=js,r.curry=Nu,r.curryRight=ju,r.debounce=Vu,r.defaults=Dh,r.defaultsDeep=Th,r.defer=hh,r.delay=mh,r.difference=Tf,r.differenceBy=Uf,r.differenceWith=Hf,r.drop=lo,r.dropRight=co,r.dropRightWhile=fo,r.dropWhile=ho,r.fill=mo,r.filter=fu,r.flatMap=hu,r.flatMapDeep=mu,r.flatMapDepth=du,r.flatten=go,r.flattenDeep=yo,r.flattenDepth=bo,r.flip=xu,r.flow=nm,r.flowRight=am,r.fromPairs=wo,r.functions=Hs,r.functionsIn=Ks,r.groupBy=ah,r.initial=Co,r.intersection=Kf,r.intersectionBy=qf,r.intersectionWith=Mf,r.invert=Uh,r.invertBy=Hh,r.invokeMap=ih,r.iteratee=Rl,r.keyBy=oh,r.keys=Js,r.keysIn=Fs,r.map=yu,r.mapKeys=Ws,r.mapValues=Gs,r.matches=Dl,r.matchesProperty=Tl,r.memoize=Ru,r.merge=qh,r.mergeWith=Mh,r.method=im,r.methodOf=om,r.mixin=Ul,r.negate=Du,r.nthArg=ql,r.omit=Lh,r.omitBy=zs,r.once=Tu,r.orderBy=bu,r.over=um,r.overArgs=dh,r.overEvery=sm,r.overSome=lm,r.partial=vh,r.partialRight=ph,r.partition=uh,r.pick=Jh,r.pickBy=$s,r.property=Ml,r.propertyOf=Ll,r.pull=Lf,r.pullAll=Oo,r.pullAllBy=Bo,r.pullAllWith=Eo,r.pullAt=Jf,r.range=cm,r.rangeRight=fm,r.rearg=gh,r.reject=Su,r.remove=No,r.rest=Uu,r.reverse=jo,r.sampleSize=Pu,r.set=Xs,r.setWith=Ys,r.shuffle=Au,r.slice=Vo,r.sortBy=sh,r.sortedUniq=Ko,r.sortedUniqBy=qo,r.split=bl,r.spread=Hu,r.tail=Mo,r.take=Lo,r.takeRight=Jo,r.takeRightWhile=Fo,r.takeWhile=Wo,r.tap=tu,r.throttle=Ku,r.thru=ru,r.toArray=Ps,r.toPairs=Fh,r.toPairsIn=Wh,r.toPath=Ql,r.toPlainObject=Bs,r.transform=Zs,r.unary=qu,r.union=Ff,r.unionBy=Wf,r.unionWith=Gf,r.uniq=Go,r.uniqBy=zo,r.uniqWith=$o,r.unset=el,r.unzip=Qo,r.unzipWith=Xo,r.update=tl,r.updateWith=rl,r.values=nl,r.valuesIn=al,r.without=zf,r.words=Bl,r.wrap=Mu,r.xor=$f,r.xorBy=Qf,r.xorWith=Xf,r.zip=Yf,r.zipObject=Yo,r.zipObjectDeep=Zo,r.zipWith=Zf,r.entries=Fh,r.entriesIn=Wh,r.extend=jh,r.extendWith=Vh,Ul(r,r),r.add=hm,r.attempt=tm,r.camelCase=Gh,r.capitalize=sl,r.ceil=mm,r.clamp=il,r.clone=Ju,r.cloneDeep=Wu,r.cloneDeepWith=Gu,r.cloneWith=Fu,r.conformsTo=zu,r.deburr=ll,r.defaultTo=Vl,r.divide=dm,r.endsWith=cl,r.eq=$u,r.escape=fl,r.escapeRegExp=hl,r.every=cu,r.find=rh,r.findIndex=vo,r.findKey=Vs,r.findLast=nh,r.findLastIndex=po,r.findLastKey=xs,r.floor=vm,r.forEach=vu,r.forEachRight=pu,r.forIn=Rs,r.forInRight=Ds,r.forOwn=Ts,r.forOwnRight=Us,r.get=qs,r.gt=yh,r.gte=bh,r.has=Ms,r.hasIn=Ls,r.head=ko,r.identity=xl,r.includes=gu,r.indexOf=So,r.inRange=ol,r.invoke=Kh,r.isArguments=wh,r.isArray=kh,r.isArrayBuffer=Sh,r.isArrayLike=Qu,r.isArrayLikeObject=Xu,r.isBoolean=Yu,r.isBuffer=Ch,r.isDate=Ph,r.isElement=Zu,r.isEmpty=es,r.isEqual=ts,r.isEqualWith=rs,r.isError=ns,r.isFinite=as,r.isFunction=is,r.isInteger=os,r.isLength=us,r.isMap=Ah,r.isMatch=cs,r.isMatchWith=fs,r.isNaN=hs,r.isNative=ms,r.isNil=vs,r.isNull=ds,r.isNumber=ps,r.isObject=ss,r.isObjectLike=ls,r.isPlainObject=gs,r.isRegExp=Ih,r.isSafeInteger=ys,r.isSet=_h,r.isString=bs,r.isSymbol=ws,r.isTypedArray=Oh,r.isUndefined=ks,r.isWeakMap=Ss,r.isWeakSet=Cs,r.join=Po,r.kebabCase=zh,r.last=Ao,r.lastIndexOf=Io,r.lowerCase=$h,r.lowerFirst=Qh,r.lt=Bh,r.lte=Eh,r.max=Yl,r.maxBy=Zl,r.mean=ec,r.meanBy=tc,r.min=rc,r.minBy=nc,r.stubArray=Jl,r.stubFalse=Fl,r.stubObject=Wl,r.stubString=Gl,r.stubTrue=zl,r.multiply=pm,r.nth=_o,r.noConflict=Hl,r.noop=Kl,r.now=lh,r.pad=ml,r.padEnd=dl,r.padStart=vl,r.parseInt=pl,r.random=ul,r.reduce=wu,r.reduceRight=ku,r.repeat=gl,r.replace=yl,r.result=Qs,r.round=gm,r.runInContext=e,r.sample=Cu,r.size=Iu,r.snakeCase=Xh,r.some=_u,r.sortedIndex=xo,r.sortedIndexBy=Ro,r.sortedIndexOf=Do,r.sortedLastIndex=To,r.sortedLastIndexBy=Uo,r.sortedLastIndexOf=Ho,r.startCase=Yh,r.startsWith=wl,r.subtract=ym,r.sum=ac,r.sumBy=ic,r.template=kl,r.times=$l,r.toFinite=As,r.toInteger=Is,r.toLength=_s,r.toLower=Sl,r.toNumber=Os,r.toSafeInteger=Es,r.toString=Ns,r.toUpper=Cl,r.trim=Pl,r.trimEnd=Al,r.trimStart=Il,r.truncate=_l,r.unescape=Ol,r.uniqueId=Xl,r.upperCase=Zh,r.upperFirst=em,r.each=vu,r.eachRight=pu,r.first=ko,Ul(r,function(){var e={};return tn(r,function(t,n){wc.call(r.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),r.VERSION=ie,l(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){r[e].placeholder=r}),l(["drop","take"],function(e,t){w.prototype[e]=function(r){r=r===ae?1:$c(Is(r),0);var n=this.__filtered__&&!t?new w(this):this.clone();return n.__filtered__?n.__takeCount__=Qc(r,n.__takeCount__):n.__views__.push({size:Qc(r,Ue),type:e+(n.__dir__<0?"Right":"")}),n},w.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),l(["filter","map","takeWhile"],function(e,t){var r=t+1,n=r==Ne||r==Ve;w.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Pi(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}}),l(["head","last"],function(e,t){var r="take"+(t?"Right":"");w.prototype[e]=function(){return this[r](1).value()[0]}}),l(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");w.prototype[e]=function(){return this.__filtered__?new w(this):this[r](1)}}),w.prototype.compact=function(){return this.filter(xl)},w.prototype.find=function(e){return this.filter(e).head()},w.prototype.findLast=function(e){return this.reverse().find(e)},w.prototype.invokeMap=ia(function(e,t){return"function"==typeof e?new w(this):this.map(function(r){return On(r,e,t)})}),w.prototype.reject=function(e){return this.filter(Du(Pi(e)))},w.prototype.slice=function(e,t){e=Is(e);var r=this;return r.__filtered__&&(e>0||t<0)?new w(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==ae&&(t=Is(t),r=t<0?r.dropRight(-t):r.take(t-e)),r)},w.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},w.prototype.toArray=function(){return this.take(Ue)},tn(w.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=r[i?"take"+("last"==t?"Right":""):t],u=i||/^find/.test(t);o&&(r.prototype[t]=function(){var t=this.__wrapped__,s=i?[1]:arguments,l=t instanceof w,c=s[0],f=l||kh(t),h=function(e){var t=o.apply(r,p([e],s));return i&&m?t[0]:t};f&&n&&"function"==typeof c&&1!=c.length&&(l=f=!1);var m=this.__chain__,d=!!this.__actions__.length,v=u&&!m,g=l&&!d;if(!u&&f){t=g?t:new w(this);var y=e.apply(t,s);return y.__actions__.push({func:ru,args:[h],thisArg:ae}),new a(y,m)}return v&&g?e.apply(this,s):(y=this.thru(h),v?i?y.value()[0]:y.value():y)})}),l(["pop","push","shift","sort","splice","unshift"],function(e){var t=vc[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);r.prototype[e]=function(){var e=arguments;if(a&&!this.__chain__){var r=this.value();return t.apply(kh(r)?r:[],e)}return this[n](function(r){return t.apply(kh(r)?r:[],e)})}}),tn(w.prototype,function(e,t){var n=r[t];if(n){var a=n.name+"",i=lf[a]||(lf[a]=[]);i.push({name:t,func:n})}}),lf[ti(ae,ye).name]=[{name:"wrapper",func:ae}],w.prototype.clone=B,w.prototype.reverse=X,w.prototype.value=te,r.prototype.at=eh,r.prototype.chain=nu,r.prototype.commit=au,r.prototype.next=iu,r.prototype.plant=uu,r.prototype.reverse=su,r.prototype.toJSON=r.prototype.valueOf=r.prototype.value=lu,r.prototype.first=r.prototype.head,Dc&&(r.prototype[Dc]=ou),r},Pn=Cn();un._=Pn,n=function(){return Pn}.call(t,r,t,a),!(n!==ae&&(a.exports=n))}).call(this)}).call(t,function(){return this}(),r(2)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a="https://localhost:10443/v1",i="/trust1team/gclds/v1",o="/trust1team/ocv-api/v1",u="/gcl-ds-web/v1",s="/trust1team/gclds-file/v1",l=!0,c=!1,f=!1,h=function(){function e(e,t){this._gclUrl=a,this._dsUrl=e+i,this._ocvUrl=e+o,this._dsFileDownloadUrl=e+s,this._dsUrlBase=e,this._apiKey=t,this._jwt="none",this._allowAutoUpdate=l,this._implicitDownload=c,this._localTestMode=f,this._forceHardwarePinpad=!1}return Object.defineProperty(e.prototype,"ocvUrl",{get:function(){return this._ocvUrl},set:function(e){this._ocvUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gclUrl",{get:function(){return this._gclUrl},set:function(e){this._gclUrl=e||a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dsUrl",{get:function(){return this._dsUrl},set:function(e){n.endsWith(e,i)?(this._dsUrlBase=n.replace(e,i,""),this._dsUrl=e,this._dsFileDownloadUrl=this._dsUrlBase+s):(this._dsUrl=e+i,this._dsFileDownloadUrl=e+s,this._dsUrlBase=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"apiKey",{get:function(){return this._apiKey},set:function(e){this._apiKey=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowAutoUpdate",{get:function(){return this._allowAutoUpdate},set:function(e){this._allowAutoUpdate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"client_id",{get:function(){return this._client_id},set:function(e){this._client_id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"client_secret",{get:function(){return this._client_secret},set:function(e){this._client_secret=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jwt",{get:function(){return this._jwt},set:function(e){this._jwt=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implicitDownload",{get:function(){return this._implicitDownload},set:function(e){this._implicitDownload=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dsFileDownloadUrl",{get:function(){return this._dsFileDownloadUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dsUrlBase",{get:function(){return this._dsUrlBase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localTestMode",{get:function(){return this._localTestMode},set:function(e){this._localTestMode=e,this._localTestMode&&(this._dsUrl=this._dsUrlBase+u)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forceHardwarePinpad",{get:function(){return this._forceHardwarePinpad},set:function(e){this._forceHardwarePinpad=e},enumerable:!0,configurable:!0}),e}();t.GCLConfig=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(5),i=r(6),o="/",u="/plugins",s="/card-readers",l="/admin/activate",c="/admin/certificate",f=function(){function e(e,t){this.url=e,this.connection=t}return e.cardInsertedFilter=function(e){return{"card-inserted":e}},e.platformInfo=function(){return{data:{manufacturer:a.manufacturer||"",browser:{name:a.name,version:a.version},os:{name:a.os.family,version:a.os.version,architecture:a.os.architecture},ua:a.ua},success:!0}},e.prototype.activate=function(e){return this.connection.post(this.url+l,{},void 0,e)},e.prototype.getPubKey=function(e){return this.connection.get(this.url+c,void 0,e)},e.prototype.info=function(e){return this.connection.get(this.url+o,void 0,e)},e.prototype.infoBrowser=function(t){return t?void t(null,e.platformInfo()):i.Promise.resolve(e.platformInfo())},e.prototype.plugins=function(e){return this.connection.get(this.url+u,void 0,e)},e.prototype.pollCardInserted=function(e,t,r,a,o){function u(e,i){n.delay(function(){--s,l.readers(function(l,c){if(l&&(r&&r(),u(e,i)),0===s){if(o)return o();i&&i({success:!1,message:"Timed out"})}else if(0===c.data.length)r&&r(),u(e,i);else{var f=n.find(c.data,function(e){return n.has(e,"card")});if(null!=f){if(!e)return t(null,f);e(f)}else a&&a(),u(e,i)}})},1e3)}var s=e||30,l=this;return t?void u():new i.Promise(function(e,t){u(e,t)})},e.prototype.pollReadersWithCards=function(e,t,r,a,o){function u(e,i){n.delay(function(){--s,l.readers(function(l,c){if(l&&(r&&r(),u(e,i)),0===s){if(o)return o();i&&i({success:!1,message:"Timed out"})}else if(n.isEmpty(c)||n.isEmpty(c.data))r&&r(),u(e,i);else{var f=n.filter(c.data,function(e){return n.has(e,"card")});if(f.length){var h={data:f,success:!0};if(!e)return t(null,h);e(h)}else a&&a(),u(e,i)}})},1e3)}var s=e||30,l=this;return t?void u():new i.Promise(function(e,t){u(e,t)})},e.prototype.pollReaders=function(e,t,r,a){function o(e,i){n.delay(function(){--u,s.readers(function(s,l){if(s&&(r&&r(),o(e,i)),0===u){if(a)return a();i&&i({success:!1,message:"Timed out"})}else if(n.isEmpty(l)||n.isEmpty(l.data))r&&r(),o(e,i);else{if(!e)return t(null,l);e(l)}})},1e3)}var u=e||30,s=this;return t?void o():new i.Promise(function(e,t){o(e,t)})},e.prototype.reader=function(e,t){return this.connection.get(this.url+s+"/"+e,void 0,t)},e.prototype.readers=function(e){return this.connection.get(this.url+s,void 0,e)},e.prototype.readersCardAvailable=function(t){return this.connection.get(this.url+s,e.cardInsertedFilter(!0),t)},e.prototype.readersCardsUnavailable=function(t){return this.connection.get(this.url+s,e.cardInsertedFilter(!1),t)},e.prototype.setPubKey=function(e,t){return this.connection.put(this.url+c,{certificate:e},void 0,t)},e.prototype.infoBrowserSync=function(){return e.platformInfo()},e.prototype.getUrl=function(){return this.url},e.prototype.version=function(){return"v1.0.2"},e}();t.CoreService=f},function(e,t,r){var n;(function(e,a){(function(){"use strict";function i(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function o(e,t,r){var n={6.4:"10",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),e=s(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").split(" on ")[0])}function u(e,t){var r=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=S)for(;++r<n;)t(e[r],r,e);else l(e,t)}function s(e){return e=d(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:i(e)}function l(e,t){for(var r in e)I.call(e,r)&&t(e[r],r,e)}function c(e){return null==e?i(e):_.call(e).slice(8,-1)}function f(e,t){var r=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(r)||"object"==r&&!e[t])}function h(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function m(e,t){var r=null;return u(e,function(n,a){r=t(r,n,a,e)}),r}function d(e){return String(e).replace(/^ +| +$/g,"")}function v(e){function t(t){return m(t,function(t,r){return t||RegExp("\\b"+(r.pattern||h(r))+"\\b","i").exec(e)&&(r.label||r)})}function r(t){return m(t,function(t,r,n){return t||(r[$]||r[/^[a-z]+(?: +[a-z]+\b)*/i.exec($)]||RegExp("\\b"+h(n)+"(?:\\b|\\w*\\d)","i").exec(e))&&n})}function n(t){return m(t,function(t,r){return t||RegExp("\\b"+(r.pattern||h(r))+"\\b","i").exec(e)&&(r.label||r)})}function a(t){return m(t,function(t,r){var n=r.pattern||h(r);return!t&&(t=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=o(t,n,r.label||r)),t})}function i(t){return m(t,function(t,r){var n=r.pattern||h(r);return!t&&(t=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(r.label&&!RegExp(n,"i").test(r.label)?r.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),r=r.label||r,t=s(t[0].replace(RegExp(n,"i"),r).replace(RegExp("; *(?:"+r+"[_-])?","i")," ").replace(RegExp("("+r+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function u(t){return m(t,function(t,r){return t||(RegExp(r+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function p(){return this.description||""}var b=g,w=e&&"object"==typeof e&&"String"!=c(e);w&&(b=e,e=null);var k=b.navigator||{},S=k.userAgent||"";e||(e=S);var A,I,O=w||P==y,B=w?!!k.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(_.toString()),E="Object",N=w?E:"ScriptBridgingProxyObject",j=w?E:"Environment",V=w&&b.java?"JavaPackage":c(b.java),x=w?E:"RuntimeObject",R=/\bJava/.test(V)&&b.java,D=R&&c(b.environment)==j,T=R?"a":"α",U=R?"b":"β",H=b.document||{},K=b.operamini||b.opera,q=C.test(q=w&&K?K["[[Class]]"]:c(K))?q:K=null,M=e,L=[],J=null,F=e==S,W=F&&K&&"function"==typeof K.version&&K.version(),G=t(["Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),z=n(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel",{label:"SRWare Iron",pattern:"Iron"},"K-Meleon","Konqueror","Lunascape","Maxthon","Midori","Nook Browser","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser","Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),$=i([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nook","PlayBook","PlayStation 4","PlayStation 3","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Q=r({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),X=a(["Windows Phone ","Android","CentOS","Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(G&&(G=[G]),Q&&!$&&($=i([Q])),(A=/\bGoogle TV\b/.exec($))&&($=A[0]),/\bSimulator\b/i.test(e)&&($=($?$+" ":"")+"Simulator"),"Opera Mini"==z&&/\bOPiOS\b/.test(e)&&L.push("running in Turbo/Uncompressed mode"),/^iP/.test($)?(z||(z="Safari"),X="iOS"+((A=/ OS ([\d_]+)/i.exec(e))?" "+A[1].replace(/_/g,"."):"")):"Konqueror"!=z||/buntu/i.test(X)?Q&&"Google"!=Q&&(/Chrome/.test(z)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test($))?(z="Android Browser",X=/\bAndroid\b/.test(X)?X:"Android"):z&&!(A=!/\bMinefield\b|\(Android;/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(z))||(z&&!$&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(A+"/")+8))&&(z=null),(A=$||Q||X)&&($||Q||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(X))&&(z=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(X)?X:A)+" Browser")):X="Kubuntu",(A=/\((Mobile|Tablet).*?Firefox\b/i.exec(e))&&A[1]&&(X="Firefox OS",$||($=A[1])),W||(W=u(["(?:Cloud9|CriOS|CrMo|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",h(z),"(?:Firefox|Minefield|NetFront)"])),"iCab"==G&&parseFloat(W)>3?G=["WebKit"]:"Trident"!=G&&(A=/\bOpera\b/.test(z)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&"WebKit"||!G&&/\bMSIE\b/i.test(e)&&("Mac OS"==X?"Tasman":"Trident"))?G=[A]:/\bPlayStation\b(?! Vita\b)/i.test(z)&&"WebKit"==G&&(G=["NetFront"]),"IE"==z&&(A=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(z+=" Mobile",X="Windows Phone "+(/\+$/.test(A)?A:A+".x"),L.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(z="IE Mobile",X="Windows Phone 8+",L.unshift("desktop mode"),W||(W=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=z&&"Trident"==G&&(A=/\brv:([\d.]+)/.exec(e))?(/\bWPDesktop\b/i.test(e)||(z&&L.push("identifying as "+z+(W?" "+W:"")),z="IE"),W=A[1]):"Chrome"!=z&&"IE"==z||!(A=/\bEdge\/([\d.]+)/.exec(e))||(z="Microsoft Edge",W=A[1],G=["Trident"]),F){if(f(b,"global"))if(R&&(A=R.lang.System,M=A.getProperty("os.arch"),X=X||A.getProperty("os.name")+" "+A.getProperty("os.version")),O&&f(b,"system")&&(A=[b.system])[0]){X||(X=A[0].os||null);try{A[1]=b.require("ringo/engine").version,W=A[1].join("."),z="RingoJS"}catch(e){A[0].global.system==b.system&&(z="Narwhal")}}else"object"==typeof b.process&&(A=b.process)?(z="Node.js",M=A.arch,X=A.platform,W=/[\d.]+/.exec(A.version)[0]):D&&(z="Rhino");else c(A=b.runtime)==N?(z="Adobe AIR",X=A.flash.system.Capabilities.os):c(A=b.phantom)==x?(z="PhantomJS",W=(A=A.version||null)&&A.major+"."+A.minor+"."+A.patch):"number"==typeof H.documentMode&&(A=/\bTrident\/(\d+)/i.exec(e))&&(W=[W,H.documentMode],(A=+A[1]+4)!=W[1]&&(L.push("IE "+W[1]+" mode"),G&&(G[1]=""),W[1]=A),W="IE"==z?String(W[1].toFixed(1)):W[0]);X=X&&s(X)}W&&(A=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(W)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(F&&k.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(J=/b/i.test(A)?"beta":"alpha",W=W.replace(RegExp(A+"\\+?$"),"")+("beta"==J?U:T)+(/\d+\+?/.exec(A)||"")),"Fennec"==z||"Firefox"==z&&/\b(?:Android|Firefox OS)\b/.test(X)?z="Firefox Mobile":"Maxthon"==z&&W?W=W.replace(/\.[\d.]+/,".x"):"Silk"==z?(/\bMobi/i.test(e)||(X="Android",L.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&L.unshift("accelerated")):/\bXbox\b/i.test($)?(X=null,"Xbox 360"==$&&/\bIEMobile\b/.test(e)&&L.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(z)&&(!z||$||/Browser|Mobi/.test(z))||"Windows CE"!=X&&!/Mobi/i.test(e)?"IE"==z&&F&&null===b.external?L.unshift("platform preview"):(/\bBlackBerry\b/.test($)||/\bBB10\b/.test(e))&&(A=(RegExp($.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||W)?(A=[A,/BB10/.test(e)],X=(A[1]?($=null,Q="BlackBerry"):"Device Software")+" "+A[0],W=null):this!=l&&"Wii"!=$&&(F&&K||/Opera/.test(z)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==z&&/\bOS X (?:\d+\.){2,}/.test(X)||"IE"==z&&(X&&!/^Win/.test(X)&&W>5.5||/\bWindows XP\b/.test(X)&&W>8||8==W&&!/\bTrident\b/.test(e)))&&!C.test(A=v.call(l,e.replace(C,"")+";"))&&A.name&&(A="ing as "+A.name+((A=A.version)?" "+A:""),C.test(z)?(/\bIE\b/.test(A)&&"Mac OS"==X&&(X=null),A="identify"+A):(A="mask"+A,z=q?s(q.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(A)&&(X=null),F||(W=null)),G=["Presto"],L.push(A)):z+=" Mobile",(A=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(A=[parseFloat(A.replace(/\.(\d)$/,".0$1")),A],"Safari"==z&&"+"==A[1].slice(-1)?(z="WebKit Nightly",J="alpha",W=A[1].slice(0,-1)):W!=A[1]&&W!=(A[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(W=null),A[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==A[0]&&537.36==A[2]&&parseFloat(A[1])>=28&&"IE"!=z&&"Microsoft Edge"!=z&&(G=["Blink"]),F&&(B||A[1])?(G&&(G[1]="like Chrome"),A=A[1]||(A=A[0],A<530?1:A<532?2:A<532.05?3:A<533?4:A<534.03?5:A<534.07?6:A<534.1?7:A<534.13?8:A<534.16?9:A<534.24?10:A<534.3?11:A<535.01?12:A<535.02?"13+":A<535.07?15:A<535.11?16:A<535.19?17:A<536.05?18:A<536.1?19:A<537.01?20:A<537.11?"21+":A<537.13?23:A<537.18?24:A<537.24?25:A<537.36?26:"Blink"!=G?"27":"28")):(G&&(G[1]="like Safari"),A=A[0],A=A<400?1:A<500?2:A<526?3:A<533?4:A<534?"4+":A<535?5:A<537?6:A<538?7:A<601?8:"8"),G&&(G[1]+=" "+(A+="number"==typeof A?".x":/[.+]/.test(A)?"":"+")),"Safari"==z&&(!W||parseInt(W)>45)&&(W=A)),"Opera"==z&&(A=/\bzbov|zvav$/.exec(X))?(z+=" ",L.unshift("desktop mode"),"zvav"==A?(z+="Mini",W=null):z+="Mobile",X=X.replace(RegExp(" *"+A+"$"),"")):"Safari"==z&&/\bChrome\b/.exec(G&&G[1])&&(L.unshift("desktop mode"),z="Chrome Mobile",W=null,/\bOS X\b/.test(X)?(Q="Apple",X="iOS 4.3+"):X=null),W&&0==W.indexOf(A=/[\d.]+$/.exec(X))&&e.indexOf("/"+A+"-")>-1&&(X=d(X.replace(A,""))),G&&!/\b(?:Avant|Nook)\b/.test(z)&&(/Browser|Lunascape|Maxthon/.test(z)||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(z)&&G[1])&&(A=G[G.length-1])&&L.push(A),L.length&&(L=["("+L.join("; ")+")"]),Q&&$&&$.indexOf(Q)<0&&L.push("on "+Q),$&&L.push((/^on /.test(L[L.length-1])?"":"on ")+$),X&&(A=/ ([\d.+]+)$/.exec(X),I=A&&"/"==X.charAt(X.length-A[0].length-1),X={architecture:32,family:A&&!I?X.replace(A[0],""):X,version:A?A[1]:null,toString:function(){var e=this.version;return this.family+(e&&!I?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(A=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(M))&&!/\bi686\b/i.test(M)&&(X&&(X.architecture=64,X.family=X.family.replace(RegExp(" *"+A),"")),z&&(/\bWOW64\b/i.test(e)||F&&/\w(?:86|32)$/.test(k.cpuClass||k.platform)&&!/\bWin64; x64\b/i.test(e))&&L.unshift("32-bit")),e||(e=null);var Y={};return Y.description=e,Y.layout=G&&G[0],Y.manufacturer=Q,Y.name=z,Y.prerelease=J,Y.product=$,Y.ua=e,Y.version=z&&W,Y.os=X||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=v,Y.toString=p,Y.version&&L.unshift(W),Y.name&&L.unshift(z),X&&z&&(X!=String(X).split(" ")[0]||X!=z.split(" ")[0]&&!$)&&L.push($?"("+X+")":"on "+X),L.length&&(Y.description=L.join(" ")),Y}var p={function:!0,object:!0},g=p[typeof window]&&window||this,y=g,b=p[typeof t]&&t,w=p[typeof e]&&e&&!e.nodeType&&e,k=b&&w&&"object"==typeof a&&a;!k||k.global!==k&&k.window!==k&&k.self!==k||(g=k);var S=Math.pow(2,53)-1,C=/\bOpera/,P=this,A=Object.prototype,I=A.hasOwnProperty,_=A.toString;n=function(){return v()}.call(t,r,t,e),!(void 0!==n&&(e.exports=n))}).call(this)}).call(t,r(2)(e),function(){return this}())},function(e,t,r){var n;(function(e,a,i){(function(){"use strict";function o(e){return"function"==typeof e||"object"==typeof e&&null!==e}function u(e){return"function"==typeof e}function s(e){Q=e}function l(e){ee=e}function c(){return function(){e.nextTick(v)}}function f(){return function(){$(v)}}function h(){var e=0,t=new ne(v),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function m(){var e=new MessageChannel;return e.port1.onmessage=v,function(){e.port2.postMessage(0)}}function d(){return function(){setTimeout(v,1)}}function v(){for(var e=0;e<Z;e+=2){var t=oe[e],r=oe[e+1];t(r),oe[e]=void 0,oe[e+1]=void 0}Z=0}function p(){try{var e=r(8);return $=e.runOnLoop||e.runOnContext,f()}catch(e){return d()}}function g(e,t){var r=this,n=new this.constructor(b);void 0===n[le]&&U(n);var a=r._state;if(a){var i=arguments[a-1];ee(function(){R(a,n,i,r._result)})}else N(r,n,e,t);return n}function y(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(b);return _(r,e),r}function b(){}function w(){return new TypeError("You cannot resolve a promise with itself")}function k(){return new TypeError("A promises callback cannot return that same promise.")}function S(e){try{return e.then}catch(e){return me.error=e,me}}function C(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function P(e,t,r){ee(function(e){var n=!1,a=C(r,t,function(r){n||(n=!0,t!==r?_(e,r):B(e,r))},function(t){n||(n=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&a&&(n=!0,E(e,a))},e)}function A(e,t){t._state===fe?B(e,t._result):t._state===he?E(e,t._result):N(t,void 0,function(t){_(e,t)},function(t){E(e,t)})}function I(e,t,r){t.constructor===e.constructor&&r===ue&&constructor.resolve===se?A(e,t):r===me?E(e,me.error):void 0===r?B(e,t):u(r)?P(e,t,r):B(e,t)}function _(e,t){e===t?E(e,w()):o(t)?I(e,t,S(t)):B(e,t)}function O(e){e._onerror&&e._onerror(e._result),j(e)}function B(e,t){e._state===ce&&(e._result=t,e._state=fe,0!==e._subscribers.length&&ee(j,e))}function E(e,t){e._state===ce&&(e._state=he,e._result=t,ee(O,e))}function N(e,t,r,n){var a=e._subscribers,i=a.length;e._onerror=null,
a[i]=t,a[i+fe]=r,a[i+he]=n,0===i&&e._state&&ee(j,e)}function j(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,a,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?R(r,n,a,i):a(i);e._subscribers.length=0}}function V(){this.error=null}function x(e,t){try{return e(t)}catch(e){return de.error=e,de}}function R(e,t,r,n){var a,i,o,s,l=u(r);if(l){if(a=x(r,n),a===de?(s=!0,i=a.error,a=null):o=!0,t===a)return void E(t,k())}else a=n,o=!0;t._state!==ce||(l&&o?_(t,a):s?E(t,i):e===fe?B(t,a):e===he&&E(t,a))}function D(e,t){try{t(function(t){_(e,t)},function(t){E(e,t)})}catch(t){E(e,t)}}function T(){return ve++}function U(e){e[le]=ve++,e._state=void 0,e._result=void 0,e._subscribers=[]}function H(e){return new we(this,e).promise}function K(e){var t=this;return new t(Y(e)?function(r,n){for(var a=e.length,i=0;i<a;i++)t.resolve(e[i]).then(r,n)}:function(e,t){t(new TypeError("You must pass an array to race."))})}function q(e){var t=this,r=new t(b);return E(r,e),r}function M(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function J(e){this[le]=T(),this._result=this._state=void 0,this._subscribers=[],b!==e&&("function"!=typeof e&&M(),this instanceof J?D(this,e):L())}function F(e,t){this._instanceConstructor=e,this.promise=new e(b),this.promise[le]||U(this.promise),Y(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&B(this.promise,this._result))):E(this.promise,W())}function W(){return new Error("Array Methods must be provided an Array")}function G(){var e;if("undefined"!=typeof a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=be)}var z;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var $,Q,X,Y=z,Z=0,ee=function(e,t){oe[Z]=e,oe[Z+1]=t,Z+=2,2===Z&&(Q?Q(v):X())},te="undefined"!=typeof window?window:void 0,re=te||{},ne=re.MutationObserver||re.WebKitMutationObserver,ae="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),ie="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,oe=new Array(1e3);X=ae?c():ne?h():ie?m():void 0===te?p():d();var ue=g,se=y,le=Math.random().toString(36).substring(16),ce=void 0,fe=1,he=2,me=new V,de=new V,ve=0,pe=H,ge=K,ye=q,be=J;J.all=pe,J.race=ge,J.resolve=se,J.reject=ye,J._setScheduler=s,J._setAsap=l,J._asap=ee,J.prototype={constructor:J,then:ue,catch:function(e){return this.then(null,e)}};var we=F;F.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;this._state===ce&&r<e;r++)this._eachEntry(t[r],r)},F.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===se){var a=S(e);if(a===ue&&e._state!==ce)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===be){var i=new r(b);I(i,e,a),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){t(e)}),t)}else this._willSettleAt(n(e),t)},F.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===ce&&(this._remaining--,e===he?E(n,r):this._result[t]=r),0===this._remaining&&B(n,this._result)},F.prototype._willSettleAt=function(e,t){var r=this;N(e,void 0,function(e){r._settledAt(fe,t,e)},function(e){r._settledAt(he,t,e)})};var ke=G,Se={Promise:be,polyfill:ke};r(9).amd?(n=function(){return Se}.call(t,r,t,i),!(void 0!==n&&(i.exports=n))):"undefined"!=typeof i&&i.exports?i.exports=Se:"undefined"!=typeof this&&(this.ES6Promise=Se),ke()}).call(this)}).call(t,r(7),function(){return this}(),r(2)(e))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function a(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function o(){v&&m&&(v=!1,m.length?d=m.concat(d):p=-1,d.length&&u())}function u(){if(!v){var e=a(o);v=!0;for(var t=d.length;t;){for(m=d,d=[];++p<t;)m&&m[p].run();p=-1,t=d.length}m=null,v=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var c,f,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var m,d=[],v=!1,p=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new s(e,t)),1!==d.length||v||a(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.prependListener=l,h.prependOnceListener=l,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,r){"use strict";function n(e,t,r,n,a,i,u){var l={url:e,method:t,headers:{"Accept-Language":"en-US"},responseType:"json"};return r&&(l.data=r),n&&(l.params=n),a&&(l.headers.apikey=a),i&&(l.headers.Authorization="Bearer "+i),u=u||function(){},new s.Promise(function(e,t){o.default.request(l).then(function(t){return u(null,t.data),e(t.data)}).catch(function(e){return e.response?(u(e.response,null),t(e.response)):(u(e,null),t(e))})})}function a(e,t,r,n,a,i){var u={url:e,method:t,headers:{"Accept-Language":"en-US","X-Consumer-Username":"testorg.testapp.v1"},responseType:"json"};return r&&(u.data=r),n&&(u.params=n),a&&(u.headers.Authorization="Bearer "+a),i=i||function(){},new s.Promise(function(e,t){o.default.request(u).then(function(t){return i(null,t.data),e(t.data)}).catch(function(e){return e.response?(i(e.response,null),t(e.response)):(i(e,null),t(e))})})}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),u=r(1),s=r(6),l=function(){function e(e){this.config=e}return e.prototype.get=function(e,t,r){return n(e,"GET",void 0,t,this.config.apiKey,this.config.jwt,r)},e.prototype.post=function(e,t,r,a){return n(e,"POST",t,r,this.config.apiKey,this.config.jwt,a)},e.prototype.put=function(e,t,r,a){return n(e,"PUT",t,r,this.config.apiKey,this.config.jwt,a)},e}();t.GenericConnection=l;var c=function(e){function t(t){var r=e.call(this,t)||this;return r.config=u.omit(r.config,"apiKey"),r}return i(t,e),t}(l);t.LocalAuthConnection=c;var f=function(e){function t(t){var r=e.call(this,t)||this;return r.cfg=t,r.config=u.omit(r.config,["apiKey","jwt"]),r}return i(t,e),t}(l);t.LocalConnection=f;var h=function(e){function t(t){var r=e.call(this,t)||this;return r.cfg=t,r.config=u.omit(r.config,"jwt"),r}return i(t,e),t}(l);t.RemoteConnection=h;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config=void 0,t}return i(t,e),t.prototype.get=function(e,t,r){return a(e,"GET",void 0,t,void 0,r)},t.prototype.post=function(e,t,r,n){return a(e,"POST",t,r,void 0,n)},t.prototype.put=function(e,t,r,n){return a(e,"PUT",t,r,void 0,n)},t}(l);t.LocalTestConnection=m},function(e,t,r){e.exports=r(12)},function(e,t,r){"use strict";function n(e){var t=new o(e),r=i(o.prototype.request,t);return a.extend(r,o.prototype,t),a.extend(r,t),r}var a=r(13),i=r(14),o=r(15),u=r(16),s=n(u);s.Axios=o,s.create=function(e){return n(a.merge(u,e))},s.Cancel=r(33),s.CancelToken=r(34),s.isCancel=r(30),s.all=function(e){return Promise.all(e)},s.spread=r(35),e.exports=s,e.exports.default=s},function(e,t,r){"use strict";function n(e){return"[object Array]"===C.call(e)}function a(e){return"[object ArrayBuffer]"===C.call(e)}function i(e){return"undefined"!=typeof FormData&&e instanceof FormData}function o(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function u(e){return"string"==typeof e}function s(e){return"number"==typeof e}function l(e){return"undefined"==typeof e}function c(e){return null!==e&&"object"==typeof e}function f(e){return"[object Date]"===C.call(e)}function h(e){return"[object File]"===C.call(e)}function m(e){return"[object Blob]"===C.call(e)}function d(e){return"[object Function]"===C.call(e)}function v(e){return c(e)&&d(e.pipe)}function p(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function y(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function b(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||n(e)||(e=[e]),n(e))for(var r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function w(){function e(e,r){"object"==typeof t[r]&&"object"==typeof e?t[r]=w(t[r],e):t[r]=e}for(var t={},r=0,n=arguments.length;r<n;r++)b(arguments[r],e);return t}function k(e,t,r){return b(t,function(t,n){r&&"function"==typeof t?e[n]=S(t,r):e[n]=t}),e}var S=r(14),C=Object.prototype.toString;e.exports={isArray:n,isArrayBuffer:a,isFormData:i,isArrayBufferView:o,isString:u,isNumber:s,isObject:c,isUndefined:l,isDate:f,isFile:h,isBlob:m,isFunction:d,isStream:v,isURLSearchParams:p,isStandardBrowserEnv:y,forEach:b,merge:w,extend:k,trim:g}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},function(e,t,r){"use strict";function n(e){this.defaults=e,this.interceptors={request:new o,response:new o}}var a=r(16),i=r(13),o=r(27),u=r(28),s=r(31),l=r(32);n.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),e=i.merge(a,this.defaults,{method:"get"},e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url));var t=[u,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},i.forEach(["delete","get","head"],function(e){n.prototype[e]=function(t,r){return this.request(i.merge(r||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){n.prototype[e]=function(t,r,n){return this.request(i.merge(n||{},{method:e,url:t,data:r}))}}),e.exports=n},function(e,t,r){(function(t){"use strict";function n(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function a(){var e;return"undefined"!=typeof XMLHttpRequest?e=r(18):"undefined"!=typeof t&&(e=r(18)),e}var i=r(13),o=r(17),u=/^\)\]\}',?\n/,s={"Content-Type":"application/x-www-form-urlencoded"},l={adapter:a(),transformRequest:[function(e,t){return o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(n(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(n(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(u,"");try{e=JSON.parse(e)}catch(e){}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(e){l.headers[e]={}}),i.forEach(["post","put","patch"],function(e){l.headers[e]=i.merge(s)}),e.exports=l}).call(t,r(7))},function(e,t,r){"use strict";var n=r(13);e.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},function(e,t,r){(function(t){"use strict";var n=r(13),a=r(19),i=r(22),o=r(23),u=r(24),s=r(20),l="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(25);e.exports=function(e){return new Promise(function(c,f){var h=e.data,m=e.headers;n.isFormData(h)&&delete m["Content-Type"];var d=new XMLHttpRequest,v="onreadystatechange",p=!1;if("test"===t.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||u(e.url)||(d=new window.XDomainRequest,v="onload",p=!0,d.onprogress=function(){},d.ontimeout=function(){}),e.auth){var g=e.auth.username||"",y=e.auth.password||"";m.Authorization="Basic "+l(g+":"+y)}if(d.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d[v]=function(){if(d&&(4===d.readyState||p)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var t="getAllResponseHeaders"in d?o(d.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?d.response:d.responseText,n={data:r,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:t,config:e,request:d};a(c,f,n),d=null}},d.onerror=function(){f(s("Network Error",e)),d=null},d.ontimeout=function(){f(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED")),d=null},n.isStandardBrowserEnv()){var b=r(26),w=(e.withCredentials||u(e.url))&&e.xsrfCookieName?b.read(e.xsrfCookieName):void 0;w&&(m[e.xsrfHeaderName]=w)}if("setRequestHeader"in d&&n.forEach(m,function(e,t){"undefined"==typeof h&&"content-type"===t.toLowerCase()?delete m[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(e){if("json"!==d.responseType)throw e}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),f(e),d=null)}),void 0===h&&(h=null),d.send(h)})}}).call(t,r(7))},function(e,t,r){"use strict";var n=r(20);e.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r)):e(r)}},function(e,t,r){"use strict";var n=r(21);e.exports=function(e,t,r,a){var i=new Error(e);return n(i,t,r,a)}},function(e,t){"use strict";e.exports=function(e,t,r,n){return e.config=t,r&&(e.code=r),e.response=n,e}},function(e,t,r){"use strict";function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var a=r(13);e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(a.isURLSearchParams(t))i=t.toString();else{var o=[];a.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(a.isArray(e)&&(t+="[]"),a.isArray(e)||(e=[e]),a.forEach(e,function(e){a.isDate(e)?e=e.toISOString():a.isObject(e)&&(e=JSON.stringify(e)),o.push(n(t)+"="+n(e))}))}),i=o.join("&")}return i&&(e+=(e.indexOf("?")===-1?"?":"&")+i),e}},function(e,t,r){"use strict";var n=r(13);e.exports=function(e){var t,r,a,i={};return e?(n.forEach(e.split("\n"),function(e){a=e.indexOf(":"),t=n.trim(e.substr(0,a)).toLowerCase(),r=n.trim(e.substr(a+1)),t&&(i[t]=i[t]?i[t]+", "+r:r)}),i):i}},function(e,t,r){"use strict";var n=r(13);e.exports=n.isStandardBrowserEnv()?function(){function e(e){var t=e;return r&&(a.setAttribute("href",t),t=a.href),a.setAttribute("href",t),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}var t,r=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");return t=e(window.location.href),function(r){var a=n.isString(r)?e(r):r;return a.protocol===t.protocol&&a.host===t.host}}():function(){return function(){return!0}}()},function(e,t){"use strict";function r(){this.message="String contains an invalid character"}function n(e){for(var t,n,i=String(e),o="",u=0,s=a;i.charAt(0|u)||(s="=",u%1);o+=s.charAt(63&t>>8-u%1*8)){if(n=i.charCodeAt(u+=.75),n>255)throw new r;t=t<<8|n}return o}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=n},function(e,t,r){"use strict";var n=r(13);e.exports=n.isStandardBrowserEnv()?function(){return{write:function(e,t,r,a,i,o){var u=[];u.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(a)&&u.push("path="+a),n.isString(i)&&u.push("domain="+i),o===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,r){"use strict";function n(){this.handlers=[]}var a=r(13);n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){a.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=n},function(e,t,r){"use strict";function n(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var a=r(13),i=r(29),o=r(30),u=r(16);e.exports=function(e){n(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=a.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),a.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||u.adapter;return t(e).then(function(t){return n(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return o(t)||(n(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,r){"use strict";var n=r(13);e.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},function(e,t){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,r){"use strict";function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new a(e),t(r.reason))})}var a=r(33);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e,t=new n(function(t){e=t});return{token:t,cancel:e}},e.exports=n},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(6),i="/",o="?apikey=",u="/security",s="/system/status",l=u+"/jwt/issue",c=u+"/jwt/refresh",f="/download/gcl",h=u+"/keys/public",m="/devices",d=function(){function e(e,t,r){this.url=e,this.connection=t,this.cfg=r}return e.prototype.getUrl=function(){return this.url},e.prototype.getInfo=function(e){return this.connection.get(this.url+s,void 0,e)},e.prototype.getDevice=function(e,t){return this.connection.get(this.url+m+i+e,void 0,t)},e.prototype.getJWT=function(e){function t(t,n){r.connection.get(r.url+l,void 0,function(a,i){if(a){if(e)return e(a,null);n(a)}else{if(i&&i.token&&(r.cfg.jwt=i.token),e)return e(null,i);t(i)}})}var r=this;return e?void t():new a.Promise(function(e,r){t(e,r)})},e.prototype.refreshJWT=function(e){var t=this.cfg.jwt;if(t)return this.connection.post(this.url+c,{originalJWT:t},void 0,e);var r={code:"500",description:"No JWT available",status:412};return e?e(r,null):a.Promise.reject(r)},e.prototype.getPubKey=function(e){return this.connection.get(this.url+h,void 0,e)},e.prototype.downloadLink=function(e,t){function r(r,a){n.connection.post(n.url+f,e,void 0,function(e,i){if(!e){var u={url:n.cfg.dsUrlBase+i.path+o+n.cfg.apiKey};return t?t(null,u):r(u)}return t?t(e,null):void a(e)})}var n=this;return t?void r():new a.Promise(function(e,t){r(e,t)})},e.prototype.register=function(e,t,r){var a=n.merge({uuid:t,version:e.core_version},n.omit(e,"core_version"));return this.connection.put(this.url+m+i+t,a,void 0,r)},e.prototype.sync=function(e,t,r){var a=n.merge({uuid:t,version:e.core_version},n.omit(e,"core_version"));return this.connection.post(this.url+m+i+t,a,void 0,r)},e}();t.DSClient=d},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="/challenge",n="/certs/validate-chain",a="/system/status",i="/signature/validate",o=function(){function e(e,t){this.url=e,this.connection=t}return e.prototype.getUrl=function(){return this.url},e.prototype.validateSignature=function(e,t){return this.connection.post(this.url+i,e,void 0,t)},e.prototype.getInfo=function(e){return this.connection.get(this.url+a,void 0,e)},e.prototype.getChallenge=function(e,t){return this.connection.get(this.url+r,{digest:e},t)},e.prototype.validateChallengeSignedHash=function(e,t){return this.connection.post(this.url+r,e,void 0,t)},e.prototype.validateCertificateChain=function(e,t){return this.connection.post(this.url+n,e,void 0,t)},e}();t.OCVClient=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(39),a=r(153),i=r(154),o=r(155),u=r(156),s=r(157),l=r(158),c=r(159),f=r(160),h=r(161),m=r(162),d="/plugins/",v="/containers/",p=d+"beid",g=d+"luxeid",y=v+"dnie",b=d+"emv",w=d+"luxtrust",k=d+"mobib",S=d+"ocra",C=d+"aventra",P=d+"oberthur",A=d+"piv",I=d+"safenet",_=function(){function e(e,t){this.url=e,this.connection=t}return e.prototype.createDNI=function(e){return new h.DNI(this.url,y,this.connection,e)},e.prototype.createEidBE=function(e){return new a.EidBe(this.url,p,this.connection,e)},e.prototype.createEidLUX=function(e,t){return new i.EidLux(this.url,g,this.connection,e,t)},e.prototype.createEmv=function(e){return new n.EMV(this.url,b,this.connection,e)},e.prototype.createLuxTrust=function(e){return new u.LuxTrust(this.url,w,this.connection,e)},e.prototype.createMobib=function(e){return new o.Mobib(this.url,k,this.connection,e)},e.prototype.createOcra=function(e){return new s.Ocra(this.url,S,this.connection,e)},e.prototype.createAventraNO=function(e){return new l.Aventra(this.url,C,this.connection,e)},e.prototype.createOberthurNO=function(e){return new c.Oberthur(this.url,P,this.connection,e)},e.prototype.createPIV=function(e){return new f.PIV(this.url,A,this.connection,e)},e.prototype.createSafeNet=function(e){return new m.SafeNet(this.url,I,this.connection,e)},e}();t.PluginFactory=_},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i="/pan",o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.pan=function(e){return this.connection.get(this.resolvedReaderURI()+i,void 0,e)},t}(a.GenericPinCard);t.EMV=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(41),i=r(42),o=r(151),u=r(152),s=function(){function e(e,t,r,n){this.baseUrl=e,this.containerUrl=t,this.connection=r,this.reader_id=n}return e.createFilterQueryParam=function(e){return e&&e.length?{filter:e.join(",")}:void 0},e.prototype.resolvedReaderURI=function(){return this.baseUrl+this.containerUrl+"/"+this.reader_id},e}();t.GenericCard=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allData=function(e,t){var r=u.RequestHandler.determineOptionsWithFilter(e);return this.connection.get(this.resolvedReaderURI(),r.params).then(function(e){return i.CertParser.process(e,r.parseCerts,t)},function(e){return o.ResponseHandler.error(e,t)})},t}(s);t.GenericSmartCard=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.verifyPin=function(e,t){var r=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return r.connection.post(r.resolvedReaderURI()+f.VERIFY_PIN,e,void 0,t)})},t}(l);c.VERIFY_PIN="/verify-pin",t.GenericPinCard=c;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allAlgoRefsForAuthentication=function(e){return this.connection.get(this.resolvedReaderURI()+t.AUTHENTICATE,void 0,e)},t.prototype.allAlgoRefsForSigning=function(e){return this.connection.get(this.resolvedReaderURI()+t.SIGN_DATA,void 0,e)},t.prototype.allCerts=function(e,r){var n=u.RequestHandler.determineOptionsWithFilter(e);return this.connection.get(this.resolvedReaderURI()+t.ALL_CERTIFICATES,n.params).then(function(e){return i.CertParser.process(e,n.parseCerts,r)},function(e){return o.ResponseHandler.error(e,r)})},t.prototype.authenticate=function(e,r){var n=this;return e.algorithm_reference=e.algorithm_reference.toLocaleLowerCase(),a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.AUTHENTICATE,e,void 0,r)})},t.prototype.signData=function(e,r){var n=this;return e.algorithm_reference=e.algorithm_reference.toLocaleLowerCase(),a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.SIGN_DATA,e,void 0,r)})},t.prototype.getCertificate=function(e,r){var n=this;return n.connection.get(n.resolvedReaderURI()+t.ALL_CERTIFICATES+e,void 0).then(function(e){return i.CertParser.process(e,r.parseCerts,r.callback)},function(e){return o.ResponseHandler.error(e,r.callback)})},t}(c);f.ALL_CERTIFICATES="/certificates",f.AUTHENTICATE="/authenticate",f.CERT_ROOT="/root",f.CERT_AUTHENTICATION="/authentication",f.CERT_NON_REPUDIATION="/non-repudiation",f.CERT_ISSUER="/issuer",f.CERT_SIGNING="/signing",f.CERT_ENCRYPTION="/encryption",f.CERT_CITIZEN="/citizen",f.CERT_RRN="/rrn",f.SIGN_DATA="/sign",t.GenericCertCard=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allAlgoRefsForAuthentication=function(e){return this.connection.get(this.resolvedReaderURI()+t.AUTHENTICATE,void 0,e)},t.prototype.allAlgoRefsForSigning=function(e){return this.connection.get(this.resolvedReaderURI()+t.SIGN_DATA,void 0,e)},t.prototype.allData=function(e,t,r){var n=u.RequestHandler.determineOptionsWithFilter(e);return this.connection.post(this.resolvedReaderURI(),t,n.params).then(function(e){return i.CertParser.process(e,n.parseCerts,r)},function(e){return o.ResponseHandler.error(e,r)})},t.prototype.allCerts=function(e,r,n){var a=u.RequestHandler.determineOptionsWithFilter(e);return this.connection.post(this.resolvedReaderURI()+t.ALL_CERTIFICATES,r,a.params).then(function(e){return i.CertParser.process(e,a.parseCerts,n)},function(e){return o.ResponseHandler.error(e,n)})},t.prototype.verifyPin=function(e,r){var n=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.VERIFY_PIN,e,void 0,r)})},t.prototype.signData=function(e,r){var n=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.SIGN_DATA,e,void 0,r)})},t.prototype.authenticate=function(e,r){var n=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.AUTHENTICATE,e,void 0,r)})},t.prototype.getCertificate=function(e,r,n,u){var s=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,r.pin).then(function(){return s.connection.post(s.resolvedReaderURI()+t.ALL_CERTIFICATES+e,r,u)}).then(function(e){return i.CertParser.process(e,n.parseCerts,n.callback)}).catch(function(e){return o.ResponseHandler.error(e,n.callback)})},t.prototype.getCertificateArray=function(e,r,n,u){var s=this;return a.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,r.pin).then(function(){return s.connection.post(s.resolvedReaderURI()+t.ALL_CERTIFICATES+e,r,u)}).then(function(e){return i.CertParser.process(e,n.parseCerts,n.callback)}).catch(function(e){return o.ResponseHandler.error(e,n.callback)})},t}(s);h.ALL_CERTIFICATES="/certificates",h.AUTHENTICATE="/authenticate",h.CERT_AUTHENTICATION="/authentication",h.CERT_NON_REPUDIATION="/non-repudiation",h.CERT_INTERMEDIATE="/intermediate",h.CERT_ROOT="/root",h.CERT_SIGNING="/signing",h.SIGN_DATA="/sign",h.VERIFY_PIN="/verify-pin",t.GenericSecuredCertCard=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),a="/card-readers",i=function(){function e(){}return e.check=function(e,t,r,i){return new n.Promise(function(n,o){e.config.forceHardwarePinpad?e.get(t+a+"/"+r,void 0).then(function(e){e.data.pinpad?i?o({data:{message:"Strict pinpad enforcement is enabled. This request was sent with a PIN, but the reader has a pinpad."}}):n():i?o({data:{message:"Strict pinpad enforcement is enabled. This request was sent without a PIN, but the reader does not have a pinpad."}}):n()},function(e){o(e)}):n()})},e}();t.PinEnforcer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(43),i=r(45),o=r(46),u=r(151),s=function(){function e(){}return e.process=function(t,r,a){if(t&&t.data&&"object"==typeof t.data&&!n.isArray(t.data))n.forEach(t.data,function(n,a){a.indexOf("certificate")>-1&&"string"==typeof n&&(t.data[a]={base64:n},r&&(t.data[a].parsed=e.processCert(n)))});else if(n.isArray(t.data)){var i=[];n.forEach(t.data,function(t){var n={base64:t};r&&(n.parsed=e.processCert(t)),i.push(n)}),t.data=i}else{var o={base64:t.data};r&&(o.parsed=e.processCert(t.data)),t.data=o}return u.ResponseHandler.response(t,a)},e.processCert=function(t){var r=i.atob(t),n=e.str2ab(r),u=a.fromBER(n);return new o.Certificate({schema:u.result})},e.str2ab=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0,a=e.length;n<a;n++)r[n]=e.charCodeAt(n);return t},e}();t.CertParser=s},function(e,t,r){
"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r){function n(e,t){if(e instanceof t)return e;var r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}var a=t,i=new k({},Object);if((0,m.checkBufferParams)(new p,e,t,r)===!1)return i.error="Wrong input parameters",{offset:-1,result:i};var o=new Uint8Array(e,t,r);if(0===o.length)return this.error="Zero buffer length",{offset:-1,result:i};var u=i.idBlock.fromBER(e,t,r);if(i.warnings.concat(i.idBlock.warnings),u===-1)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=u,r-=i.idBlock.blockLength,u=i.lenBlock.fromBER(e,t,r),i.warnings.concat(i.lenBlock.warnings),u===-1)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=u,r-=i.lenBlock.blockLength,i.idBlock.isConstructed===!1&&i.lenBlock.isIndefiniteForm===!0)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};var s=k;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&i.idBlock.isHexOnly===!1)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed===!0&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};s=_;break;case 1:s=B;break;case 2:s=U;break;case 3:s=D;break;case 4:s=x;break;case 5:s=j;break;case 6:s=M;break;case 10:s=H;break;case 12:s=J;break;case 14:s=he;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:s=E;break;case 17:s=N;break;case 18:s=X;break;case 19:s=Y;break;case 20:s=Z;break;case 21:s=ee;break;case 22:s=te;break;case 23:s=oe;break;case 24:s=ue;break;case 25:s=re;break;case 26:s=ne;break;case 27:s=ae;break;case 28:s=z;break;case 29:s=ie;break;case 30:s=W;break;case 31:s=se;break;case 32:s=le;break;case 33:s=ce;break;case 34:s=fe;break;default:var l=void 0;l=i.idBlock.isConstructed===!0?new A:new C,l.idBlock=i.idBlock,l.lenBlock=i.lenBlock,l.warnings=i.warnings,i=l,u=i.fromBER(e,t,r)}break;case 2:case 3:case 4:default:s=i.idBlock.isConstructed===!0?A:C}return i=n(i,s),u=i.fromBER(e,t,i.lenBlock.isIndefiniteForm===!0?r:i.lenBlock.length),i.valueBeforeDecode=e.slice(a,a+i.blockLength),{offset:u,result:i}}function u(e){if(0===e.byteLength){var t=new k({},Object);return t.error="Input buffer has zero length",{offset:-1,result:t}}return o(e,0,e.byteLength)}function s(e,t,r){if(r instanceof me){for(var n=!1,a=0;a<r.value.length;a++){var i=s(e,t,r.value[a]);if(i.verified===!0)return{verified:!0,result:e}}if(n===!1){var o={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(o.name=r.name),o}}if(r instanceof de)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var l=r.idBlock.toBER(!1);if(0===l.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};var c=r.idBlock.fromBER(l,0,l.byteLength);if(c===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(r.idBlock.hasOwnProperty("tagClass")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(r.idBlock.hasOwnProperty("tagNumber")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(r.idBlock.hasOwnProperty("isConstructed")===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly===!0){if("valueHex"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var f=new Uint8Array(r.idBlock.valueHex),h=new Uint8Array(t.idBlock.valueHex);if(f.length!==h.length)return{verified:!1,result:e};for(var m=0;m<f.length;m++)if(f[m]!==h[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),r.idBlock.isConstructed===!0){var d=0,v={verified:!1},p=r.valueBlock.value.length;if(p>0&&r.valueBlock.value[0]instanceof ve&&(p=t.valueBlock.value.length),0===p)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){for(var g=!0,y=0;y<r.valueBlock.value.length;y++)g=g&&(r.valueBlock.value[y].optional||!1);return g===!0?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(var b=0;b<p;b++)if(b-d>=t.valueBlock.value.length){if(r.valueBlock.value[b].optional===!1){var w={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],w.name=r.name)),w}}else if(r.valueBlock.value[0]instanceof ve){if(v=s(e,t.valueBlock.value[b],r.valueBlock.value[0].value),v.verified===!1){if(r.valueBlock.value[0].optional!==!0)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),v;d++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){var k={};k="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local===!0?t:e,"undefined"==typeof k[r.valueBlock.value[0].name]&&(k[r.valueBlock.value[0].name]=[]),k[r.valueBlock.value[0].name].push(t.valueBlock.value[b])}}else if(v=s(e,t.valueBlock.value[b-d],r.valueBlock.value[b]),v.verified===!1){if(r.valueBlock.value[b].optional!==!0)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),v;d++}if(v.verified===!1){var S={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],S.name=r.name)),S}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){var C=u(t.valueBlock.valueHex);if(C.offset===-1){var P={verified:!1,result:C.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],P.name=r.name)),P}return s(e,C.result,r.primitiveSchema)}return{verified:!0,result:e}}function l(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};var r=u(e);return r.offset===-1?{verified:!1,result:r.result}:s(r.result,r.result,t)}function c(e){}Object.defineProperty(t,"__esModule",{value:!0}),t.RawData=t.Repeated=t.Any=t.Choice=t.TIME=t.Duration=t.DateTime=t.TimeOfDay=t.DATE=t.GeneralizedTime=t.UTCTime=t.CharacterString=t.GeneralString=t.VisibleString=t.GraphicString=t.IA5String=t.VideotexString=t.TeletexString=t.PrintableString=t.NumericString=t.UniversalString=t.BmpString=t.Utf8String=t.ObjectIdentifier=t.Enumerated=t.Integer=t.BitString=t.OctetString=t.Null=t.Set=t.Sequence=t.Boolean=t.EndOfContent=t.Constructed=t.Primitive=t.BaseBlock=void 0;var f=function e(t,r,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in a)return a.value;var o=a.get;if(void 0!==o)return o.call(n)},h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t.fromBER=u,t.compareSchema=s,t.verifySchema=l,t.fromJSON=c;var m=r(44),d=(new Uint8Array([0]),[new Uint8Array([1])]),v="0123456789",p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.blockLength=(0,m.getParametersValue)(t,"blockLength",0),this.error=(0,m.getParametersValue)(t,"error",""),this.warnings=(0,m.getParametersValue)(t,"warnings",[]),"valueBeforeDecode"in t?this.valueBeforeDecode=t.valueBeforeDecode.slice(0):this.valueBeforeDecode=new ArrayBuffer(0)}return h(e,[{key:"toJSON",value:function(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:(0,m.bufferToHexCodes)(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}],[{key:"blockName",value:function(){return"baseBlock"}}]),e}(),g=function(e){return function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=(0,m.getParametersValue)(e,"isHexOnly",!1),"valueHex"in e?r.valueHex=e.valueHex.slice(0):r.valueHex=new ArrayBuffer(0),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);return 0===n.length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isHexOnly!==!0?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):e===!0?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"hexBlock"}}]),t}(e)},y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"idBlock"in e?(r.isHexOnly=(0,m.getParametersValue)(e.idBlock,"isHexOnly",!1),r.valueHex=(0,m.getParametersValue)(e.idBlock,"valueHex",new ArrayBuffer(0)),r.tagClass=(0,m.getParametersValue)(e.idBlock,"tagClass",-1),r.tagNumber=(0,m.getParametersValue)(e.idBlock,"tagNumber",-1),r.isConstructed=(0,m.getParametersValue)(e.idBlock,"isConstructed",!1)):(r.tagClass=-1,r.tagNumber=-1,r.isConstructed=!1),r}return a(t,e),h(t,[{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0,r=void 0,n=void 0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){if(r=new ArrayBuffer(1),n=new Uint8Array(r),!e){var a=this.tagNumber;a&=31,t|=a,n[0]=t}return r}if(this.isHexOnly===!1){var i=(0,m.utilToBase)(this.tagNumber,7),o=new Uint8Array(i),u=i.byteLength;if(r=new ArrayBuffer(u+1),n=new Uint8Array(r),n[0]=31|t,!e){for(var s=0;s<u-1;s++)n[s+1]=128|o[s];n[u]=o[u-1]}return r}if(r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r),n[0]=31|t,e===!1){for(var l=new Uint8Array(this.valueHex),c=0;c<l.length-1;c++)n[c+1]=128|l[c];n[this.valueHex.byteLength]=l[l.length-1]}return r}},{key:"fromBER",value:function(e,t,r){if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;var a=192&n[0];switch(a){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32===(32&n[0]),this.isHexOnly=!1;var i=31&n[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{var o=1;this.valueHex=new ArrayBuffer(255);for(var u=255,s=new Uint8Array(this.valueHex);128&n[o];){if(s[o-1]=127&n[o],o++,o>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(o===u){u+=255;for(var l=new ArrayBuffer(u),c=new Uint8Array(l),f=0;f<s.length;f++)c[f]=s[f];this.valueHex=new ArrayBuffer(u),s=new Uint8Array(this.valueHex)}}this.blockLength=o+1,s[o-1]=127&n[o];for(var h=new ArrayBuffer(o),d=new Uint8Array(h),v=0;v<o;v++)d[v]=s[v];this.valueHex=new ArrayBuffer(o),s=new Uint8Array(this.valueHex),s.set(d),this.blockLength<=9?this.tagNumber=(0,m.utilFromBase)(s,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}],[{key:"blockName",value:function(){return"identificationBlock"}}]),t}(g(p)),b=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"lenBlock"in e?(r.isIndefiniteForm=(0,m.getParametersValue)(e.lenBlock,"isIndefiniteForm",!1),r.longFormUsed=(0,m.getParametersValue)(e.lenBlock,"longFormUsed",!1),r.length=(0,m.getParametersValue)(e.lenBlock,"length",0)):(r.isIndefiniteForm=!1,r.longFormUsed=!1,r.length=0),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],this.isIndefiniteForm===!0)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),this.longFormUsed===!1)return this.length=n[0],this.blockLength=1,t+this.blockLength;var a=127&n[0];if(a>8)return this.error="Too big integer",-1;if(a+1>n.length)return this.error="End of input reached before message was fully decoded",-1;for(var i=new Uint8Array(a),o=0;o<a;o++)i[o]=n[o+1];return 0===i[a-1]&&this.warnings.push("Needlessly long encoded length"),this.length=(0,m.utilFromBase)(i,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=a+1,t+this.blockLength}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=void 0;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed===!0){var n=(0,m.utilToBase)(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength+1),e===!0)return t;var a=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(var i=0;i<n.byteLength;i++)r[i+1]=a[i];return t}return t=new ArrayBuffer(1),e===!1&&(r=new Uint8Array(t),r[0]=this.length),t}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}],[{key:"blockName",value:function(){return"lengthBlock"}}]),t}(p),w=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}}],[{key:"blockName",value:function(){return"valueBlock"}}]),t}(p),k=t.BaseBlock=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;i(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"name"in e&&(a.name=e.name),"optional"in e&&(a.optional=e.optional),"primitiveSchema"in e&&(a.primitiveSchema=e.primitiveSchema),a.idBlock=new y(e),a.lenBlock=new b(e),a.valueBlock=new r(e),a}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=this.idBlock.toBER(e),n=this.valueBlock.toBER(!0);this.lenBlock.length=n.byteLength;var a=this.lenBlock.toBER(e);t=(0,m.utilConcatBuf)(r,a);var i=void 0;if(i=e===!1?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length),t=(0,m.utilConcatBuf)(t,i),this.lenBlock.isIndefiniteForm===!0){var o=new ArrayBuffer(2);if(e===!1){var u=new Uint8Array(o);u[0]=0,u[1]=0}t=(0,m.utilConcatBuf)(t,o)}return t}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}}],[{key:"blockName",value:function(){return"BaseBlock"}}]),t}(p),S=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"valueHex"in e?r.valueHex=e.valueHex.slice(0):r.valueHex=new ArrayBuffer(0),r.isHexOnly=(0,m.getParametersValue)(e,"isHexOnly",!0),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);for(var a=new Uint8Array(this.valueHex),i=0;i<n.length;i++)a[i]=n[i];return this.blockLength=r,t+r}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.valueHex=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}],[{key:"blockName",value:function(){return"PrimitiveValueBlock"}}]),t}(w),C=t.Primitive=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,S));return r.idBlock.isConstructed=!1,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"PRIMITIVE"}}]),t}(k),P=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.value=(0,m.getParametersValue)(e,"value",[]),r.isIndefiniteForm=(0,m.getParametersValue)(e,"isIndefiniteForm",!1),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){function n(e,t){return e===!0?1:t}var a=t,i=r;if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var u=new Uint8Array(e,t,r);if(0===u.length)return this.warnings.push("Zero buffer length"),t;for(var s=t;n(this.isIndefiniteForm,r)>0;){var l=o(e,s,r);if(l.offset===-1)return this.error=l.result.error,this.warnings.concat(l.result.warnings),-1;if(s=l.offset,this.blockLength+=l.result.blockLength,r-=l.result.blockLength,this.value.push(l.result),this.isIndefiniteForm===!0&&l.result.constructor.blockName()===_.blockName())break}return this.isIndefiniteForm===!0&&(this.value[this.value.length-1].constructor.blockName()===_.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(a,a+i),s}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);t=(0,m.utilConcatBuf)(t,n)}return t}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(var r=0;r<this.value.length;r++)e.value.push(this.value[r].toJSON());return e}}],[{key:"blockName",value:function(){return"ConstructedValueBlock"}}]),t}(w),A=t.Constructed=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,P));return r.idBlock.isConstructed=!0,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}}],[{key:"blockName",value:function(){return"CONSTRUCTED"}}]),t}(k),I=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){return t}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new ArrayBuffer(0)}}],[{key:"blockName",value:function(){return"EndOfContentValueBlock"}}]),t}(w),_=t.EndOfContent=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,I));return r.idBlock.tagClass=1,r.idBlock.tagNumber=0,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"EndOfContent"}}]),t}(k),O=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.value=(0,m.getParametersValue)(e,"value",!1),r.isHexOnly=(0,m.getParametersValue)(e,"isHexOnly",!1),"valueHex"in e)r.valueHex=e.valueHex.slice(0);else if(r.valueHex=new ArrayBuffer(1),r.value===!0){var a=new Uint8Array(r.valueHex);a[0]=255}return r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.value=0!==n[0],this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);for(var a=new Uint8Array(this.valueHex),i=0;i<n.length;i++)a[i]=n[i];return this.blockLength=r,t+r}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BooleanValueBlock"}}]),t}(w),B=t.Boolean=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,O));return r.idBlock.tagClass=1,r.idBlock.tagNumber=1,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"Boolean"}}]),t}(k),E=t.Sequence=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=16,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"Sequence"}}]),t}(A),N=t.Set=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=17,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"Set"}}]),t}(A),j=t.Null=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,p));return r.idBlock.tagClass=1,r.idBlock.tagNumber=5,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(2);if(e===!0)return t;var r=new Uint8Array(t);return r[0]=5,r[1]=0,t}}],[{key:"blockName",value:function(){return"Null"}}]),t}(k),V=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isConstructed=(0,m.getParametersValue)(e,"isConstructed",!1),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,r,n){var a=0;if(this.isConstructed===!0){if(this.isHexOnly=!1,a=P.prototype.fromBER.call(this,e,r,n),a===-1)return a;for(var i=0;i<this.value.length;i++){var o=this.value[i].constructor.blockName();if(o===_.blockName()){if(this.isIndefiniteForm===!0)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==x.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,a=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n),this.blockLength=n;return a}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isConstructed===!0)return P.prototype.toBER.call(this,e);var t=new ArrayBuffer(this.valueHex.byteLength);return e===!0?t:0===this.valueHex.byteLength?t:t=this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"OctetStringValueBlock"}}]),t}(g(P)),x=t.OctetString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,V));return r.idBlock.tagClass=1,r.idBlock.tagNumber=4,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,r,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===n?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),r):f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n)}},{key:"isEqual",value:function(e){return e instanceof t!=!1&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"OctetString"}}]),t}(k),R=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.unusedBits=(0,m.getParametersValue)(e,"unusedBits",0),r.isConstructed=(0,m.getParametersValue)(e,"isConstructed",!1),r.blockLength=r.valueHex.byteLength+1,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;var n=-1;if(this.isConstructed===!0){if(n=P.prototype.fromBER.call(this,e,t,r),n===-1)return n;for(var a=0;a<this.value.length;a++){var i=this.value[a].constructor.blockName();if(i===_.blockName()){if(this.isIndefiniteForm===!0)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(i!==D.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[a].unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[a].unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var o=new Uint8Array(e,t,r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(o.length-1);for(var u=new Uint8Array(this.valueHex),s=0;s<r-1;s++)u[s]=o[s+1];return this.blockLength=o.length,t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isConstructed===!0)return P.prototype.toBER.call(this,e);if(e===!0)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);var t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(var a=0;a<this.valueHex.byteLength;a++)n[a+1]=t[a];return r}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BitStringValueBlock"}}]),t}(g(P)),D=t.BitString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,R));return r.idBlock.tagClass=1,r.idBlock.tagNumber=3,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,r,n){return 0===n?r:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n))}},{key:"isEqual",value:function(e){return e instanceof t!=!1&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"BitString"}}]),t}(k),T=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"value"in e&&(r.valueDec=e.value),r}return a(t,e),h(t,[{key:"fromDER",value:function(e,t,r){
var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this.fromBER(e,t,r);if(a===-1)return a;var i=new Uint8Array(this._valueHex);if(0===i[0]&&0!==(128&i[1])){var o=new ArrayBuffer(this._valueHex.byteLength-1),u=new Uint8Array(o);u.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=o.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);var s=new ArrayBuffer(n),l=new Uint8Array(s);l.set(i,n-this._valueHex.byteLength),this._valueHex=s.slice(0)}return a}},{key:"toDER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Uint8Array(this._valueHex);switch(!0){case 0!==(128&t[0]):var r=new ArrayBuffer(this._valueHex.byteLength+1),n=new Uint8Array(r);n[0]=0,n.set(t,1),this._valueHex=r.slice(0);break;case 0===t[0]&&0===(128&t[1]):var a=new ArrayBuffer(this._valueHex.byteLength-1),i=new Uint8Array(a);i.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=a.slice(0)}return this.toBER(e)}},{key:"fromBER",value:function(e,r,n){var a=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n);return a===-1?a:(this.blockLength=n,r+n)}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.valueDec=this.valueDec,e}},{key:"toString",value:function(){function e(e,t){for(var r=new Uint8Array([0]),n=new Uint8Array(e),a=new Uint8Array(t),i=n.slice(0),o=i.length-1,u=a.slice(0),s=u.length-1,l=0,c=s<o?o:s,f=0,h=c;h>=0;h--,f++){switch(!0){case f<u.length:l=i[o-f]+u[s-f]+r[0];break;default:l=i[o-f]+r[0]}switch(r[0]=l/10,!0){case f>=i.length:i=(0,m.utilConcatView)(new Uint8Array([l%10]),i);break;default:i[o-f]=l%10}}return r[0]>0&&(i=(0,m.utilConcatView)(r,i)),i.slice(0)}function t(e){if(e>=d.length)for(var t=d.length;t<=e;t++){for(var r=new Uint8Array([0]),n=d[t-1].slice(0),a=n.length-1;a>=0;a--){var i=new Uint8Array([(n[a]<<1)+r[0]]);r[0]=i[0]/10,n[a]=i[0]%10}r[0]>0&&(n=(0,m.utilConcatView)(r,n)),d.push(n)}return d[e]}function r(e,t){for(var r=0,n=new Uint8Array(e),a=new Uint8Array(t),i=n.slice(0),o=i.length-1,u=a.slice(0),s=u.length-1,l=void 0,c=0,f=s;f>=0;f--,c++)switch(l=i[o-c]-u[s-c]-r,!0){case l<0:r=1,i[o-c]=l+10;break;default:r=0,i[o-c]=l}if(r>0)for(var h=o-s+1;h>=0;h--,c++){if(l=i[o-c]-r,!(l<0)){r=0,i[o-c]=l;break}r=1,i[o-c]=l+10}return i.slice()}for(var n=8*this._valueHex.byteLength-1,a=new Uint8Array(8*this._valueHex.byteLength/3),i=0,o=void 0,u=new Uint8Array(this._valueHex),s="",l=!1,c=this._valueHex.byteLength-1;c>=0;c--){o=u[c];for(var f=0;f<8;f++){if(1===(1&o))switch(i){case n:a=r(t(i),a),s="-";break;default:a=e(a,t(i))}i++,o>>=1}}for(var h=0;h<a.length;h++)a[h]&&(l=!0),l&&(s+=v.charAt(a[h]));return l===!1&&(s+=v.charAt(0)),s}},{key:"valueHex",set:function(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=m.utilDecodeTC.call(this)))},get:function(){return this._valueHex}},{key:"valueDec",set:function(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=(0,m.utilEncodeTC)(e)},get:function(){return this._valueDec}}],[{key:"blockName",value:function(){return"IntegerValueBlock"}}]),t}(g(w)),U=t.Integer=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,T));return r.idBlock.tagClass=1,r.idBlock.tagNumber=2,r}return a(t,e),h(t,[{key:"isEqual",value:function(e){return e instanceof t?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?(0,m.isEqualBuffer)(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&(0,m.isEqualBuffer)(this.valueBlock.valueHex,e)}},{key:"convertToDER",value:function(){var e=new t({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}},{key:"convertFromDER",value:function(){var e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,r=new t({valueHex:this.valueBlock.valueHex});return r.valueBlock.fromDER(r.valueBlock.valueHex,0,r.valueBlock.valueHex.byteLength,e),r}}],[{key:"blockName",value:function(){return"Integer"}}]),t}(k),H=t.Enumerated=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=10,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"Enumerated"}}]),t}(U),K=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.valueDec=(0,m.getParametersValue)(e,"valueDec",-1),r.isFirstSid=(0,m.getParametersValue)(e,"isFirstSid",!1),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;if((0,m.checkBufferParams)(this,e,t,r)===!1)return-1;var n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);for(var a=new Uint8Array(this.valueHex),i=0;i<r&&(a[i]=127&n[i],this.blockLength++,0!==(128&n[i]));i++);for(var o=new ArrayBuffer(this.blockLength),u=new Uint8Array(o),s=0;s<this.blockLength;s++)u[s]=a[s];return this.valueHex=o.slice(0),a=new Uint8Array(this.valueHex),0!==(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===a[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,m.utilFromBase)(a,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=void 0;if(this.isHexOnly){if(e===!0)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(var a=0;a<this.blockLength-1;a++)r[a]=128|n[a];return r[this.blockLength-1]=n[this.blockLength-1],t}var i=(0,m.utilToBase)(this.valueDec,7);if(0===i.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(i.byteLength),e===!1){var o=new Uint8Array(i);r=new Uint8Array(t);for(var u=0;u<i.byteLength-1;u++)r[u]=128|o[u];r[i.byteLength-1]=o[i.byteLength-1]}return t}},{key:"toString",value:function(){var e="";if(this.isHexOnly===!0)e=(0,m.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){var t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}],[{key:"blockName",value:function(){return"sidBlock"}}]),t}(g(p)),q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.fromString((0,m.getParametersValue)(e,"value","")),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){for(var n=t;r>0;){var a=new K;if(n=a.fromBER(e,n,r),n===-1)return this.blockLength=0,this.error=a.error,n;0===this.value.length&&(a.isFirstSid=!0),this.blockLength+=a.blockLength,r-=a.blockLength,this.value.push(a)}return n}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,m.utilConcatBuf)(t,n)}return t}},{key:"fromString",value:function(e){this.value=[];var t=0,r=0,n="",a=!1;do if(r=e.indexOf(".",t),n=r===-1?e.substr(t):e.substr(t,r-t),t=r+1,a){var i=this.value[0],o=0;switch(i.valueDec){case 0:break;case 1:o=40;break;case 2:o=80;break;default:return this.value=[],!1}var u=parseInt(n,10);if(isNaN(u))return!0;i.valueDec=u+o,a=!1}else{var s=new K;if(s.valueDec=parseInt(n,10),isNaN(s.valueDec))return!0;0===this.value.length&&(s.isFirstSid=!0,a=!0),this.value.push(s)}while(r!==-1);return!0}},{key:"toString",value:function(){for(var e="",t=!1,r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();0!==r&&(e+="."),t?(n="{"+n+"}",this.value[r].isFirstSid?e="2.{"+n+" - 80}":e+=n):e+=n}return e}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}e.value=this.toString(),e.sidArray=[];for(var r=0;r<this.value.length;r++)e.sidArray.push(this.value[r].toJSON());return e}}],[{key:"blockName",value:function(){return"ObjectIdentifierValueBlock"}}]),t}(w),M=t.ObjectIdentifier=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,q));return r.idBlock.tagClass=1,r.idBlock.tagNumber=6,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"ObjectIdentifier"}}]),t}(k),L=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return a(t,e),h(t,[{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"Utf8StringValueBlock"}}]),t}(g(p)),J=t.Utf8String=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,L));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=12,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push('Error during "decodeURIComponent": '+e+", using raw string")}}},{key:"fromString",value:function(e){var t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);for(var n=new Uint8Array(this.valueBlock.valueHex),a=0;a<r;a++)n[a]=t.charCodeAt(a);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"Utf8String"}}]),t}(k),F=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return a(t,e),h(t,[{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"BmpStringValueBlock"}}]),t}(g(p)),W=t.BmpString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,F));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=30,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=2){var a=r[n];r[n]=r[n+1],r[n+1]=a}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var a=(0,m.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(a);if(!(i.length>2))for(var o=2-i.length,u=i.length-1;u>=0;u--)r[2*n+u+o]=i[u]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"BmpString"}}]),t}(k),G=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return a(t,e),h(t,[{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"UniversalStringValueBlock"}}]),t}(g(p)),z=t.UniversalString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,G));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=28,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=4)r[n]=r[n+3],r[n+1]=r[n+2],r[n+2]=0,r[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var a=(0,m.utilToBase)(e.charCodeAt(n),8),i=new Uint8Array(a);if(!(i.length>4))for(var o=4-i.length,u=i.length-1;u>=0;u--)r[4*n+u+o]=i[u]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"UniversalString"}}]),t}(k),$=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.value="",r.isHexOnly=!0,r}return a(t,e),h(t,[{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"SimpleStringValueBlock"}}]),t}(g(p)),Q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,$));return"value"in e&&r.fromString(e.value),r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"SIMPLESTRING"}}]),t}(k),X=t.NumericString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=18,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"NumericString"}}]),t}(Q),Y=t.PrintableString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=19,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"PrintableString"}}]),t}(Q),Z=t.TeletexString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=20,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"TeletexString"}}]),t}(Q),ee=t.VideotexString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=21,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"VideotexString"}}]),t}(Q),te=t.IA5String=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=22,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"IA5String"}}]),t}(Q),re=t.GraphicString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=25,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"GraphicString"}}]),t}(Q),ne=t.VisibleString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=26,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"VisibleString"}}]),t}(Q),ae=t.GeneralString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=27,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"GeneralString"}}]),t}(Q),ie=t.CharacterString=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=29,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"CharacterString"}}]),t}(Q),oe=t.UTCTime=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.year=0,r.month=0,r.day=0,r.hour=0,r.minute=0,r.second=0,"value"in e){r.fromString(e.value),r.valueBlock.valueHex=new ArrayBuffer(e.value.length);for(var a=new Uint8Array(r.valueBlock.valueHex),o=0;o<e.value.length;o++)a[o]=e.value.charCodeAt(o)}return"valueDate"in e&&(r.fromDate(e.valueDate),r.valueBlock.valueHex=r.toBuffer()),r.idBlock.tagClass=1,r.idBlock.tagNumber=23,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}},{key:"fromString",value:function(e){var t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi,r=t.exec(e);if(null===r)return void(this.error="Wrong input string for convertion");var n=parseInt(r[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(r[2],10),this.day=parseInt(r[3],10),this.hour=parseInt(r[4],10),this.minute=parseInt(r[5],10),this.second=parseInt(r[6],10)}},{key:"toString",value:function(){var e=new Array(7);return e[0]=(0,m.padNumber)(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=(0,m.padNumber)(this.month,2),e[2]=(0,m.padNumber)(this.day,2),e[3]=(0,m.padNumber)(this.hour,2),e[4]=(0,m.padNumber)(this.minute,2),e[5]=(0,m.padNumber)(this.second,2),e[6]="Z",e.join("")}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}],[{key:"blockName",value:function(){return"UTCTime"}}]),t}(ne),ue=t.GeneralizedTime=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.year=0,r.month=0,r.day=0,r.hour=0,r.minute=0,r.second=0,r.millisecond=0,"value"in e){r.fromString(e.value),r.valueBlock.valueHex=new ArrayBuffer(e.value.length);for(var a=new Uint8Array(r.valueBlock.valueHex),o=0;o<e.value.length;o++)a[o]=e.value.charCodeAt(o)}return"valueDate"in e&&(r.fromDate(e.valueDate),r.valueBlock.valueHex=r.toBuffer()),r.idBlock.tagClass=1,r.idBlock.tagNumber=24,r}return a(t,e),h(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===!0?r:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}},{key:"fromString",value:function(e){var t=!1,r="",n="",a=0,i=void 0,o=0,u=0;if("Z"===e[e.length-1])r=e.substr(0,e.length-1),t=!0;else{var s=new Number(e[e.length-1]);if(isNaN(s.valueOf()))throw new Error("Wrong input string for convertion");r=e}if(t){if(r.indexOf("+")!==-1)throw new Error("Wrong input string for convertion");if(r.indexOf("-")!==-1)throw new Error("Wrong input string for convertion")}else{var l=1,c=r.indexOf("+"),f="";if(c===-1&&(c=r.indexOf("-"),l=-1),c!==-1){if(f=r.substr(c+1),r=r.substr(0,c),2!==f.length&&4!==f.length)throw new Error("Wrong input string for convertion");var h=new Number(f.substr(0,2));if(isNaN(h.valueOf()))throw new Error("Wrong input string for convertion");if(o=l*h,4===f.length){if(h=new Number(f.substr(2,2)),isNaN(h.valueOf()))throw new Error("Wrong input string for convertion");u=l*h}}}var m=r.indexOf(".");if(m===-1&&(m=r.indexOf(",")),m!==-1){var d=new Number("0"+r.substr(m));if(isNaN(d.valueOf()))throw new Error("Wrong input string for convertion");a=d.valueOf(),n=r.substr(0,m)}else n=r;switch(!0){case 8===n.length:if(i=/(\d{4})(\d{2})(\d{2})/gi,m!==-1)throw new Error("Wrong input string for convertion");break;case 10===n.length:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,m!==-1){var v=60*a;this.minute=Math.floor(v),v=60*(v-this.minute),this.second=Math.floor(v),v=1e3*(v-this.second),this.millisecond=Math.floor(v)}break;case 12===n.length:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,m!==-1){var p=60*a;this.second=Math.floor(p),p=1e3*(p-this.second),this.millisecond=Math.floor(p)}break;case 14===n.length:if(i=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,m!==-1){var g=1e3*a;this.millisecond=Math.floor(g)}break;default:throw new Error("Wrong input string for convertion")}var y=i.exec(n);if(null===y)throw new Error("Wrong input string for convertion");for(var b=1;b<y.length;b++)switch(b){case 1:this.year=parseInt(y[b],10);break;case 2:this.month=parseInt(y[b],10);break;case 3:this.day=parseInt(y[b],10);break;case 4:this.hour=parseInt(y[b],10)+o;break;case 5:this.minute=parseInt(y[b],10)+u;break;case 6:this.second=parseInt(y[b],10);break;default:throw new Error("Wrong input string for convertion")}if(t===!1){var w=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=w.getUTCFullYear(),this.month=w.getUTCMonth(),this.day=w.getUTCDay(),this.hour=w.getUTCHours(),this.minute=w.getUTCMinutes(),this.second=w.getUTCSeconds(),this.millisecond=w.getUTCMilliseconds()}}},{key:"toString",value:function(){var e=[];return e.push((0,m.padNumber)(this.year,4)),e.push((0,m.padNumber)(this.month,2)),e.push((0,m.padNumber)(this.day,2)),e.push((0,m.padNumber)(this.hour,2)),e.push((0,m.padNumber)(this.minute,2)),e.push((0,m.padNumber)(this.second,2)),0!==this.millisecond&&(e.push("."),e.push((0,m.padNumber)(this.millisecond,3))),e.push("Z"),e.join("")}},{key:"toJSON",value:function(){var e={};try{e=f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}],[{key:"blockName",value:function(){return"GeneralizedTime"}}]),t}(ne),se=t.DATE=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=31,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"DATE"}}]),t}(J),le=t.TimeOfDay=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=32,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"TimeOfDay"}}]),t}(J),ce=t.DateTime=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=33,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"DateTime"}}]),t}(J),fe=t.Duration=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=34,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"Duration"}}]),t}(J),he=t.TIME=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=14,r}return a(t,e),h(t,null,[{key:"blockName",value:function(){return"TIME"}}]),t}(J),me=t.Choice=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.value=(0,m.getParametersValue)(t,"value",[]),this.optional=(0,m.getParametersValue)(t,"optional",!1)},de=t.Any=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.name=(0,m.getParametersValue)(t,"name",""),this.optional=(0,m.getParametersValue)(t,"optional",!1)},ve=t.Repeated=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.name=(0,m.getParametersValue)(t,"name",""),this.optional=(0,m.getParametersValue)(t,"optional",!1),this.value=(0,m.getParametersValue)(t,"value",new de),this.local=(0,m.getParametersValue)(t,"local",!1)};t.RawData=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.data=(0,m.getParametersValue)(t,"data",new ArrayBuffer(0))}return h(e,[{key:"fromBER",value:function(e,t,r){this.data=e.slice(t,r)}},{key:"toBER",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data}}]),e}()},function(e,t){"use strict";function r(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset())}function n(e,t,r){return e instanceof Object==!1?r:t in e?e[t]:r}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength,n="",a=!0,i=!1,o=void 0;try{for(var u,s=new Uint8Array(e,t,r)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value,c=l.toString(16).toUpperCase();n=n+(1===c.length?"0":"")+c}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return n}function i(e,t,r,n){return t instanceof ArrayBuffer==!1?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)}function o(e,t){for(var r=0,n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function u(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=r||-1,a=e,i=0,o=Math.pow(2,t),u=1;u<8;u++){if(e<o){var s=void 0;if(n<0)s=new ArrayBuffer(u),i=u;else{if(n<u)return new ArrayBuffer(0);s=new ArrayBuffer(n),i=n}for(var l=new Uint8Array(s),c=u-1;c>=0;c--){var f=Math.pow(2,c*t);l[i-c-1]=Math.floor(a/f),a-=l[i-c-1]*f}return s}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function s(){for(var e=0,t=0,r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=!0,o=!1,u=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;e+=c.byteLength}}catch(e){o=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw u}}var f=new ArrayBuffer(e),h=new Uint8Array(f),m=!0,d=!1,v=void 0;try{for(var p,g=n[Symbol.iterator]();!(m=(p=g.next()).done);m=!0){var y=p.value;h.set(new Uint8Array(y),t),t+=y.byteLength}}catch(e){d=!0,v=e}finally{try{!m&&g.return&&g.return()}finally{if(d)throw v}}return f}function l(){for(var e=0,t=0,r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=!0,o=!1,u=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;e+=c.length}}catch(e){o=!0,
u=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw u}}var f=new ArrayBuffer(e),h=new Uint8Array(f),m=!0,d=!1,v=void 0;try{for(var p,g=n[Symbol.iterator]();!(m=(p=g.next()).done);m=!0){var y=p.value;h.set(y,t),t+=y.length}}catch(e){d=!0,v=e}finally{try{!m&&g.return&&g.return()}finally{if(d)throw v}}return h}function c(){var e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){var t=255===e[0]&&128&e[1],r=0===e[0]&&0===(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}for(var n=new ArrayBuffer(this.valueHex.byteLength),a=new Uint8Array(n),i=0;i<this.valueHex.byteLength;i++)a[i]=0;a[0]=128&e[0];for(var u=o(a,8),s=new ArrayBuffer(this.valueHex.byteLength),l=new Uint8Array(s),c=0;c<this.valueHex.byteLength;c++)l[c]=e[c];l[0]&=127;var f=o(l,8);return f-u}function f(e){for(var t=e<0?e*-1:e,r=128,n=1;n<8;n++){if(t<=r){if(e<0){var a=r-t,i=u(a,8,n),o=new Uint8Array(i);return o[0]|=128,i}var s=u(t,8,n),l=new Uint8Array(s);if(128&l[0]){var c=s.slice(0),f=new Uint8Array(c);s=new ArrayBuffer(s.byteLength+1),l=new Uint8Array(s);for(var h=0;h<c.byteLength;h++)l[h+1]=f[h];l[0]=0}return s}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function h(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new Uint8Array(e),n=new Uint8Array(t),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}function m(e,t){for(var r=e.toString(10),n=t-r.length,a=new Array(n),i=0;i<n;i++)a[i]="0";var o=a.join("");return o.concat(r)}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=0,i=0,o=0,u="",s=t?k:w;if(n){for(var l=0,c=0;c<e.length;c++)if(0!==e.charCodeAt(c)){l=c;break}e=e.slice(l)}for(;a<e.length;){var f=e.charCodeAt(a++);a>=e.length&&(i=1);var h=e.charCodeAt(a++);a>=e.length&&(o=1);var m=e.charCodeAt(a++),d=f>>2,v=(3&f)<<4|h>>4,p=(15&h)<<2|m>>6,g=63&m;1===i?p=g=64:1===o&&(g=64),u+=r?64===p?""+s.charAt(d)+s.charAt(v):64===g?""+s.charAt(d)+s.charAt(v)+s.charAt(p):""+s.charAt(d)+s.charAt(v)+s.charAt(p)+s.charAt(g):""+s.charAt(d)+s.charAt(v)+s.charAt(p)+s.charAt(g)}return u}function v(e){function t(e){for(var t=0;t<64;t++)if(i.charAt(t)===e)return t;return 64}function r(e){return 64===e?0:e}for(var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n?k:w,o=0,u="";o<e.length;){var s=t(e.charAt(o++)),l=o>=e.length?0:t(e.charAt(o++)),c=o>=e.length?0:t(e.charAt(o++)),f=o>=e.length?0:t(e.charAt(o++)),h=r(s)<<2|r(l)>>4,m=(15&r(l))<<4|r(c)>>2,d=(3&r(c))<<6|r(f);u+=String.fromCharCode(h),64!==c&&(u+=String.fromCharCode(m)),64!==f&&(u+=String.fromCharCode(d))}if(a){for(var v=u.length,p=-1,g=v-1;g>=0;g--)if(0!==u.charCodeAt(g)){p=g;break}p!==-1&&(u=u.slice(0,p+1))}return u}function p(e){var t="",r=new Uint8Array(e),n=!0,a=!1,i=void 0;try{for(var o,u=r[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;t+=String.fromCharCode(s)}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return t}function g(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),a=0;a<t;a++)n[a]=e.charCodeAt(a);return r}function y(e){var t=Math.log(e)/S,r=Math.floor(t),n=Math.round(t);return r===n?r:n}function b(e){if(!C(e)){if(!P(e))throw new Error("Only generator instance of generator function is a valid input");e=e()}return new Promise(function(t,r){var n=function(t){var n=void 0;try{n=e.throw(t)}catch(e){return r(e)}return a(n)},a=function a(i){var o=void 0;try{o=e.next(i)}catch(e){return r(e)}switch(!0){case o.value instanceof Promise:return o.done?t(o.value):o.value.then(a,n);case P(o.value):case C(o.value):return o.done?b(o.value).then(function(e){t(e)},n):b(o.value).then(a,n);case"function"==typeof o.value:o.value=o.value();default:return o.done?t(o.value):a(o.value)}};a()})}Object.defineProperty(t,"__esModule",{value:!0}),t.getUTCDate=r,t.getParametersValue=n,t.bufferToHexCodes=a,t.checkBufferParams=i,t.utilFromBase=o,t.utilToBase=u,t.utilConcatBuf=s,t.utilConcatView=l,t.utilDecodeTC=c,t.utilEncodeTC=f,t.isEqualBuffer=h,t.padNumber=m,t.toBase64=d,t.fromBase64=v,t.arrayBufferToString=p,t.stringToArrayBuffer=g,t.nearestPowerOf2=y,t.generatorsDriver=b;var w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",S=Math.log(2),C=function(e){return"undefined"!=typeof e&&("function"==typeof e.next&&"function"==typeof e.throw)},P=function(e){if("undefined"==typeof e)return!1;var t=e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName||C(e))}},function(e,t,r){!function(){function e(e){this.message=e}var r=t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",r.btoa||(r.btoa=function(t){for(var r,a,i=String(t),o=0,u=n,s="";i.charAt(0|o)||(u="=",o%1);s+=u.charAt(63&r>>8-o%1*8)){if(a=i.charCodeAt(o+=.75),a>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|a}return s}),r.atob||(r.atob=function(t){var r=String(t).replace(/[=]+$/,"");if(r.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,i,o=0,u=0,s="";i=r.charAt(u++);~i&&(a=o%4?64*a+i:i,o++%4)?s+=String.fromCharCode(255&a>>(-2*o&6)):0)i=n.indexOf(i);return s})}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TimeStampResp=t.TimeStampReq=t.Time=t.TSTInfo=t.TBSRequest=t.SubjectDirectoryAttributes=t.SingleResponse=t.SignerInfo=t.SignedData=t.SignedAndUnsignedAttributes=t.Signature=t.SecretBag=t.SafeContents=t.SafeBag=t.RevokedCertificate=t.RevocationInfoChoices=void 0,t.ResponseData=t.ResponseBytes=t.Request=t.RelativeDistinguishedNames=t.RecipientKeyIdentifier=t.RecipientInfo=t.RecipientIdentifier=t.RecipientEncryptedKeys=t.RecipientEncryptedKey=t.RSASSAPSSParams=t.RSAPublicKey=t.RSAPrivateKey=t.RSAESOAEPParams=t.PublicKeyInfo=t.PrivateKeyUsagePeriod=t.PrivateKeyInfo=t.PolicyQualifierInfo=t.PolicyMappings=t.PolicyMapping=t.PolicyInformation=t.PolicyConstraints=t.PasswordRecipientinfo=t.PKIStatusInfo=t.PKCS8ShroudedKeyBag=t.PFX=t.PBKDF2Params=t.PBES2Params=t.OtherRevocationInfoFormat=t.OtherRecipientInfo=t.OtherPrimeInfo=t.OtherKeyAttribute=t.OtherCertificateFormat=t.OriginatorPublicKey=t.OriginatorInfo=t.OriginatorIdentifierOrKey=t.OCSPResponse=t.OCSPRequest=t.NameConstraints=t.MessageImprint=t.MacData=t.KeyTransRecipientInfo=t.KeyBag=t.KeyAgreeRecipientInfo=t.KeyAgreeRecipientIdentifier=t.KEKRecipientInfo=t.KEKIdentifier=t.IssuingDistributionPoint=t.IssuerAndSerialNumber=t.InfoAccess=t.GeneratorsDriver=t.GeneralSubtree=t.GeneralNames=t.GeneralName=t.Extensions=t.Extension=t.ExtKeyUsage=t.EnvelopedData=t.EncryptedData=t.EncryptedContentInfo=t.EncapsulatedContentInfo=t.ECPublicKey=t.ECPrivateKey=t.ECCCMSSharedInfo=t.DistributionPoint=t.DigestInfo=t.CryptoEngine=t.ContentInfo=t.CertificationRequest=t.CertificateSet=t.CertificateRevocationList=t.CertificatePolicies=t.CertificateChainValidationEngine=t.Certificate=t.CertID=t.CertBag=t.CRLDistributionPoints=t.CRLBag=t.BasicOCSPResponse=t.BasicConstraints=t.AuthorityKeyIdentifier=t.AuthenticatedSafe=t.AttributeTypeAndValue=t.Attribute=t.AltName=t.AlgorithmIdentifier=t.Accuracy=t.AccessDescription=t.kdf=t.kdfWithCounter=t.getHashAlgorithm=t.getAlgorithmByOID=t.createECDSASignatureFromCMS=t.stringPrep=t.createCMSECDSASignature=t.getAlgorithmParameters=t.getOIDByAlgorithm=t.getRandomValues=t.getCrypto=t.getEngine=t.setEngine=void 0;var a=r(47),i=r(59),o=n(i),u=r(63),s=n(u),l=r(48),c=n(l),f=r(64),h=n(f),m=r(55),d=n(m),v=r(62),p=n(v),g=r(65),y=n(g),b=r(92),w=n(b),k=r(80),S=n(k),C=r(124),P=n(C),A=r(97),I=n(A),_=r(85),O=n(_),B=r(74),E=n(B),N=r(127),j=n(N),V=r(75),x=n(V),R=r(128),D=n(R),T=r(87),U=n(T),H=r(98),K=n(H),q=r(103),M=n(q),L=r(130),J=n(L),F=r(66),W=n(F),G=r(50),z=n(G),$=r(131),Q=n($),X=r(86),Y=n(X),Z=r(123),ee=n(Z),te=r(56),re=n(te),ne=r(52),ae=n(ne),ie=r(132),oe=n(ie),ue=r(71),se=n(ue),le=r(70),ce=n(le),fe=r(101),he=n(fe),me=r(94),de=n(me),ve=r(77),pe=n(ve),ge=r(96),ye=n(ge),be=r(60),we=n(be),ke=r(82),Se=n(ke),Ce=r(84),Pe=n(Ce),Ae=r(129),Ie=n(Ae),_e=r(95),Oe=n(_e),Be=r(109),Ee=n(Be),Ne=r(81),je=n(Ne),Ve=r(119),xe=n(Ve),Re=r(118),De=n(Re),Te=r(115),Ue=n(Te),He=r(110),Ke=n(He),qe=r(133),Me=n(qe),Le=r(107),Je=n(Le),Fe=r(134),We=n(Fe),Ge=r(135),ze=n(Ge),$e=r(83),Qe=n($e),Xe=r(136),Ye=n(Xe),Ze=r(140),et=n(Ze),tt=r(111),rt=n(tt),nt=r(102),at=n(nt),it=r(112),ot=n(it),ut=r(142),st=n(ut),lt=r(117),ct=n(lt),ft=r(58),ht=n(ft),mt=r(121),dt=n(mt),vt=r(105),pt=n(vt),gt=r(73),yt=n(gt),bt=r(72),wt=n(bt),kt=r(143),St=n(kt),Ct=r(69),Pt=n(Ct),At=r(148),It=n(At),_t=r(120),Ot=n(_t),Bt=r(93),Et=n(Bt),Nt=r(88),jt=n(Nt),Vt=r(91),xt=n(Vt),Rt=r(90),Dt=n(Rt),Tt=r(89),Ut=n(Tt),Ht=r(54),Kt=n(Ht),qt=r(79),Mt=n(qt),Lt=r(51),Jt=n(Lt),Ft=r(122),Wt=n(Ft),Gt=r(57),zt=n(Gt),$t=r(53),Qt=n($t),Xt=r(49),Yt=n(Xt),Zt=r(114),er=n(Zt),tr=r(113),rr=n(tr),nr=r(108),ar=n(nr),ir=r(106),or=n(ir),ur=r(116),sr=n(ur),lr=r(61),cr=n(lr),fr=r(138),hr=n(fr),mr=r(141),dr=n(mr),vr=r(125),pr=n(vr),gr=r(104),yr=n(gr),br=r(99),wr=n(br),kr=r(68),Sr=n(kr),Cr=r(67),Pr=n(Cr),Ar=r(100),Ir=n(Ar),_r=r(139),Or=n(_r),Br=r(146),Er=n(Br),Nr=r(144),jr=n(Nr),Vr=r(145),xr=n(Vr),Rr=r(126),Dr=n(Rr),Tr=r(78),Ur=n(Tr),Hr=r(137),Kr=n(Hr),qr=r(147),Mr=n(qr),Lr=r(76),Jr=n(Lr),Fr=r(149),Wr=n(Fr),Gr=r(150),zr=n(Gr);t.setEngine=a.setEngine,t.getEngine=a.getEngine,t.getCrypto=a.getCrypto,t.getRandomValues=a.getRandomValues,t.getOIDByAlgorithm=a.getOIDByAlgorithm,t.getAlgorithmParameters=a.getAlgorithmParameters,t.createCMSECDSASignature=a.createCMSECDSASignature,t.stringPrep=a.stringPrep,t.createECDSASignatureFromCMS=a.createECDSASignatureFromCMS,t.getAlgorithmByOID=a.getAlgorithmByOID,t.getHashAlgorithm=a.getHashAlgorithm,t.kdfWithCounter=a.kdfWithCounter,t.kdf=a.kdf,t.AccessDescription=o.default,t.Accuracy=s.default,t.AlgorithmIdentifier=c.default,t.AltName=h.default,t.Attribute=d.default,t.AttributeTypeAndValue=p.default,t.AuthenticatedSafe=y.default,t.AuthorityKeyIdentifier=w.default,t.BasicConstraints=S.default,t.BasicOCSPResponse=P.default,t.CRLBag=I.default,t.CRLDistributionPoints=O.default,t.CertBag=E.default,t.CertID=j.default,t.Certificate=x.default,t.CertificateChainValidationEngine=D.default,t.CertificatePolicies=U.default,t.CertificateRevocationList=K.default,t.CertificateSet=M.default,t.CertificationRequest=J.default,t.ContentInfo=W.default,t.CryptoEngine=z.default,t.DigestInfo=Q.default,t.DistributionPoint=Y.default,t.ECCCMSSharedInfo=ee.default,t.ECPrivateKey=re.default,t.ECPublicKey=ae.default,t.EncapsulatedContentInfo=oe.default,t.EncryptedContentInfo=se.default,t.EncryptedData=ce.default,t.EnvelopedData=he.default,t.ExtKeyUsage=de.default,t.Extension=pe.default,t.Extensions=ye.default,t.GeneralName=we.default,t.GeneralNames=Se.default,t.GeneralSubtree=Pe.default,t.GeneratorsDriver=Ie.default,t.InfoAccess=Oe.default,t.IssuerAndSerialNumber=Ee.default,t.IssuingDistributionPoint=je.default,t.KEKIdentifier=xe.default,t.KEKRecipientInfo=De.default,t.KeyAgreeRecipientIdentifier=Ue.default,t.KeyAgreeRecipientInfo=Ke.default,t.KeyBag=Me.default,t.KeyTransRecipientInfo=Je.default,t.MacData=We.default,t.MessageImprint=ze.default,t.NameConstraints=Qe.default,t.OCSPRequest=Ye.default,t.OCSPResponse=et.default,t.OriginatorIdentifierOrKey=rt.default,t.OriginatorInfo=at.default,t.OriginatorPublicKey=ot.default,t.OtherCertificateFormat=st.default,t.OtherKeyAttribute=ct.default,t.OtherPrimeInfo=ht.default,t.OtherRecipientInfo=dt.default,t.OtherRevocationInfoFormat=pt.default,t.PBES2Params=yt.default,t.PBKDF2Params=wt.default,t.PFX=St.default,t.PKCS8ShroudedKeyBag=Pt.default,t.PKIStatusInfo=It.default,t.PasswordRecipientinfo=Ot.default,t.PolicyConstraints=Et.default,t.PolicyInformation=jt.default,t.PolicyMapping=xt.default,t.PolicyMappings=Dt.default,t.PolicyQualifierInfo=Ut.default,t.PrivateKeyInfo=Kt.default,t.PrivateKeyUsagePeriod=Mt.default,t.PublicKeyInfo=Jt.default,t.RSAESOAEPParams=Wt.default,t.RSAPrivateKey=zt.default,t.RSAPublicKey=Qt.default,t.RSASSAPSSParams=Yt.default,t.RecipientEncryptedKey=er.default,t.RecipientEncryptedKeys=rr.default,t.RecipientIdentifier=ar.default,t.RecipientInfo=or.default,t.RecipientKeyIdentifier=sr.default,t.RelativeDistinguishedNames=cr.default,t.Request=hr.default,t.ResponseBytes=dr.default,t.ResponseData=pr.default,t.RevocationInfoChoices=yr.default,t.RevokedCertificate=wr.default,t.SafeBag=Sr.default,t.SafeContents=Pr.default,t.SecretBag=Ir.default,t.Signature=Or.default,t.SignedAndUnsignedAttributes=Er.default,t.SignedData=jr.default,t.SignerInfo=xr.default,t.SingleResponse=Dr.default,t.SubjectDirectoryAttributes=Ur.default,t.TBSRequest=Kr.default,t.TSTInfo=Mr.default,t.Time=Jr.default,t.TimeStampReq=Wr.default,t.TimeStampResp=zr.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t,r){I={name:e,crypto:t,subtle:r}}function o(){return I}function u(){if(null!==I.subtle)return I.subtle}function s(e){if(null!==I.crypto)return I.crypto.getRandomValues(e);throw new Error("No support for Web Cryptography API")}function l(e){var t="";switch(e.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.1.1.5";break;case"SHA-256":t="1.2.840.113549.1.1.11";break;case"SHA-384":t="1.2.840.113549.1.1.12";break;case"SHA-512":t="1.2.840.113549.1.1.13"}break;case"RSA-PSS":t="1.2.840.113549.1.1.10";break;case"RSA-OAEP":t="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.10045.4.1";break;case"SHA-256":t="1.2.840.10045.4.3.2";break;case"SHA-384":t="1.2.840.10045.4.3.3";break;case"SHA-512":t="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":t="1.3.133.16.840.63.0.2";break;case"SHA-256":t="1.3.132.1.11.1";break;case"SHA-384":t="1.3.132.1.11.2";break;case"SHA-512":t="1.3.132.1.11.3"}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.2";break;case 192:t="2.16.840.1.101.3.4.1.22";break;case 256:t="2.16.840.1.101.3.4.1.42"}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.6";break;case 192:t="2.16.840.1.101.3.4.1.26";break;case 256:t="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.4";break;case 192:t="2.16.840.1.101.3.4.1.24";break;case 256:t="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.5";break;case 192:t="2.16.840.1.101.3.4.1.25";break;case 256:t="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.2.7";break;case"SHA-256":t="1.2.840.113549.2.9";break;case"SHA-384":t="1.2.840.113549.2.10";break;case"SHA-512":t="1.2.840.113549.2.11"}break;case"DH":t="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":t="1.3.14.3.2.26";break;case"SHA-256":t="2.16.840.1.101.3.4.2.1";break;case"SHA-384":t="2.16.840.1.101.3.4.2.2";break;case"SHA-512":t="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":t="1.2.840.113549.1.5.12";break;case"P-256":t="1.2.840.10045.3.1.7";break;case"P-384":t="1.3.132.0.34";break;case"P-521":t="1.3.132.0.35"}return t}function c(e,t){var r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:s(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:s(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e3},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return r}function f(e){if(e.byteLength%2!==0)return new ArrayBuffer(0);var t=e.byteLength/2,r=new ArrayBuffer(t),n=new Uint8Array(r);n.set(new Uint8Array(e,0,t));var a=new b.Integer({valueHex:r}),i=new ArrayBuffer(t),o=new Uint8Array(i);o.set(new Uint8Array(e,t,t));var u=new b.Integer({valueHex:i});return new b.Sequence({value:[a.convertToDER(),u.convertToDER()]}).toBER(!1)}function h(e){var t=e.replace(/^\s+|\s+$/g,"");return t=t.replace(/\s+/g," "),t=t.toLowerCase()}function m(e){if(e instanceof b.Sequence==!1)return new ArrayBuffer(0);if(2!==e.valueBlock.value.length)return new ArrayBuffer(0);if(e.valueBlock.value[0]instanceof b.Integer==!1)return new ArrayBuffer(0);if(e.valueBlock.value[1]instanceof b.Integer==!1)return new ArrayBuffer(0);var t=e.valueBlock.value[0].convertFromDER(),r=e.valueBlock.value[1].convertFromDER();return(0,w.utilConcatBuf)(t.valueBlock.valueHex,r.valueBlock.valueHex)}function d(e){switch(e){case"1.2.840.113549.1.1.1":case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}function v(e){var t="";switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{var r=new C.default({schema:e.algorithmParams});if("hashAlgorithm"in r){var n=d(r.hashAlgorithm.algorithmId);if("name"in n==!1)return"";t=n.name}else t="SHA-1"}catch(e){}}return t}function p(e,t,r,n){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:return Promise.reject("Unknown hash function: "+e)}if(t instanceof ArrayBuffer==!1)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(0===t.byteLength)return Promise.reject('"Zbuffer" has zero length, error');if(n instanceof ArrayBuffer==!1)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');if(r>255)return Promise.reject('Please set "Counter" variable to value less or equal to 255');var a=new ArrayBuffer(4),i=new Uint8Array(a);i[0]=0,i[1]=0,i[2]=0,i[3]=r;var o=new ArrayBuffer(0),s=u();return"undefined"==typeof s?Promise.reject("Unable to create WebCrypto object"):(o=(0,w.utilConcatBuf)(o,t),o=(0,w.utilConcatBuf)(o,a),o=(0,w.utilConcatBuf)(o,n),s.digest({name:e},o).then(function(e){return{counter:r,result:e}}))}function g(e,t,r,n){var a=0,i=1,o=[];switch(e.toUpperCase()){case"SHA-1":a=160;break;case"SHA-256":a=256;break;case"SHA-384":a=384;break;case"SHA-512":a=512;break;default:return Promise.reject("Unknown hash function: "+e)}if(t instanceof ArrayBuffer==!1)return Promise.reject('Please set "Zbuffer" as "ArrayBuffer"');if(0===t.byteLength)return Promise.reject('"Zbuffer" has zero length, error');if(n instanceof ArrayBuffer==!1)return Promise.reject('Please set "SharedInfo" as "ArrayBuffer"');var u=r/a;Math.floor(u)>0&&(i=Math.floor(u),u-i>0&&i++);for(var s=1;s<=i;s++)o.push(p(e,t,s,n));return Promise.all(o).then(function(e){for(var t=new ArrayBuffer(0),n=1,a=!0;a;){a=!1;var i=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;if(c.counter===n){t=(0,w.utilConcatBuf)(t,c.result),a=!0;break}}}catch(e){o=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw u}}n++}if(r>>=3,t.byteLength>r){for(var f=new ArrayBuffer(r),h=new Uint8Array(f),m=new Uint8Array(t),d=0;d<r;d++)h[d]=m[d];return f}return t})}Object.defineProperty(t,"__esModule",{value:!0}),t.setEngine=i,t.getEngine=o,t.getCrypto=u,t.getRandomValues=s,t.getOIDByAlgorithm=l,t.getAlgorithmParameters=c,t.createCMSECDSASignature=f,t.stringPrep=h,t.createECDSASignatureFromCMS=m,t.getAlgorithmByOID=d,t.getHashAlgorithm=v,t.kdfWithCounter=p,t.kdf=g;var y=r(43),b=a(y),w=r(44),k=r(48),S=(n(k),r(49)),C=n(S),P=r(50),A=n(P),I={name:"none",crypto:null,subtle:null};!function(){if("undefined"!=typeof self&&"crypto"in self){var e="webcrypto",t=self.crypto,r=null;if("webkitSubtle"in self.crypto){try{r=self.crypto.webkitSubtle}catch(e){r=self.crypto.subtle}e="safari"}"subtle"in self.crypto&&(r=self.crypto.subtle),I={name:e,crypto:t,subtle:new A.default({name:e,crypto:r})}}}()},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.algorithmId=(0,s.getParametersValue)(t,"algorithmId",e.defaultValues("algorithmId")),"algorithmParams"in t&&(this.algorithmParams=(0,s.getParametersValue)(t,"algorithmParams",e.defaultValues("algorithmParams"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=r.result.algorithm.valueBlock.toString(),"params"in r.result&&(this.algorithmParams=r.result.params)}},{key:"toSchema",value:function(){var e=[];return e.push(new u.ObjectIdentifier({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof u.Any==!1&&e.push(this.algorithmParams),new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof u.Any==!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}},{key:"isEqual",value:function(t){return t instanceof e!=!1&&(this.algorithmId===t.algorithmId&&("algorithmParams"in this?"algorithmParams"in t&&JSON.stringify(this.algorithmParams)===JSON.stringify(t.algorithmParams):!("algorithmParams"in t)))}}],[{key:"defaultValues",value:function(e){switch(e){case"algorithmId":return"";case"algorithmParams":return new u.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof u.Any;default:throw new Error("Invalid member name for AlgorithmIdentifier class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",optional:t.optional||!1,value:[new u.ObjectIdentifier({name:t.algorithmIdentifier||""}),new u.Any({name:t.algorithmParams||"",optional:!0})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.hashAlgorithm=(0,l.getParametersValue)(t,"hashAlgorithm",e.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=(0,l.getParametersValue)(t,"maskGenAlgorithm",e.defaultValues("maskGenAlgorithm")),this.saltLength=(0,l.getParametersValue)(t,"saltLength",e.defaultValues("saltLength")),this.trailerField=(0,l.getParametersValue)(t,"trailerField",e.defaultValues("trailerField")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RSASSA_PSS_params");"hashAlgorithm"in r.result&&(this.hashAlgorithm=new f.default({schema:r.result.hashAlgorithm})),"maskGenAlgorithm"in r.result&&(this.maskGenAlgorithm=new f.default({schema:r.result.maskGenAlgorithm})),"saltLength"in r.result&&(this.saltLength=r.result.saltLength.valueBlock.valueDec),"trailerField"in r.result&&(this.trailerField=r.result.trailerField.valueBlock.valueDec)}},{key:"toSchema",value:function(){var t=[];return this.hashAlgorithm.isEqual(e.defaultValues("hashAlgorithm"))||t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(e.defaultValues("maskGenAlgorithm"))||t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==e.defaultValues("saltLength")&&t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new s.Integer({value:this.saltLength})]})),this.trailerField!==e.defaultValues("trailerField")&&t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:3},value:[new s.Integer({value:this.trailerField})]})),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={};return this.hashAlgorithm.isEqual(e.defaultValues("hashAlgorithm"))||(t.hashAlgorithm=this.hashAlgorithm.toJSON()),
this.maskGenAlgorithm.isEqual(e.defaultValues("maskGenAlgorithm"))||(t.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==e.defaultValues("saltLength")&&(t.saltLength=this.saltLength),this.trailerField!==e.defaultValues("trailerField")&&(t.trailerField=this.trailerField),t}}],[{key:"defaultValues",value:function(e){switch(e){case"hashAlgorithm":return new f.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null});case"maskGenAlgorithm":return new f.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new f.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error("Invalid member name for RSASSAPSSParams class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[f.default.schema(t.hashAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[f.default.schema(t.maskGenAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new s.Integer({name:t.saltLength||""})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new s.Integer({name:t.trailerField||""})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(51),f=n(c),h=r(54),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.crypto=(0,l.getParametersValue)(t,"crypto",{}),this.name=(0,l.getParametersValue)(t,"name","")}return o(e,[{key:"importKey",value:function(e,t,r,n,a){var i=this,o={};switch(t instanceof Uint8Array&&(t=t.buffer),e.toLowerCase()){case"raw":return this.crypto.importKey("raw",t,r,n,a);case"spki":var u=s.fromBER(t);if(u.offset===-1)return Promise.reject("Incorrect keyData");var c=new f.default;try{c.fromSchema(u.result)}catch(e){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+r.hash.name.toUpperCase())}case"RSASSA-PKCS1-V1_5":if(a=["verify"],o.kty="RSA",o.ext=n,o.key_ops=a,"1.2.840.113549.1.1.1"!==c.algorithm.algorithmId)return Promise.reject("Incorrect public key algorithm: "+c.algorithm.algorithmId);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject("Incorrect public key algorithm: "+c.algorithm.algorithmId)}var h=c.toJSON(),d=!0,v=!1,p=void 0;try{for(var g,y=Object.keys(h)[Symbol.iterator]();!(d=(g=y.next()).done);d=!0){var b=g.value;o[b]=h[b]}}catch(e){v=!0,p=e}finally{try{!d&&y.return&&y.return()}finally{if(v)throw p}}break;case"ECDSA":a=["verify"];case"ECDH":if(o={kty:"EC",ext:n,key_ops:a},"1.2.840.10045.2.1"!==c.algorithm.algorithmId)return Promise.reject("Incorrect public key algorithm: "+c.algorithm.algorithmId);var w=c.toJSON(),k=!0,S=!1,C=void 0;try{for(var P,A=Object.keys(w)[Symbol.iterator]();!(k=(P=A.next()).done);k=!0){var I=P.value;o[I]=w[I]}}catch(e){S=!0,C=e}finally{try{!k&&A.return&&A.return()}finally{if(S)throw C}}break;case"RSA-OAEP":if(o.kty="RSA",o.ext=n,o.key_ops=a,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP-1";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect public key algorithm: "+c.algorithm.algorithmId)}var _=c.toJSON(),O=!0,B=!1,E=void 0;try{for(var N,j=Object.keys(_)[Symbol.iterator]();!(O=(N=j.next()).done);O=!0){var V=N.value;o[V]=_[V]}}catch(e){B=!0,E=e}finally{try{!O&&j.return&&j.return()}finally{if(B)throw E}}break;default:return Promise.reject("Incorrect algorithm name: "+r.name.toUpperCase())}break;case"pkcs8":var x=new m.default,R=s.fromBER(t);if(R.offset===-1)return Promise.reject("Incorrect keyData");try{x.fromSchema(R.result)}catch(e){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="PS1";break;case"SHA-256":o.alg="PS256";break;case"SHA-384":o.alg="PS384";break;case"SHA-512":o.alg="PS512";break;default:return Promise.reject("Incorrect hash algorithm: "+r.hash.name.toUpperCase())}case"RSASSA-PKCS1-V1_5":if(a=["sign"],o.kty="RSA",o.ext=n,o.key_ops=a,"1.2.840.113549.1.1.1"!==x.privateKeyAlgorithm.algorithmId)return Promise.reject("Incorrect private key algorithm: "+x.privateKeyAlgorithm.algorithmId);if("alg"in o==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RS1";break;case"SHA-256":o.alg="RS256";break;case"SHA-384":o.alg="RS384";break;case"SHA-512":o.alg="RS512";break;default:return Promise.reject("Incorrect hash algorithm: "+r.hash.name.toUpperCase())}var D=x.toJSON(),T=!0,U=!1,H=void 0;try{for(var K,q=Object.keys(D)[Symbol.iterator]();!(T=(K=q.next()).done);T=!0){var M=K.value;o[M]=D[M]}}catch(e){U=!0,H=e}finally{try{!T&&q.return&&q.return()}finally{if(U)throw H}}break;case"ECDSA":a=["sign"];case"ECDH":if(o={kty:"EC",ext:n,key_ops:a},"1.2.840.10045.2.1"!==x.privateKeyAlgorithm.algorithmId)return Promise.reject("Incorrect algorithm: "+x.privateKeyAlgorithm.algorithmId);var L=x.toJSON(),J=!0,F=!1,W=void 0;try{for(var G,z=Object.keys(L)[Symbol.iterator]();!(J=(G=z.next()).done);J=!0){var $=G.value;o[$]=L[$]}}catch(e){F=!0,W=e}finally{try{!J&&z.return&&z.return()}finally{if(F)throw W}}break;case"RSA-OAEP":if(o.kty="RSA",o.ext=n,o.key_ops=a,"safari"===this.name.toLowerCase())o.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":o.alg="RSA-OAEP-1";break;case"SHA-256":o.alg="RSA-OAEP-256";break;case"SHA-384":o.alg="RSA-OAEP-384";break;case"SHA-512":o.alg="RSA-OAEP-512";break;default:return Promise.reject("Incorrect hash algorithm: "+r.hash.name.toUpperCase())}var Q=x.toJSON(),X=!0,Y=!1,Z=void 0;try{for(var ee,te=Object.keys(Q)[Symbol.iterator]();!(X=(ee=te.next()).done);X=!0){var re=ee.value;o[re]=Q[re]}}catch(e){Y=!0,Z=e}finally{try{!X&&te.return&&te.return()}finally{if(Y)throw Z}}break;default:return Promise.reject("Incorrect algorithm name: "+r.name.toUpperCase())}break;case"jwk":o=t;break;default:return Promise.reject("Incorrect format: "+e)}return"safari"===this.name.toLowerCase()?Promise.resolve().then(function(){return i.crypto.importKey("jwk",(0,l.stringToArrayBuffer)(JSON.stringify(o)),r,n,a)}).then(function(e){return e},function(e){return i.crypto.importKey("jwk",o,r,n,a)}):this.crypto.importKey("jwk",o,r,n,a)}},{key:"exportKey",value:function(e,t){var r=this.crypto.exportKey("jwk",t);switch("safari"===this.name.toLowerCase()&&(r=r.then(function(e){return e instanceof ArrayBuffer?JSON.parse((0,l.arrayBufferToString)(e)):e})),e.toLowerCase()){case"raw":return this.crypto.exportKey("raw",t);case"spki":r=r.then(function(e){var t=new f.default;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)});break;case"pkcs8":r=r.then(function(e){var t=new m.default;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)});break;case"jwk":break;default:return Promise.reject("Incorrect format: "+e)}return r}},{key:"convert",value:function(e,t,r,n,a,i){var o=this;switch(e.toLowerCase()){case"raw":switch(t.toLowerCase()){case"raw":return Promise.resolve(r);case"spki":return Promise.resolve().then(function(){return o.importKey("raw",r,n,a,i)}).then(function(e){return o.exportKey("spki",e)});case"pkcs8":return Promise.resolve().then(function(){return o.importKey("raw",r,n,a,i)}).then(function(e){return o.exportKey("pkcs8",e)});case"jwk":return Promise.resolve().then(function(){return o.importKey("raw",r,n,a,i)}).then(function(e){return o.exportKey("jwk",e)});default:return Promise.reject("Incorrect outputFormat: "+t)}case"spki":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(function(){return o.importKey("spki",r,n,a,i)}).then(function(e){return o.exportKey("raw",e)});case"spki":return Promise.resolve(r);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then(function(){return o.importKey("spki",r,n,a,i)}).then(function(e){return o.exportKey("jwk",e)});default:return Promise.reject("Incorrect outputFormat: "+t)}case"pkcs8":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(function(){return o.importKey("pkcs8",r,n,a,i)}).then(function(e){return o.exportKey("raw",e)});case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(r);case"jwk":return Promise.resolve().then(function(){return o.importKey("pkcs8",r,n,a,i)}).then(function(e){return o.exportKey("jwk",e)});default:return Promise.reject("Incorrect outputFormat: "+t)}case"jwk":switch(t.toLowerCase()){case"raw":return Promise.resolve().then(function(){return o.importKey("jwk",r,n,a,i)}).then(function(e){return o.exportKey("raw",e)});case"spki":return Promise.resolve().then(function(){return o.importKey("jwk",r,n,a,i)}).then(function(e){return o.exportKey("spki",e)});case"pkcs8":return Promise.resolve().then(function(){return o.importKey("jwk",r,n,a,i)}).then(function(e){return o.exportKey("pkcs8",e)});case"jwk":return Promise.resolve(r);default:return Promise.reject("Incorrect outputFormat: "+t)}default:return Promise.reject("Incorrect inputFormat: "+e)}}},{key:"encrypt",value:function(){var e;return(e=this.crypto).encrypt.apply(e,arguments)}},{key:"decrypt",value:function(){var e;return(e=this.crypto).decrypt.apply(e,arguments)}},{key:"sign",value:function(){var e;return(e=this.crypto).sign.apply(e,arguments)}},{key:"verify",value:function(){var e;return(e=this.crypto).verify.apply(e,arguments)}},{key:"digest",value:function(){var e;return(e=this.crypto).digest.apply(e,arguments)}},{key:"generateKey",value:function(){var e;return(e=this.crypto).generateKey.apply(e,arguments)}},{key:"deriveKey",value:function(){var e;return(e=this.crypto).deriveKey.apply(e,arguments)}},{key:"deriveBits",value:function(){var e;return(e=this.crypto).deriveBits.apply(e,arguments)}},{key:"wrapKey",value:function(){var e;return(e=this.crypto).wrapKey.apply(e,arguments)}},{key:"unwrapKey",value:function(){var e;return(e=this.crypto).unwrapKey.apply(e,arguments)}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(48),h=n(f),m=r(52),d=n(m),v=r(53),p=n(v),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.algorithm=(0,l.getParametersValue)(t,"algorithm",e.defaultValues("algorithm")),this.subjectPublicKey=(0,l.getParametersValue)(t,"subjectPublicKey",e.defaultValues("subjectPublicKey")),"parsedKey"in t&&(this.parsedKey=(0,l.getParametersValue)(t,"parsedKey",e.defaultValues("parsedKey"))),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PUBLIC_KEY_INFO");switch(this.algorithm=new h.default({schema:r.result.algorithm}),this.subjectPublicKey=r.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":"algorithmParams"in this.algorithm&&this.algorithm.algorithmParams instanceof s.ObjectIdentifier&&(this.parsedKey=new d.default({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex}));break;case"1.2.840.113549.1.1.1":var n=s.fromBER(this.subjectPublicKey.valueBlock.valueHex);n.offset!==-1&&(this.parsedKey=new p.default({schema:n.result}))}}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}},{key:"toJSON",value:function(){if("parsedKey"in this==!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};var e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}var t=this.parsedKey.toJSON(),r=!0,n=!1,a=void 0;try{for(var i,o=Object.keys(t)[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;e[u]=t[u]}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return e}},{key:"fromJSON",value:function(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new d.default({json:e}),this.algorithm=new h.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new s.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new p.default({json:e}),this.algorithm=new h.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new s.Null});break;default:throw new Error('Invalid value for "kty" parameter: '+e.kty)}this.subjectPublicKey=new s.BitString({valueHex:this.parsedKey.toSchema().toBER(!1)})}}},{key:"importKey",value:function(e){var t=Promise.resolve(),r=this;if("undefined"==typeof e)return Promise.reject("Need to provide publicKey input parameter");var n=(0,c.getCrypto)();return"undefined"==typeof n?Promise.reject("Unable to create WebCrypto object"):(t=t.then(function(){return n.exportKey("spki",e)}),t=t.then(function(e){var t=s.fromBER(e);try{r.fromSchema(t.result)}catch(e){return Promise.reject("Error during initializing object from schema")}},function(e){return Promise.reject("Error during exporting public key: "+e)}))}}],[{key:"defaultValues",value:function(e){switch(e){case"algorithm":return new h.default;case"subjectPublicKey":return new s.BitString;default:throw new Error("Invalid member name for PublicKeyInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[h.default.schema(t.algorithm||{}),new s.BitString({name:t.subjectPublicKey||""})]})}}]),e}();t.default=g},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.x=(0,s.getParametersValue)(t,"x",e.defaultValues("x")),this.y=(0,s.getParametersValue)(t,"y",e.defaultValues("y")),this.namedCurve=(0,s.getParametersValue)(t,"namedCurve",e.defaultValues("namedCurve")),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return i(e,[{key:"fromSchema",value:function(e){if(e instanceof ArrayBuffer==!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");var t=new Uint8Array(e);if(4!==t[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");var r=void 0;switch(this.namedCurve){case"1.2.840.10045.3.1.7":r=32;break;case"1.3.132.0.34":r=48;break;case"1.3.132.0.35":r=66;break;default:throw new Error("Incorrect curve OID: "+this.namedCurve)}if(e.byteLength!==2*r+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=e.slice(1,r+1),this.y=e.slice(1+r,2*r+1)}},{key:"toSchema",value:function(){return new u.RawData({data:(0,s.utilConcatBuf)(new Uint8Array([4]).buffer,this.x,this.y)})}},{key:"toJSON",value:function(){var e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}return{crv:e,x:(0,s.toBase64)((0,s.arrayBufferToString)(this.x),!0,!0,!0),y:(0,s.toBase64)((0,s.arrayBufferToString)(this.y),!0,!0,!0)}}},{key:"fromJSON",value:function(e){var t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("x"in e))throw new Error('Absent mandatory parameter "x"');if(this.x=(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.x,!0)).slice(0,t),!("y"in e))throw new Error('Absent mandatory parameter "y"');this.y=(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.y,!0)).slice(0,t)}}],[{key:"defaultValues",value:function(e){switch(e){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error("Invalid member name for ECCPublicKey class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"x":case"y":return(0,s.isEqualBuffer)(r,e.defaultValues(t));case"namedCurve":return""===r;default:throw new Error("Invalid member name for ECCPublicKey class: "+t)}}},{key:"schema",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new u.RawData}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.modulus=(0,s.getParametersValue)(t,"modulus",e.defaultValues("modulus")),this.publicExponent=(0,s.getParametersValue)(t,"publicExponent",e.defaultValues("publicExponent")),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=r.result.modulus.convertFromDER(256),this.publicExponent=r.result.publicExponent}},{key:"toSchema",value:function(){return new u.Sequence({value:[this.modulus.convertToDER(),this.publicExponent]})}},{key:"toJSON",value:function(){return{n:(0,s.toBase64)((0,s.arrayBufferToString)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,s.toBase64)((0,s.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),!0,!0,!0)}}},{key:"fromJSON",value:function(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new u.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.n,!0)).slice(0,256)}),!("e"in e))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new u.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.e,!0)).slice(0,3)})}}],[{key:"defaultValues",value:function(e){switch(e){case"modulus":return new u.Integer;case"publicExponent":return new u.Integer;default:throw new Error("Invalid member name for RSAPublicKey class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Integer({name:t.modulus||""}),new u.Integer({name:t.publicExponent||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=r(55),m=n(h),d=r(56),v=n(d),p=r(57),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.privateKeyAlgorithm=(0,l.getParametersValue)(t,"privateKeyAlgorithm",e.defaultValues("privateKeyAlgorithm")),this.privateKey=(0,l.getParametersValue)(t,"privateKey",e.defaultValues("privateKey")),"attributes"in t&&(this.attributes=(0,l.getParametersValue)(t,"attributes",e.defaultValues("attributes"))),"parsedKey"in t&&(this.parsedKey=(0,l.getParametersValue)(t,"parsedKey",e.defaultValues("parsedKey"))),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS8");switch(this.version=r.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new f.default({schema:r.result.privateKeyAlgorithm}),this.privateKey=r.result.privateKey,"attributes"in r.result&&(this.attributes=Array.from(r.result.attributes,function(e){return new m.default({schema:e})})),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":var n=s.fromBER(this.privateKey.valueBlock.valueHex);n.offset!==-1&&(this.parsedKey=new g.default({schema:n.result}));break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof s.ObjectIdentifier){var a=s.fromBER(this.privateKey.valueBlock.valueHex);a.offset!==-1&&(this.parsedKey=new v.default({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:a.result}))}}}},{key:"toSchema",value:function(){var e=[new s.Integer({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){if("parsedKey"in this==!1){var e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,function(e){return e.toJSON()})),e}var t={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":t.kty="EC";break;case"1.2.840.113549.1.1.1":t.kty="RSA"}var r=this.parsedKey.toJSON(),n=!0,a=!1,i=void 0;try{for(var o,u=Object.keys(r)[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;t[s]=r[s]}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return t}},{key:"fromJSON",value:function(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new v.default({json:e}),this.privateKeyAlgorithm=new f.default({algorithmId:"1.2.840.10045.2.1",algorithmParams:new s.ObjectIdentifier({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new g.default({json:e}),this.privateKeyAlgorithm=new f.default({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new s.Null});break;default:throw new Error('Invalid value for "kty" parameter: '+e.kty)}this.privateKey=new s.OctetString({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"privateKeyAlgorithm":return new f.default;case"privateKey":return new s.OctetString;case"attributes":return[];default:throw new Error("Invalid member name for PrivateKeyInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),f.default.schema(t.privateKeyAlgorithm||{}),new s.OctetString({name:t.privateKey||""}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.attributes||"",value:m.default.schema()})]})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.type=(0,s.getParametersValue)(t,"type",e.defaultValues("type")),this.values=(0,s.getParametersValue)(t,"values",e.defaultValues("values")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{type:"type",values:"values"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ATTRIBUTE");this.type=r.result.type.valueBlock.toString(),this.values=r.result.values}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.type}),new u.Set({value:this.values})]})}},{key:"toJSON",value:function(){return{type:this.type,values:Array.from(this.values,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"type":return"";case"values":return[];default:throw new Error("Invalid member name for Attribute class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"type":return""===t;case"values":return 0===t.length;default:throw new Error("Invalid member name for Attribute class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.type||""}),new u.Set({name:t.setName||"",value:[new u.Repeated({name:t.values||"",value:new u.Any})]})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(52),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.privateKey=(0,l.getParametersValue)(t,"privateKey",e.defaultValues("privateKey")),"namedCurve"in t&&(this.namedCurve=(0,l.getParametersValue)(t,"namedCurve",e.defaultValues("namedCurve"))),"publicKey"in t&&(this.publicKey=(0,l.getParametersValue)(t,"publicKey",e.defaultValues("publicKey"))),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=r.result.version.valueBlock.valueDec,this.privateKey=r.result.privateKey,"namedCurve"in r.result&&(this.namedCurve=r.result.namedCurve.valueBlock.toString()),"publicKey"in r.result){var n={schema:r.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(n.namedCurve=this.namedCurve),this.publicKey=new f.default(n)}}},{key:"toSchema",value:function(){var e=[new s.Integer({value:this.version}),this.privateKey];return"namedCurve"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.ObjectIdentifier({value:this.namedCurve})]})),"publicKey"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new s.BitString({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){if("namedCurve"in this==!1||e.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');var t="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":t="P-256";break;case"1.3.132.0.34":t="P-384";break;case"1.3.132.0.35":t="P-521"}var r={crv:t,d:(0,l.toBase64)((0,l.arrayBufferToString)(this.privateKey.valueBlock.valueHex),!0,!0,!0)};if("publicKey"in this){var n=this.publicKey.toJSON();r.x=n.x,r.y=n.y}return r}},{key:"fromJSON",value:function(e){var t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("d"in e))throw new Error('Absent mandatory parameter "d"');this.privateKey=new s.OctetString({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.d,!0)).slice(0,t)}),"x"in e&&"y"in e&&(this.publicKey=new f.default({json:e}))}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 1;case"privateKey":return new s.OctetString;case"namedCurve":return"";case"publicKey":return new f.default;default:throw new Error("Invalid member name for ECCPrivateKey class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===e.defaultValues(t);case"privateKey":return r.isEqual(e.defaultValues(t));case"namedCurve":return""===r;case"publicKey":return f.default.compareWithDefault("namedCurve",r.namedCurve)&&f.default.compareWithDefault("x",r.x)&&f.default.compareWithDefault("y",r.y);
default:throw new Error("Invalid member name for ECCPrivateKey class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.OctetString({name:t.privateKey||""}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.ObjectIdentifier({name:t.namedCurve||""})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.BitString({name:t.publicKey||""})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(58),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.modulus=(0,l.getParametersValue)(t,"modulus",e.defaultValues("modulus")),this.publicExponent=(0,l.getParametersValue)(t,"publicExponent",e.defaultValues("publicExponent")),this.privateExponent=(0,l.getParametersValue)(t,"privateExponent",e.defaultValues("privateExponent")),this.prime1=(0,l.getParametersValue)(t,"prime1",e.defaultValues("prime1")),this.prime2=(0,l.getParametersValue)(t,"prime2",e.defaultValues("prime2")),this.exponent1=(0,l.getParametersValue)(t,"exponent1",e.defaultValues("exponent1")),this.exponent2=(0,l.getParametersValue)(t,"exponent2",e.defaultValues("exponent2")),this.coefficient=(0,l.getParametersValue)(t,"coefficient",e.defaultValues("coefficient")),"otherPrimeInfos"in t&&(this.otherPrimeInfos=(0,l.getParametersValue)(t,"otherPrimeInfos",e.defaultValues("otherPrimeInfos"))),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=r.result.version.valueBlock.valueDec,this.modulus=r.result.modulus.convertFromDER(256),this.publicExponent=r.result.publicExponent,this.privateExponent=r.result.privateExponent.convertFromDER(256),this.prime1=r.result.prime1.convertFromDER(128),this.prime2=r.result.prime2.convertFromDER(128),this.exponent1=r.result.exponent1.convertFromDER(128),this.exponent2=r.result.exponent2.convertFromDER(128),this.coefficient=r.result.coefficient.convertFromDER(128),"otherPrimeInfos"in r.result&&(this.otherPrimeInfos=Array.from(r.result.otherPrimeInfos,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&e.push(new s.Sequence({value:Array.from(this.otherPrimeInfos,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={n:(0,l.toBase64)((0,l.arrayBufferToString)(this.modulus.valueBlock.valueHex),!0,!0,!0),e:(0,l.toBase64)((0,l.arrayBufferToString)(this.publicExponent.valueBlock.valueHex),!0,!0,!0),d:(0,l.toBase64)((0,l.arrayBufferToString)(this.privateExponent.valueBlock.valueHex),!0,!0,!0),p:(0,l.toBase64)((0,l.arrayBufferToString)(this.prime1.valueBlock.valueHex),!0,!0,!0),q:(0,l.toBase64)((0,l.arrayBufferToString)(this.prime2.valueBlock.valueHex),!0,!0,!0),dp:(0,l.toBase64)((0,l.arrayBufferToString)(this.exponent1.valueBlock.valueHex),!0,!0,!0),dq:(0,l.toBase64)((0,l.arrayBufferToString)(this.exponent2.valueBlock.valueHex),!0,!0,!0),qi:(0,l.toBase64)((0,l.arrayBufferToString)(this.coefficient.valueBlock.valueHex),!0,!0,!0)};return"otherPrimeInfos"in this&&(e.oth=Array.from(this.otherPrimeInfos,function(e){return e.toJSON()})),e}},{key:"fromJSON",value:function(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.n,!0,!0))}),!("e"in e))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.e,!0,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.d,!0,!0))}),!("p"in e))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.p,!0,!0))}),!("q"in e))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.q,!0,!0))}),!("dp"in e))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.dp,!0,!0))}),!("dq"in e))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.dq,!0,!0))}),!("qi"in e))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new s.Integer({valueHex:(0,l.stringToArrayBuffer)((0,l.fromBase64)(e.qi,!0,!0))}),"oth"in e&&(this.otherPrimeInfos=Array.from(e.oth,function(e){return new f.default({json:e})}))}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"modulus":return new s.Integer;case"publicExponent":return new s.Integer;case"privateExponent":return new s.Integer;case"prime1":return new s.Integer;case"prime2":return new s.Integer;case"exponent1":return new s.Integer;case"exponent2":return new s.Integer;case"coefficient":return new s.Integer;case"otherPrimeInfos":return[];default:throw new Error("Invalid member name for RSAPrivateKey class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.Integer({name:t.modulus||""}),new s.Integer({name:t.publicExponent||""}),new s.Integer({name:t.privateExponent||""}),new s.Integer({name:t.prime1||""}),new s.Integer({name:t.prime2||""}),new s.Integer({name:t.exponent1||""}),new s.Integer({name:t.exponent2||""}),new s.Integer({name:t.coefficient||""}),new s.Sequence({optional:!0,value:[new s.Repeated({name:t.otherPrimeInfosName||"",value:f.default.schema(t.otherPrimeInfo||{})})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.prime=(0,s.getParametersValue)(t,"prime",e.defaultValues("prime")),this.exponent=(0,s.getParametersValue)(t,"exponent",e.defaultValues("exponent")),this.coefficient=(0,s.getParametersValue)(t,"coefficient",e.defaultValues("coefficient")),"schema"in t&&this.fromSchema(t.schema),"json"in t&&this.fromJSON(t.json)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=r.result.prime.convertFromDER(),this.exponent=r.result.exponent.convertFromDER(),this.coefficient=r.result.coefficient.convertFromDER()}},{key:"toSchema",value:function(){return new u.Sequence({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}},{key:"toJSON",value:function(){return{r:(0,s.toBase64)((0,s.arrayBufferToString)(this.prime.valueBlock.valueHex),!0,!0),d:(0,s.toBase64)((0,s.arrayBufferToString)(this.exponent.valueBlock.valueHex),!0,!0),t:(0,s.toBase64)((0,s.arrayBufferToString)(this.coefficient.valueBlock.valueHex),!0,!0)}}},{key:"fromJSON",value:function(e){if(!("r"in e))throw new Error('Absent mandatory parameter "r"');if(this.prime=new u.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.r,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new u.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.d,!0))}),!("t"in e))throw new Error('Absent mandatory parameter "t"');this.coefficient=new u.Integer({valueHex:(0,s.stringToArrayBuffer)((0,s.fromBase64)(e.t,!0))})}}],[{key:"defaultValues",value:function(e){switch(e){case"prime":return new u.Integer;case"exponent":return new u.Integer;case"coefficient":return new u.Integer;default:throw new Error("Invalid member name for OtherPrimeInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Integer({name:t.prime||""}),new u.Integer({name:t.exponent||""}),new u.Integer({name:t.coefficient||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.accessMethod=(0,l.getParametersValue)(t,"accessMethod",e.defaultValues("accessMethod")),this.accessLocation=(0,l.getParametersValue)(t,"accessLocation",e.defaultValues("accessLocation")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=r.result.accessMethod.valueBlock.toString(),this.accessLocation=new f.default({schema:r.result.accessLocation})}},{key:"toSchema",value:function(){return new s.Sequence({value:[new s.ObjectIdentifier({value:this.accessMethod}),this.accessLocation.toSchema()]})}},{key:"toJSON",value:function(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"accessMethod":return"";case"accessLocation":return new f.default;default:throw new Error("Invalid member name for AccessDescription class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.accessMethod||""}),f.default.schema(t.accessLocation||{})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,h.getParametersValue)(e,"names",{});return new f.Sequence({optional:t,value:[new f.Constructed({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:r.country_name||"",value:[new f.Choice({value:[new f.NumericString,new f.PrintableString]})]}),new f.Constructed({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:r.administration_domain_name||"",value:[new f.Choice({value:[new f.NumericString,new f.PrintableString]})]}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:r.network_address||"",isHexOnly:!0}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:r.terminal_identifier||"",isHexOnly:!0}),new f.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:r.private_domain_name||"",value:[new f.Choice({value:[new f.NumericString,new f.PrintableString]})]}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:r.organization_name||"",isHexOnly:!0}),new f.Primitive({optional:!0,name:r.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new f.Constructed({optional:!0,name:r.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new f.Primitive({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new f.Constructed({optional:!0,name:r.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new f.Repeated({value:new f.PrintableString})]})]})}function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new f.Sequence({optional:e,value:[new f.PrintableString,new f.PrintableString]})}function s(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new f.Set({optional:e,value:[new f.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new f.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new f.Any]})]})}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r(43),f=a(c),h=r(44),m=r(61),d=n(m),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.type=(0,h.getParametersValue)(t,"type",e.defaultValues("type")),this.value=(0,h.getParametersValue)(t,"value",e.defaultValues("value")),"schema"in t&&this.fromSchema(t.schema)}return l(e,[{key:"fromSchema",value:function(t){var r=f.compareSchema(t,t,e.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for GENERAL_NAME");switch(this.type=r.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=r.result.blockName;break;case 1:case 2:case 6:var n=r.result.blockName;n.idBlock.tagClass=1,n.idBlock.tagNumber=22;var a=n.toBER(!1);this.value=f.fromBER(a).result.valueBlock.value;break;case 3:this.value=r.result.blockName;break;case 4:this.value=new d.default({schema:r.result.directoryName});break;case 5:this.value=r.result.ediPartyName;break;case 7:this.value=new f.OctetString({valueHex:r.result.blockName.valueBlock.valueHex});break;case 8:var i=r.result.blockName;i.idBlock.tagClass=1,i.idBlock.tagNumber=6;var o=i.toBER(!1);this.value=f.fromBER(o).result.valueBlock.toString()}}},{key:"toSchema",value:function(){switch(this.type){case 0:case 3:case 5:return new f.Constructed({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:var t=new f.IA5String({value:this.value});return t.idBlock.tagClass=3,t.idBlock.tagNumber=this.type,t;case 4:return new f.Constructed({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:var r=this.value;return r.idBlock.tagClass=3,r.idBlock.tagNumber=this.type,r;case 8:var n=new f.ObjectIdentifier({value:this.value});return n.idBlock.tagClass=3,n.idBlock.tagNumber=this.type,n;default:return e.schema()}}},{key:"toJSON",value:function(){var e={type:this.type};return"string"==typeof this.value?e.value=this.value:e.value=this.value.toJSON(),e}}],[{key:"defaultValues",value:function(e){switch(e){case"type":return 9;case"value":return{};default:throw new Error("Invalid member name for GeneralName class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"type":return r===e.defaultValues(t);case"value":return 0===Object.keys(r).length;default:throw new Error("Invalid member name for GeneralName class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,h.getParametersValue)(e,"names",{});return new f.Choice({value:[new f.Constructed({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||"",value:[new f.ObjectIdentifier,new f.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new f.Any]})]}),new f.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new f.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new f.Constructed({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||"",value:[o(t.builtInStandardAttributes||{},!1),u(!0),s(!0)]}),new f.Constructed({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||"",value:[d.default.schema(t.directoryName||{})]}),new f.Constructed({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||"",value:[new f.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new f.Choice({value:[new f.TeletexString,new f.PrintableString,new f.UniversalString,new f.Utf8String,new f.BmpString]})]}),new f.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new f.Choice({value:[new f.TeletexString,new f.PrintableString,new f.UniversalString,new f.Utf8String,new f.BmpString]})]})]}),new f.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new f.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new f.Primitive({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}}]),e}();t.default=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(62),h=n(f),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.typesAndValues=(0,c.getParametersValue)(t,"typesAndValues",e.defaultValues("typesAndValues")),this.valueBeforeDecode=(0,c.getParametersValue)(t,"valueBeforeDecode",e.defaultValues("valueBeforeDecode")),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RDN");"typesAndValues"in r.result&&(this.typesAndValues=Array.from(r.result.typesAndValues,function(e){return new h.default({schema:e})})),this.valueBeforeDecode=r.result.RDN.valueBeforeDecode}},{key:"toSchema",value:function(){if(0===this.valueBeforeDecode.byteLength)return new l.Sequence({value:[new l.Set({value:Array.from(this.typesAndValues,function(e){return e.toSchema()})})]});var e=l.fromBER(this.valueBeforeDecode);return e.result}},{key:"toJSON",value:function(){return{typesAndValues:Array.from(this.typesAndValues,function(e){return e.toJSON()})}}},{key:"isEqual",value:function(t){if(t instanceof e){if(this.typesAndValues.length!==t.typesAndValues.length)return!1;var r=!0,n=!1,a=void 0;try{for(var i,u=this.typesAndValues.entries()[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=o(i.value,2),l=s[0],f=s[1];if(f.isEqual(t.typesAndValues[l])===!1)return!1}}catch(e){n=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw a}}return!0}return t instanceof ArrayBuffer&&(0,c.isEqualBuffer)(this.valueBeforeDecode,t)}}],[{key:"defaultValues",value:function(e){switch(e){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"typesAndValues":return 0===t.length;case"valueBeforeDecode":return 0===t.byteLength;default:throw new Error("Invalid member name for RelativeDistinguishedNames class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"",value:[new l.Repeated({name:t.repeatedSequence||"",value:new l.Set({value:[new l.Repeated({name:t.repeatedSet||"",value:h.default.schema(t.typeAndValue||{})})]})})]})}}]),e}();t.default=m},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=r(47),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.type=(0,s.getParametersValue)(t,"type",e.defaultValues("type")),this.value=(0,s.getParametersValue)(t,"value",e.defaultValues("value")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{type:"type",value:"typeValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ATTR_TYPE_AND_VALUE");this.type=r.result.type.valueBlock.toString(),this.value=r.result.typeValue}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.type}),this.value]})}},{key:"toJSON",value:function(){var e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e}},{key:"isEqual",value:function(t){if(t instanceof e){if(this.type!==t.type)return!1;if(this.value instanceof u.Utf8String&&t.value instanceof u.Utf8String||this.value instanceof u.BmpString&&t.value instanceof u.BmpString||this.value instanceof u.UniversalString&&t.value instanceof u.UniversalString||this.value instanceof u.NumericString&&t.value instanceof u.NumericString||this.value instanceof u.PrintableString&&t.value instanceof u.PrintableString||this.value instanceof u.TeletexString&&t.value instanceof u.TeletexString||this.value instanceof u.VideotexString&&t.value instanceof u.VideotexString||this.value instanceof u.IA5String&&t.value instanceof u.IA5String||this.value instanceof u.GraphicString&&t.value instanceof u.GraphicString||this.value instanceof u.VisibleString&&t.value instanceof u.VisibleString||this.value instanceof u.GeneralString&&t.value instanceof u.GeneralString||this.value instanceof u.CharacterString&&t.value instanceof u.CharacterString){var r=(0,l.stringPrep)(this.value.valueBlock.value),n=(0,l.stringPrep)(t.value.valueBlock.value);if(0!==r.localeCompare(n))return!1}else if((0,s.isEqualBuffer)(this.value.valueBeforeDecode,t.value.valueBeforeDecode)===!1)return!1;return!0}return t instanceof ArrayBuffer&&(0,s.isEqualBuffer)(this.value.valueBeforeDecode,t)}}],[{key:"defaultValues",value:function(e){switch(e){case"type":return"";case"value":return{};default:throw new Error("Invalid member name for AttributeTypeAndValue class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.type||""}),new u.Any({name:t.value||""})]})}}]),e}();t.default=c},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),"seconds"in t&&(this.seconds=(0,s.getParametersValue)(t,"seconds",e.defaultValues("seconds"))),"millis"in t&&(this.millis=(0,s.getParametersValue)(t,"millis",e.defaultValues("millis"))),"micros"in t&&(this.micros=(0,s.getParametersValue)(t,"micros",e.defaultValues("micros"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{seconds:"seconds",millis:"millis",micros:"micros"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for tsp.Accuracy");if("seconds"in r.result&&(this.seconds=r.result.seconds.valueBlock.valueDec),"millis"in r.result){var n=new u.Integer({valueHex:r.result.millis.valueBlock.valueHex});this.millis=n.valueBlock.valueDec}if("micros"in r.result){var a=new u.Integer({valueHex:r.result.micros.valueBlock.valueHex});this.micros=a.valueBlock.valueDec}}},{key:"toSchema",value:function(){var e=[];if("seconds"in this&&e.push(new u.Integer({value:this.seconds})),"millis"in this){var t=new u.Integer({value:this.millis});e.push(new u.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHex}))}if("micros"in this){var r=new u.Integer({value:this.micros});e.push(new u.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:r.valueBlock.valueHex}))}return new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"seconds"in this&&(e.seconds=this.seconds),"millis"in this&&(e.millis=this.millis),"micros"in this&&(e.micros=this.micros),e}}],[{key:"defaultValues",value:function(e){switch(e){case"seconds":case"millis":case"micros":return 0;default:throw new Error("Invalid member name for Accuracy class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"seconds":case"millis":case"micros":return r===e.defaultValues(t);default:throw new Error("Invalid member name for Accuracy class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",optional:!0,value:[new u.Integer({optional:!0,name:t.seconds||""}),new u.Primitive({name:t.millis||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new u.Primitive({name:t.micros||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.altNames=(0,l.getParametersValue)(t,"altNames",e.defaultValues("altNames")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{altNames:"altNames"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in r.result&&(this.altNames=Array.from(r.result.altNames,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.altNames,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{altNames:Array.from(this.altNames,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"altNames":return[];default:throw new Error("Invalid member name for AltName class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.altNames||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance");
}}(),s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(43),c=a(l),f=r(44),h=r(66),m=n(h),d=r(67),v=n(d),p=r(101),g=n(p),y=r(70),b=n(y),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.safeContents=(0,f.getParametersValue)(t,"safeContents",e.defaultValues("safeContents")),"parsedValue"in t&&(this.parsedValue=(0,f.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return s(e,[{key:"fromSchema",value:function(t){var r=c.compareSchema(t,t,e.schema({names:{contentInfos:"contentInfos"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for AuthenticatedSafe");this.safeContents=Array.from(r.result.contentInfos,function(e){return new m.default({schema:e})})}},{key:"toSchema",value:function(){return new c.Sequence({value:Array.from(this.safeContents,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{safeContents:Array.from(this.safeContents,function(e){return e.toJSON()})}}},{key:"parseInternalValues",value:function(e){var t=this;if(e instanceof Object==!1)return Promise.reject('The "parameters" must has "Object" type');if("safeContents"in e==!1)return Promise.reject('Absent mandatory parameter "safeContents"');if(e.safeContents instanceof Array==!1)return Promise.reject('The "parameters.safeContents" must has "Array" type');if(e.safeContents.length!==this.safeContents.length)return Promise.reject('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');var r=Promise.resolve();this.parsedValue={safeContents:[]};var n=!0,a=!1,i=void 0;try{for(var s,l=this.safeContents.entries()[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var f=u(s.value,2),h=f[0],m=f[1];switch(m.contentType){case"1.2.840.113549.1.7.1":if(m.content instanceof c.OctetString==!1)return Promise.reject('Wrong type of "this.safeContents[j].content"');var d=c.fromBER(m.content.valueBlock.valueHex);if(d.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "content.content"');this.parsedValue.safeContents.push({privacyMode:0,value:new v.default({schema:d.result})});break;case"1.2.840.113549.1.7.3":var p=function(){var n=new g.default({schema:m.content});if("recipientCertificate"in e.safeContents[h]==!1)return{v:Promise.reject('Absent mandatory parameter "recipientCertificate" in "parameters.safeContents[j]"')};var a=e.safeContents[h].recipientCertificate;if("recipientKey"in e.safeContents[h]==!1)return{v:Promise.reject('Absent mandatory parameter "recipientKey" in "parameters.safeContents[j]"')};var i=e.safeContents[h].recipientKey;r=r.then(function(){return n.decrypt(0,{recipientCertificate:a,recipientPrivateKey:i})}),r=r.then(function(e){var r=c.fromBER(e);return r.offset===-1?Promise.reject("Error during parsing of decrypted data"):(t.parsedValue.safeContents.push({privacyMode:2,value:new v.default({schema:r.result})}),Promise.resolve())})}();if("object"===("undefined"==typeof p?"undefined":o(p)))return p.v;break;case"1.2.840.113549.1.7.6":var y=function(){var n=new b.default({schema:m.content});if("password"in e.safeContents[h]==!1)return{v:Promise.reject('Absent mandatory parameter "password" in "parameters.safeContents[j]"')};var a=e.safeContents[h].password;r=r.then(function(){return n.decrypt({password:a})},function(e){return Promise.reject(e)}),r=r.then(function(e){var r=c.fromBER(e);return r.offset===-1?Promise.reject("Error during parsing of decrypted data"):(t.parsedValue.safeContents.push({privacyMode:1,value:new v.default({schema:r.result})}),Promise.resolve())},function(e){return Promise.reject(e)})}();if("object"===("undefined"==typeof y?"undefined":o(y)))return y.v;break;default:throw new Error('Unknown "contentType" for AuthenticatedSafe: " '+m.contentType)}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return r}},{key:"makeInternalValues",value:function(e){var t=this;if("parsedValue"in this==!1)return Promise.reject('Please run "parseValues" first or add "parsedValue" manually');if(this.parsedValue instanceof Object==!1)return Promise.reject('The "this.parsedValue" must has "Object" type');if(this.parsedValue.safeContents instanceof Array==!1)return Promise.reject('The "this.parsedValue.safeContents" must has "Array" type');if(e instanceof Object==!1)return Promise.reject('The "parameters" must has "Object" type');if("safeContents"in e==!1)return Promise.reject('Absent mandatory parameter "safeContents"');if(e.safeContents instanceof Array==!1)return Promise.reject('The "parameters.safeContents" must has "Array" type');if(e.safeContents.length!==this.parsedValue.safeContents.length)return Promise.reject('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');var r=Promise.resolve();this.safeContents=[];var n=!0,a=!1,i=void 0;try{for(var s,l=this.parsedValue.safeContents.entries()[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var f=u(s.value,2),h=f[0],d=f[1];if("privacyMode"in d==!1)return Promise.reject('The "privacyMode" is a mandatory parameter for "content"');if("value"in d==!1)return Promise.reject('The "value" is a mandatory parameter for "content"');if(d.value instanceof v.default==!1)return Promise.reject('The "content.value" must has "SafeContents" type');switch(d.privacyMode){case 0:!function(){var e=d.value.toSchema().toBER(!1);r=r.then(function(){t.safeContents.push(new m.default({contentType:"1.2.840.113549.1.7.1",content:new c.OctetString({valueHex:e})}))})}();break;case 1:!function(){var n=new b.default,a=e.safeContents[h];a.contentToEncrypt=d.value.toSchema().toBER(!1),r=r.then(function(){return n.encrypt(a)},function(e){return Promise.reject(e)}),r=r.then(function(){t.safeContents.push(new m.default({contentType:"1.2.840.113549.1.7.6",content:n.toSchema()}))},function(e){return Promise.reject(e)})}();break;case 2:var p=function(){var n=new g.default,a=d.value.toSchema().toBER(!1);if("encryptingCertificate"in e.safeContents[h]==!1)return{v:Promise.reject('Absent mandatory parameter "encryptingCertificate" in "parameters.safeContents[i]"')};if("encryptionAlgorithm"in e.safeContents[h]==!1)return{v:Promise.reject('Absent mandatory parameter "encryptionAlgorithm" in "parameters.safeContents[i]"')};switch(!0){case"aes-cbc"===e.safeContents[h].encryptionAlgorithm.name.toLowerCase():case"aes-gcm"===e.safeContents[h].encryptionAlgorithm.name.toLowerCase():break;default:return{v:Promise.reject('Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": '+e.safeContents[h].encryptionAlgorithm)}}switch(!0){case 128===e.safeContents[h].encryptionAlgorithm.length:case 192===e.safeContents[h].encryptionAlgorithm.length:case 256===e.safeContents[h].encryptionAlgorithm.length:break;default:return{v:Promise.reject('Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": '+e.safeContents[h].encryptionAlgorithm.length)}}var i=e.safeContents[h].encryptionAlgorithm;n.addRecipientByCertificate(e.safeContents[h].encryptingCertificate),r=r.then(function(){return n.encrypt(i,a)}),r=r.then(function(){t.safeContents.push(new m.default({contentType:"1.2.840.113549.1.7.3",content:n.toSchema()}))})}();if("object"===("undefined"==typeof p?"undefined":o(p)))return p.v;break;default:return Promise.reject('Incorrect value for "content.privacyMode": '+d.privacyMode)}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return r.then(function(){return t},function(e){return Promise.reject("Error during parsing: "+e)})}}],[{key:"defaultValues",value:function(e){switch(e){case"safeContents":return[];case"parsedValue":return{};default:throw new Error("Invalid member name for AuthenticatedSafe class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"safeContents":return 0===t.length;case"parsedValue":return t instanceof Object&&0===Object.keys(t).length;default:throw new Error("Invalid member name for AuthenticatedSafe class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,f.getParametersValue)(e,"names",{});return new c.Sequence({name:t.blockName||"",value:[new c.Repeated({name:t.contentInfos||"",value:m.default.schema()})]})}}]),e}();t.default=w},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.contentType=(0,s.getParametersValue)(t,"contentType",e.defaultValues("contentType")),this.content=(0,s.getParametersValue)(t,"content",e.defaultValues("content")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_CONTENT_INFO");this.contentType=r.result.contentType.valueBlock.toString(),this.content=r.result.content}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.contentType}),new u.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}},{key:"toJSON",value:function(){var e={contentType:this.contentType};return this.content instanceof u.Any||(e.content=this.content.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"contentType":return"";case"content":return new u.Any;default:throw new Error("Invalid member name for ContentInfo class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"contentType":return""===t;case"content":return t instanceof u.Any;default:throw new Error("Invalid member name for ContentInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new u.Sequence({name:t.blockName||"ContentInfo",optional:t.optional,value:[new u.ObjectIdentifier({name:t.contentType||"contentType"}),new u.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new u.Any({name:t.content||"content"})]})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(68),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.safeBags=(0,l.getParametersValue)(t,"safeBags",e.defaultValues("safeBags")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{safeBags:"safeBags"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SafeContents");this.safeBags=Array.from(r.result.safeBags,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.safeBags,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{safeBags:Array.from(this.safeBags,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"safeBags":return[];default:throw new Error("Invalid member name for SafeContents class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"safeBags":return 0===t.length;default:throw new Error("Invalid member name for SafeContents class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.safeBags||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(55),f=n(c),h=r(54),m=n(h),d=r(69),v=n(d),p=r(74),g=n(p),y=r(97),b=n(y),w=r(100),k=n(w),S=r(67),C=n(S),P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.bagId=(0,l.getParametersValue)(t,"bagId",e.defaultValues("bagId")),this.bagValue=(0,l.getParametersValue)(t,"bagValue",e.defaultValues("bagValue")),"bagAttributes"in t&&(this.bagAttributes=(0,l.getParametersValue)(t,"bagAttributes",e.defaultValues("bagAttributes"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{bagId:"bagId",bagValue:"bagValue",bagAttributes:"bagAttributes"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SafeBag");switch(this.bagId=r.result.bagId.valueBlock.toString(),this.bagId){case"1.2.840.113549.1.12.10.1.1":this.bagValue=new m.default({schema:r.result.bagValue});break;case"1.2.840.113549.1.12.10.1.2":this.bagValue=new v.default({schema:r.result.bagValue});break;case"1.2.840.113549.1.12.10.1.3":this.bagValue=new g.default({schema:r.result.bagValue});break;case"1.2.840.113549.1.12.10.1.4":this.bagValue=new b.default({schema:r.result.bagValue});break;case"1.2.840.113549.1.12.10.1.5":this.bagValue=new k.default({schema:r.result.bagValue});break;case"1.2.840.113549.1.12.10.1.6":this.bagValue=new C.default({schema:r.result.bagValue});break;default:throw new Error('Invalid "bagId" for SafeBag: '+this.bagId)}"bagAttributes"in r.result&&(this.bagAttributes=Array.from(r.result.bagAttributes,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[new s.ObjectIdentifier({value:this.bagId}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return"bagAttributes"in this&&e.push(new s.Set({value:Array.from(this.bagAttributes,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return"bagAttributes"in this&&(e.bagAttributes=Array.from(this.bagAttributes,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"bagId":return"";case"bagValue":return new s.Any;case"bagAttributes":return[];default:throw new Error("Invalid member name for SafeBag class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"bagId":return""===t;case"bagValue":return t instanceof s.Any;case"bagAttributes":return 0===t.length;default:throw new Error("Invalid member name for SafeBag class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.bagId||"bagId"}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Any({name:t.bagValue||"bagValue"})]}),new s.Set({optional:!0,value:[new s.Repeated({name:t.bagAttributes||"bagAttributes",value:f.default.schema()})]})]})}}]),e}();t.default=P},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=r(70),m=n(h),d=r(71),v=n(d),p=r(54),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.encryptionAlgorithm=(0,l.getParametersValue)(t,"encryptionAlgorithm",e.defaultValues("encryptionAlgorithm")),this.encryptedData=(0,l.getParametersValue)(t,"encryptedData",e.defaultValues("encryptedData")),"parsedValue"in t&&(this.parsedValue=(0,l.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{encryptionAlgorithm:{names:{blockName:"encryptionAlgorithm"}},encryptedData:"encryptedData"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS8ShroudedKeyBag");this.encryptionAlgorithm=new f.default({schema:r.result.encryptionAlgorithm}),this.encryptedData=r.result.encryptedData}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}},{key:"toJSON",value:function(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}},{key:"parseInternalValues",value:function(e){var t=this,r=Promise.resolve(),n=new m.default({encryptedContentInfo:new v.default({contentEncryptionAlgorithm:this.encryptionAlgorithm,encryptedContent:this.encryptedData})});return r=r.then(function(){return n.decrypt(e)},function(e){return Promise.reject(e)}),r=r.then(function(e){var r=s.fromBER(e);return r.offset===-1?Promise.reject("Error during parsing ASN.1 data"):void(t.parsedValue=new g.default({schema:r.result}))},function(e){return Promise.reject(e)})}},{key:"makeInternalValues",value:function(e){var t=this;if("parsedValue"in this==!1)return Promise.reject('Please initialize "parsedValue" first');var r=Promise.resolve(),n=new m.default;return r=r.then(function(){return e.contentToEncrypt=t.parsedValue.toSchema().toBER(!1),n.encrypt(e)},function(e){return Promise.reject(e)}),r=r.then(function(){t.encryptionAlgorithm=n.encryptedContentInfo.contentEncryptionAlgorithm,t.encryptedData=n.encryptedContentInfo.encryptedContent})}}],[{key:"defaultValues",value:function(e){switch(e){case"encryptionAlgorithm":return new f.default;case"encryptedData":return new s.OctetString;case"parsedValue":return{};default:throw new Error("Invalid member name for PKCS8ShroudedKeyBag class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"encryptionAlgorithm":return f.default.compareWithDefault("algorithmId",r.algorithmId)&&"algorithmParams"in r==!1;case"encryptedData":return r.isEqual(e.defaultValues(t));case"parsedValue":return r instanceof Object&&0===Object.keys(r).length;default:throw new Error("Invalid member name for PKCS8ShroudedKeyBag class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.encryptionAlgorithm||{names:{blockName:"encryptionAlgorithm"}}),new s.Choice({value:[new s.OctetString({name:t.encryptedData||"encryptedData"}),new s.OctetString({idBlock:{isConstructed:!0},name:t.encryptedData||"encryptedData"})]})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(71),h=n(f),m=r(55),d=n(m),v=r(72),p=n(v),g=r(48),y=n(g),b=r(73),w=n(b),k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.encryptedContentInfo=(0,l.getParametersValue)(t,"encryptedContentInfo",e.defaultValues("encryptedContentInfo")),"unprotectedAttrs"in t&&(this.unprotectedAttrs=(0,l.getParametersValue)(t,"unprotectedAttrs",e.defaultValues("unprotectedAttrs"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",encryptedContentInfo:{names:{blockName:"encryptedContentInfo"}},unprotectedAttrs:"unprotectedAttrs"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_ENCRYPTED_DATA");this.version=r.result.version.valueBlock.valueDec,this.encryptedContentInfo=new h.default({schema:r.result.encryptedContentInfo}),"unprotectedAttrs"in r.result&&(this.unprotectedAttrs=Array.from(r.result.unprotectedAttrs,function(e){return new d.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),"unprotectedAttrs"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return"unprotectedAttrs"in this&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,function(e){return e.toJSON()})),e}},{key:"encrypt",value:function(e){var t=this;if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in e==!1)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');var r=(0,c.getOIDByAlgorithm)(e.contentEncryptionAlgorithm);if(""===r)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');var n=(0,c.getOIDByAlgorithm)({name:"PBKDF2"});if(""===n)return Promise.reject("Can not find OID for PBKDF2");var a=(0,c.getOIDByAlgorithm)({name:"HMAC",hash:{name:e.hmacHashAlgorithm}});if(""===a)return Promise.reject('Incorrect value for "hmacHashAlgorithm": '+e.hmacHashAlgorithm);var i=(0,c.getCrypto)();if("undefined"==typeof i)return Promise.reject("Unable to create WebCrypto object");var o=Promise.resolve(),u=new ArrayBuffer(16),l=new Uint8Array(u);(0,c.getRandomValues)(l);var f=new ArrayBuffer(64),m=new Uint8Array(f);(0,c.getRandomValues)(m);var d=new Uint8Array(e.contentToEncrypt),v=new p.default({salt:new s.OctetString({valueHex:f}),iterationCount:e.iterationCount,prf:new y.default({algorithmId:a,algorithmParams:new s.Null})});return o=o.then(function(){var t=new Uint8Array(e.password);return i.importKey("raw",t,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),o=o.then(function(t){return i.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:m,iterations:e.iterationCount},t,e.contentEncryptionAlgorithm,!1,["encrypt"])},function(e){return Promise.reject(e)}),o=o.then(function(t){return i.encrypt({name:e.contentEncryptionAlgorithm.name,iv:l},t,d)},function(e){return Promise.reject(e)}),o=o.then(function(e){var a=new w.default({keyDerivationFunc:new y.default({algorithmId:n,algorithmParams:v.toSchema()}),encryptionScheme:new y.default({algorithmId:r,algorithmParams:new s.OctetString({valueHex:u})})});t.encryptedContentInfo=new h.default({contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new y.default({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:a.toSchema()}),encryptedContent:new s.OctetString({valueHex:e})})},function(e){return Promise.reject(e)})}},{key:"decrypt",value:function(e){var t=this;if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("1.2.840.113549.1.5.13"!==this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)return Promise.reject('Unknown "contentEncryptionAlgorithm": '+this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);var r=(0,c.getCrypto)();if("undefined"==typeof r)return Promise.reject("Unable to create WebCrypto object");var n=Promise.resolve(),a=void 0;try{a=new w.default({schema:this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}var i=void 0;try{i=new p.default({schema:a.keyDerivationFunc.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}var o=(0,c.getAlgorithmByOID)(a.encryptionScheme.algorithmId);if("name"in o==!1)return Promise.reject('Incorrect OID for "contentEncryptionAlgorithm": '+a.encryptionScheme.algorithmId);var u=a.encryptionScheme.algorithmParams.valueBlock.valueHex,s=new Uint8Array(u),f=i.salt.valueBlock.valueHex,h=new Uint8Array(f),m=i.iterationCount,d="SHA-1";if("prf"in i){var v=(0,c.getAlgorithmByOID)(i.prf.algorithmId);if("name"in v==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");d=v.hash.name}return n=n.then(function(){return r.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),n=n.then(function(e){return r.deriveKey({name:"PBKDF2",hash:{name:d},salt:h,iterations:m},e,o,!1,["decrypt"])},function(e){return Promise.reject(e)}),n=n.then(function(e){var n=new ArrayBuffer(0);if(t.encryptedContentInfo.encryptedContent.idBlock.isConstructed===!1)n=t.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else{var a=!0,i=!1,u=void 0;try{for(var c,f=t.encryptedContentInfo.encryptedContent.valueBlock.value[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value;n=(0,l.utilConcatBuf)(n,h.valueBlock.valueHex)}}catch(e){i=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(i)throw u}}}return r.decrypt({name:o.name,iv:s},e,n)},function(e){return Promise.reject(e)})}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"encryptedContentInfo":return new h.default;case"unprotectedAttrs":return[];default:throw new Error("Invalid member name for EncryptedData class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"version":return 0===t;case"encryptedContentInfo":return h.default.compareWithDefault("contentType",t.contentType)&&h.default.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&h.default.compareWithDefault("encryptedContent",t.encryptedContent);case"unprotectedAttrs":return 0===t.length;default:throw new Error("Invalid member name for EncryptedData class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),h.default.schema(t.encryptedContentInfo||{}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.unprotectedAttrs||"",value:d.default.schema()})]})]})}}]),e}();t.default=k},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,e),this.contentType=(0,l.getParametersValue)(t,"contentType",e.defaultValues("contentType")),this.contentEncryptionAlgorithm=(0,l.getParametersValue)(t,"contentEncryptionAlgorithm",e.defaultValues("contentEncryptionAlgorithm")),"encryptedContent"in t&&(this.encryptedContent=t.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&this.encryptedContent.idBlock.isConstructed===!1)){for(var r=new s.OctetString({idBlock:{isConstructed:!0},isConstructed:!0}),n=0,a=this.encryptedContent.valueBlock.valueHex.byteLength;a>0;){for(var o=new Uint8Array(this.encryptedContent.valueBlock.valueHex,n,n+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-n:1024),u=new ArrayBuffer(o.length),c=new Uint8Array(u),f=0;f<c.length;f++)c[f]=o[f];r.valueBlock.value.push(new s.OctetString({valueHex:u})),a-=o.length,n+=o.length}this.encryptedContent=r}"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=r.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new f.default({schema:r.result.contentEncryptionAlgorithm}),"encryptedContent"in r.result&&(this.encryptedContent=r.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}},{key:"toSchema",value:function(){var e={isIndefiniteForm:!1},t=[];if(t.push(new s.ObjectIdentifier({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),"encryptedContent"in this){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;var r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new s.Sequence({lenBlock:e,value:t})}},{key:"toJSON",value:function(){var e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return"encryptedContent"in this&&(e.encryptedContent=this.encryptedContent.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"contentType":return"";case"contentEncryptionAlgorithm":return new f.default;case"encryptedContent":
return new s.OctetString;default:throw new Error("Invalid member name for EncryptedContentInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"contentType":return""===r;case"contentEncryptionAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"encryptedContent":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for EncryptedContentInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.contentType||""}),f.default.schema(t.contentEncryptionAlgorithm||{}),new s.Choice({value:[new s.Constructed({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({value:new s.OctetString})]}),new s.Primitive({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.salt=(0,l.getParametersValue)(t,"salt",e.defaultValues("salt")),this.iterationCount=(0,l.getParametersValue)(t,"iterationCount",e.defaultValues("iterationCount")),this.keyLength=(0,l.getParametersValue)(t,"keyLength",e.defaultValues("keyLength")),this.prf=(0,l.getParametersValue)(t,"prf",e.defaultValues("prf")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:!0}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PBKDF2_params");this.salt=r.result.salt,this.iterationCount=r.result.iterationCount.valueBlock.valueDec,"keyLength"in r.result&&(this.keyLength=r.result.keyLength.valueBlock.valueDec),"prf"in r.result&&(this.prf=new f.default({schema:r.result.prf}))}},{key:"toSchema",value:function(){var t=[];return t.push(this.salt),t.push(new s.Integer({value:this.iterationCount})),e.defaultValues("keyLength")!==this.keyLength&&t.push(new s.Integer({value:this.keyLength})),e.defaultValues("prf").isEqual(this.prf)===!1&&t.push(this.prf.toSchema()),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return e.defaultValues("keyLength")!==this.keyLength&&(t.keyLength=this.keyLength),e.defaultValues("prf").isEqual(this.prf)===!1&&(t.prf=this.prf.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new f.default;default:throw new Error("Invalid member name for PBKDF2Params class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Choice({value:[new s.OctetString({name:t.saltPrimitive||""}),f.default.schema(t.saltConstructed||{})]}),new s.Integer({name:t.iterationCount||""}),new s.Integer({name:t.keyLength||"",optional:!0}),f.default.schema(t.prf||{names:{optional:!0}})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.keyDerivationFunc=(0,l.getParametersValue)(t,"keyDerivationFunc",e.defaultValues("keyDerivationFunc")),this.encryptionScheme=(0,l.getParametersValue)(t,"encryptionScheme",e.defaultValues("encryptionScheme")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PBES2_params");this.keyDerivationFunc=new f.default({schema:r.result.keyDerivationFunc}),this.encryptionScheme=new f.default({schema:r.result.encryptionScheme})}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}},{key:"toJSON",value:function(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"keyDerivationFunc":return new f.default;case"encryptionScheme":return new f.default;default:throw new Error("Invalid member name for PBES2Params class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.keyDerivationFunc||{}),f.default.schema(t.encryptionScheme||{})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(75),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.certId=(0,l.getParametersValue)(t,"certId",e.defaultValues("certId")),this.certValue=(0,l.getParametersValue)(t,"certValue",e.defaultValues("certValue")),"parsedValue"in t&&(this.parsedValue=(0,l.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{id:"certId",value:"certValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CertBag");switch(this.certId=r.result.certId.valueBlock.toString(),this.certValue=r.result.certValue,this.certId){case"1.2.840.113549.1.9.22.1":var n=s.fromBER(this.certValue.valueBlock.valueHex);this.parsedValue=new f.default({schema:n.result});break;case"1.2.840.113549.1.9.22.2":default:throw new Error('Incorrect "certId" value in CertBag: '+this.certId)}}},{key:"toSchema",value:function(){return"parsedValue"in this&&(this.certId="1.2.840.113549.1.9.22.1",this.certValue=new s.OctetString({valueHex:this.parsedValue.toSchema().toBER(!1)})),new s.Sequence({value:[new s.ObjectIdentifier({value:this.certId}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}},{key:"toJSON",value:function(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"certId":return"";case"certValue":return new s.Any;case"parsedValue":return{};default:throw new Error("Invalid member name for CertBag class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"certId":return""===t;case"certValue":return t instanceof s.Any;case"parsedValue":return t instanceof Object&&0===Object.keys(t).length;default:throw new Error("Invalid member name for CertBag class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.id||"id"}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Any({name:t.value||"value"})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"tbsCertificate",value:[new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new l.Integer({name:t.tbsCertificateVersion||"tbsCertificate.version"})]}),new l.Integer({name:t.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),m.default.schema(t.signature||{names:{blockName:"tbsCertificate.signature"}}),v.default.schema(t.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new l.Sequence({name:t.tbsCertificateValidity||"tbsCertificate.validity",value:[g.default.schema(t.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),g.default.schema(t.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),v.default.schema(t.subject||{names:{blockName:"tbsCertificate.subject"}}),b.default.schema(t.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new l.Primitive({name:t.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new l.Primitive({name:t.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[C.default.schema(t.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(47),h=r(48),m=n(h),d=r(61),v=n(d),p=r(76),g=n(p),y=r(51),b=n(y),w=r(77),k=n(w),S=r(96),C=n(S),P=r(49),A=n(P),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbs=(0,c.getParametersValue)(t,"tbs",e.defaultValues("tbs")),this.version=(0,c.getParametersValue)(t,"version",e.defaultValues("version")),this.serialNumber=(0,c.getParametersValue)(t,"serialNumber",e.defaultValues("serialNumber")),this.signature=(0,c.getParametersValue)(t,"signature",e.defaultValues("signature")),this.issuer=(0,c.getParametersValue)(t,"issuer",e.defaultValues("issuer")),this.notBefore=(0,c.getParametersValue)(t,"notBefore",e.defaultValues("notBefore")),this.notAfter=(0,c.getParametersValue)(t,"notAfter",e.defaultValues("notAfter")),this.subject=(0,c.getParametersValue)(t,"subject",e.defaultValues("subject")),this.subjectPublicKeyInfo=(0,c.getParametersValue)(t,"subjectPublicKeyInfo",e.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in t&&(this.issuerUniqueID=(0,c.getParametersValue)(t,"issuerUniqueID",e.defaultValues("issuerUniqueID"))),"subjectUniqueID"in t&&(this.subjectUniqueID=(0,c.getParametersValue)(t,"subjectUniqueID",e.defaultValues("subjectUniqueID"))),"extensions"in t&&(this.extensions=(0,c.getParametersValue)(t,"extensions",e.defaultValues("extensions"))),this.signatureAlgorithm=(0,c.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signatureValue=(0,c.getParametersValue)(t,"signatureValue",e.defaultValues("signatureValue")),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CERT");this.tbs=r.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in r.result&&(this.version=r.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=r.result["tbsCertificate.serialNumber"],this.signature=new m.default({schema:r.result["tbsCertificate.signature"]}),this.issuer=new v.default({schema:r.result["tbsCertificate.issuer"]}),this.notBefore=new g.default({schema:r.result["tbsCertificate.notBefore"]}),this.notAfter=new g.default({schema:r.result["tbsCertificate.notAfter"]}),this.subject=new v.default({schema:r.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new b.default({schema:r.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in r.result&&(this.issuerUniqueID=r.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in r.result&&(this.issuerUniqueID=r.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in r.result&&(this.extensions=Array.from(r.result["tbsCertificate.extensions"],function(e){return new k.default({schema:e})})),this.signatureAlgorithm=new m.default({schema:r.result.signatureAlgorithm}),this.signatureValue=r.result.signatureValue}},{key:"encodeTBS",value:function(){var t=[];return"version"in this&&this.version!==e.defaultValues("version")&&t.push(new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new l.Integer({value:this.version})]})),t.push(this.serialNumber),t.push(this.signature.toSchema()),t.push(this.issuer.toSchema()),t.push(new l.Sequence({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),t.push(this.subject.toSchema()),t.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&t.push(new l.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&t.push(new l.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"subjectUniqueID"in this&&t.push(new l.Primitive({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[this.extensions.toSchema()]})),"extensions"in this&&t.push(new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new l.Sequence({value:Array.from(this.extensions,function(e){return e.toSchema()})})]})),new l.Sequence({value:t})}},{key:"toSchema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={};if(t===!1){if(0===this.tbs.length)return e.schema().value[0];r=l.fromBER(this.tbs).result}else r=this.encodeTBS();return new l.Sequence({value:[r,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function(){var t={tbs:(0,c.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==e.defaultValues("version")&&(t.version=this.version),"issuerUniqueID"in this&&(t.issuerUniqueID=(0,c.bufferToHexCodes)(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(t.subjectUniqueID=(0,c.bufferToHexCodes)(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(t.extensions=Array.from(this.extensions,function(e){return e.toJSON()})),t}},{key:"getPublicKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,f.getCrypto)();if("undefined"==typeof t)return Promise.reject("Unable to create WebCrypto object");if(null===e){e={};var r=(0,f.getHashAlgorithm)(this.signatureAlgorithm);if(""===r)return Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId);var n=(0,f.getAlgorithmByOID)(this.subjectPublicKeyInfo.algorithm.algorithmId);if("name"in n==!1)return Promise.reject("Unsupported public key algorithm: "+this.subjectPublicKeyInfo.algorithm.algorithmId);if(e.algorithm=(0,f.getAlgorithmParameters)(n.name,"importkey"),"hash"in e.algorithm.algorithm&&(e.algorithm.algorithm.hash.name=r),"ECDSA"===n.name){var a=!1;if("algorithmParams"in this.subjectPublicKeyInfo.algorithm==!0&&"idBlock"in this.subjectPublicKeyInfo.algorithm.algorithmParams&&1===this.subjectPublicKeyInfo.algorithm.algorithmParams.idBlock.tagClass&&6===this.subjectPublicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber&&(a=!0),a===!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var i=(0,f.getAlgorithmByOID)(this.subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());if("name"in i==!1)return Promise.reject("Unsupported named curve algorithm: "+this.subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());e.algorithm.algorithm.namedCurve=i.name}}var o=this.subjectPublicKeyInfo.toSchema(),u=o.toBER(!1),s=new Uint8Array(u);return t.importKey("spki",s,e.algorithm.algorithm,!0,e.algorithm.usages)}},{key:"getKeyHash",value:function(){var e=(0,f.getCrypto)();return"undefined"==typeof e?Promise.reject("Unable to create WebCrypto object"):e.digest({name:"sha-1"},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}},{key:"sign",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",n=(0,f.getOIDByAlgorithm)({name:r});if(""===n)return Promise.reject("Unsupported hash algorithm: "+r);var a=(0,f.getAlgorithmParameters)(e.algorithm.name,"sign");switch(a.algorithm.hash.name=r,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signature.algorithmId=(0,f.getOIDByAlgorithm)(a.algorithm),this.signatureAlgorithm.algorithmId=this.signature.algorithmId;break;case"RSA-PSS":switch(r.toUpperCase()){case"SHA-256":a.algorithm.saltLength=32;break;case"SHA-384":a.algorithm.saltLength=48;break;case"SHA-512":a.algorithm.saltLength=64}var i={};if("SHA-1"!==r.toUpperCase()){var o=(0,f.getOIDByAlgorithm)({name:r});if(""===o)return Promise.reject("Unsupported hash algorithm: "+r);i.hashAlgorithm=new m.default({algorithmId:o,algorithmParams:new l.Null}),i.maskGenAlgorithm=new m.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}20!==a.algorithm.saltLength&&(i.saltLength=a.algorithm.saltLength);var u=new A.default(i);this.signature=new m.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:u.toSchema()}),this.signatureAlgorithm=this.signature;break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}this.tbs=this.encodeTBS().toBER(!1);var s=(0,f.getCrypto)();return"undefined"==typeof s?Promise.reject("Unable to create WebCrypto object"):s.sign(a.algorithm,e,new Uint8Array(this.tbs)).then(function(e){"ECDSA"===a.algorithm.name&&(e=(0,f.createCMSECDSASignature)(e)),t.signatureValue=new l.BitString({valueHex:e})},function(e){return Promise.reject("Signing error: "+e)})}},{key:"verify",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=Promise.resolve(),n={},a=this.signatureValue,i=this.tbs;if(null!==t?n=t.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(n=this.subjectPublicKeyInfo),n instanceof b.default==!1)return Promise.reject("Please provide issuer certificate as a parameter");var o=(0,f.getCrypto)();if("undefined"==typeof o)return Promise.reject("Unable to create WebCrypto object");var u=(0,f.getHashAlgorithm)(this.signatureAlgorithm);return""===u?Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId):(r=r.then(function(){var t=void 0;t="1.2.840.113549.1.1.10"===e.signatureAlgorithm.algorithmId?e.signatureAlgorithm.algorithmId:n.algorithm.algorithmId;var r=(0,f.getAlgorithmByOID)(t);if("name"in r==!1)return Promise.reject("Unsupported public key algorithm: "+t);var a=(0,f.getAlgorithmParameters)(r.name,"importkey");if("hash"in a.algorithm&&(a.algorithm.hash.name=u),"ECDSA"===r.name){var i=!1;if("algorithmParams"in n.algorithm==!0&&"idBlock"in n.algorithm.algorithmParams&&1===n.algorithm.algorithmParams.idBlock.tagClass&&6===n.algorithm.algorithmParams.idBlock.tagNumber&&(i=!0),i===!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var s=(0,f.getAlgorithmByOID)(n.algorithm.algorithmParams.valueBlock.toString());if("name"in s==!1)return Promise.reject("Unsupported named curve algorithm: "+n.algorithm.algorithmParams.valueBlock.toString());a.algorithm.namedCurve=s.name}var l=n.toSchema(),c=l.toBER(!1),h=new Uint8Array(c);return o.importKey("spki",h,a.algorithm,!0,a.usages)}),r=r.then(function(t){var r=(0,f.getAlgorithmParameters)(t.algorithm.name,"verify");"hash"in r.algorithm&&(r.algorithm.hash.name=u);var n=a.valueBlock.valueHex;if("ECDSA"===t.algorithm.name){var s=l.fromBER(n);n=(0,f.createECDSASignatureFromCMS)(s.result)}if("RSA-PSS"===t.algorithm.name){var c=void 0;try{c=new A.default({schema:e.signatureAlgorithm.algorithmParams})}catch(e){return Promise.reject(e)}"saltLength"in c?r.algorithm.saltLength=c.saltLength:r.algorithm.saltLength=20;var h="SHA-1";if("hashAlgorithm"in c){var m=(0,f.getAlgorithmByOID)(c.hashAlgorithm.algorithmId);if("name"in m==!1)return Promise.reject("Unrecognized hash algorithm: "+c.hashAlgorithm.algorithmId);h=m.name}r.algorithm.hash.name=h}return o.verify(r.algorithm,t,new Uint8Array(n),new Uint8Array(i))}))}}],[{key:"defaultValues",value:function(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new l.Integer;case"signature":return new m.default;case"issuer":return new v.default;case"notBefore":return new g.default;case"notAfter":return new g.default;case"subject":return new v.default;case"subjectPublicKeyInfo":return new b.default;case"issuerUniqueID":return new ArrayBuffer(0);case"subjectUniqueID":return new ArrayBuffer(0);case"extensions":return[];case"signatureAlgorithm":return new m.default;case"signatureValue":return new l.BitString;default:throw new Error("Invalid member name for Certificate class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"",value:[o(t.tbsCertificate),m.default.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new l.BitString({name:t.signatureValue||"signatureValue"})]})}}]),e}();t.default=I},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.type=(0,s.getParametersValue)(t,"type",e.defaultValues("type")),this.value=(0,s.getParametersValue)(t,"value",e.defaultValues("value")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for TIME");"utcTimeName"in r.result&&(this.type=0,this.value=r.result.utcTimeName.toDate()),"generalTimeName"in r.result&&(this.type=1,this.value=r.result.generalTimeName.toDate())}},{key:"toSchema",value:function(){var e={};return 0===this.type&&(e=new u.UTCTime({valueDate:this.value})),1===this.type&&(e=new u.GeneralizedTime({valueDate:this.value})),e}},{key:"toJSON",value:function(){return{type:this.type,value:this.value}}}],[{key:"defaultValues",value:function(e){switch(e){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error("Invalid member name for Time class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,s.getParametersValue)(e,"names",{});return new u.Choice({optional:t,value:[new u.UTCTime({name:r.utcTimeName||""}),new u.GeneralizedTime({name:r.generalTimeName||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(78),f=n(c),h=r(79),m=n(h),d=r(64),v=n(d),p=r(80),g=n(p),y=r(81),b=n(y),w=r(82),k=n(w),S=r(83),C=n(S),P=r(85),A=n(P),I=r(87),_=n(I),O=r(90),B=n(O),E=r(92),N=n(E),j=r(93),V=n(j),x=r(94),R=n(x),D=r(95),T=n(D),U=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.extnID=(0,l.getParametersValue)(t,"extnID",e.defaultValues("extnID")),this.critical=(0,l.getParametersValue)(t,"critical",e.defaultValues("critical")),"extnValue"in t?this.extnValue=new s.OctetString({valueHex:t.extnValue}):this.extnValue=e.defaultValues("extnValue"),"parsedValue"in t&&(this.parsedValue=(0,l.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSION");if(this.extnID=r.result.extnID.valueBlock.toString(),"critical"in r.result&&(this.critical=r.result.critical.valueBlock.value),this.extnValue=r.result.extnValue,r=s.fromBER(this.extnValue.valueBlock.valueHex),r.offset!==-1)switch(this.extnID){case"2.5.29.9":this.parsedValue=new f.default({schema:r.result});break;case"2.5.29.14":this.parsedValue=r.result;break;case"2.5.29.15":this.parsedValue=r.result;break;case"2.5.29.16":this.parsedValue=new m.default({schema:r.result});break;case"2.5.29.17":case"2.5.29.18":this.parsedValue=new v.default({schema:r.result});break;case"2.5.29.19":this.parsedValue=new g.default({schema:r.result});break;case"2.5.29.20":case"2.5.29.27":this.parsedValue=r.result;break;case"2.5.29.21":this.parsedValue=r.result;break;case"2.5.29.24":this.parsedValue=r.result;break;case"2.5.29.28":this.parsedValue=new b.default({schema:r.result});break;case"2.5.29.29":this.parsedValue=new k.default({schema:r.result});break;case"2.5.29.30":this.parsedValue=new C.default({schema:r.result});break;case"2.5.29.31":case"2.5.29.46":this.parsedValue=new A.default({schema:r.result});break;case"2.5.29.32":this.parsedValue=new _.default({schema:r.result});break;case"2.5.29.33":this.parsedValue=new B.default({schema:r.result});break;case"2.5.29.35":this.parsedValue=new N.default({schema:r.result});break;case"2.5.29.36":this.parsedValue=new V.default({schema:r.result});break;case"2.5.29.37":this.parsedValue=new R.default({schema:r.result});break;case"2.5.29.54":this.parsedValue=r.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":this.parsedValue=new T.default({schema:r.result})}}},{key:"toSchema",value:function(){var t=[];return t.push(new s.ObjectIdentifier({value:this.extnID})),this.critical!==e.defaultValues("critical")&&t.push(new s.Boolean({value:this.critical})),t.push(this.extnValue),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==e.defaultValues("critical")&&(t.critical=this.critical),"parsedValue"in this&&(t.parsedValue=this.parsedValue.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"extnID":return"";case"critical":return!1;case"extnValue":return new s.OctetString;case"parsedValue":return{};default:throw new Error("Invalid member name for Extension class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.extnID||""}),new s.Boolean({name:t.critical||"",optional:!0}),new s.OctetString({name:t.extnValue||""})]})}}]),e}();t.default=U},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(55),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.attributes=(0,l.getParametersValue)(t,"attributes",e.defaultValues("attributes")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{attributes:"attributes"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(r.result.attributes,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.attributes,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{attributes:Array.from(this.attributes,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"attributes":return[];default:throw new Error("Invalid member name for SubjectDirectoryAttributes class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.attributes||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;
var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),"notBefore"in t&&(this.notBefore=(0,s.getParametersValue)(t,"notBefore",e.defaultValues("notBefore"))),"notAfter"in t&&(this.notAfter=(0,s.getParametersValue)(t,"notAfter",e.defaultValues("notAfter"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in r.result){var n=new u.GeneralizedTime;n.fromBuffer(r.result.notBefore.valueBlock.valueHex),this.notBefore=n.toDate()}if("notAfter"in r.result){var a=new u.GeneralizedTime({valueHex:r.result.notAfter.valueBlock.valueHex});a.fromBuffer(r.result.notAfter.valueBlock.valueHex),this.notAfter=a.toDate()}}},{key:"toSchema",value:function(){var e=[];return"notBefore"in this&&e.push(new u.Primitive({idBlock:{tagClass:3,tagNumber:0},valueHex:new u.GeneralizedTime({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&e.push(new u.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new u.GeneralizedTime({valueDate:this.notAfter}).valueBlock.valueHex})),new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e}}],[{key:"defaultValues",value:function(e){switch(e){case"notBefore":return new Date;case"notAfter":return new Date;default:throw new Error("Invalid member name for PrivateKeyUsagePeriod class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Primitive({name:t.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new u.Primitive({name:t.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.cA=(0,s.getParametersValue)(t,"cA",!1),"pathLenConstraint"in t&&(this.pathLenConstraint=(0,s.getParametersValue)(t,"pathLenConstraint",0)),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in r.result&&(this.cA=r.result.cA.valueBlock.value),"pathLenConstraint"in r.result&&(r.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=r.result.pathLenConstraint:this.pathLenConstraint=r.result.pathLenConstraint.valueBlock.valueDec)}},{key:"toSchema",value:function(){var t=[];return this.cA!==e.defaultValues("cA")&&t.push(new u.Boolean({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof u.Integer?t.push(this.pathLenConstraint):t.push(new u.Integer({value:this.pathLenConstraint}))),new u.Sequence({value:t})}},{key:"toJSON",value:function(){var t={};return this.cA!==e.defaultValues("cA")&&(t.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof u.Integer?t.pathLenConstraint=this.pathLenConstraint.toJSON():t.pathLenConstraint=this.pathLenConstraint),t}}],[{key:"defaultValues",value:function(e){switch(e){case"cA":return!1;default:throw new Error("Invalid member name for BasicConstraints class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Boolean({optional:!0,name:t.cA||""}),new u.Integer({optional:!0,name:t.pathLenConstraint||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=r(61),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),"distributionPoint"in t&&(this.distributionPoint=(0,l.getParametersValue)(t,"distributionPoint",e.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=(0,l.getParametersValue)(t,"onlyContainsUserCerts",e.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=(0,l.getParametersValue)(t,"onlyContainsCACerts",e.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in t&&(this.onlySomeReasons=(0,l.getParametersValue)(t,"onlySomeReasons",e.defaultValues("onlySomeReasons"))),this.indirectCRL=(0,l.getParametersValue)(t,"indirectCRL",e.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=(0,l.getParametersValue)(t,"onlyContainsAttributeCerts",e.defaultValues("onlyContainsAttributeCerts")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in r.result)switch(!0){case 0===r.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(r.result.distributionPointNames,function(e){return new f.default({schema:e})});break;case 1===r.result.distributionPoint.idBlock.tagNumber:r.result.distributionPoint.idBlock.tagClass=1,r.result.distributionPoint.idBlock.tagNumber=16,this.distributionPoint=new m.default({schema:r.result.distributionPoint});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in r.result){var n=new Uint8Array(r.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==n[0]}if("onlyContainsCACerts"in r.result){var a=new Uint8Array(r.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==a[0]}if("onlySomeReasons"in r.result){var i=new Uint8Array(r.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=i[0]}if("indirectCRL"in r.result){var o=new Uint8Array(r.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==o[0]}if("onlyContainsAttributeCerts"in r.result){var u=new Uint8Array(r.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==u[0]}}},{key:"toSchema",value:function(){var t=[];if("distributionPoint"in this){var r=void 0;this.distributionPoint instanceof Array?r=new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(e){return e.toSchema()})}):(r=this.distributionPoint.toSchema(),r.idBlock.tagClass=3,r.idBlock.tagNumber=1),t.push(r)}if(this.onlyContainsUserCerts!==e.defaultValues("onlyContainsUserCerts")&&t.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==e.defaultValues("onlyContainsCACerts")&&t.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){var n=new ArrayBuffer(1),a=new Uint8Array(n);a[0]=this.onlySomeReasons,t.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:3},valueHex:n}))}return this.indirectCRL!==e.defaultValues("indirectCRL")&&t.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==e.defaultValues("onlyContainsAttributeCerts")&&t.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?t.distributionPoint=Array.from(this.distributionPoint,function(e){return e.toJSON()}):t.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==e.defaultValues("onlyContainsUserCerts")&&(t.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==e.defaultValues("onlyContainsCACerts")&&(t.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(t.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==e.defaultValues("indirectCRL")&&(t.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==e.defaultValues("onlyContainsAttributeCerts")&&(t.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),t}}],[{key:"defaultValues",value:function(e){switch(e){case"distributionPoint":return[];case"onlyContainsUserCerts":return!1;case"onlyContainsCACerts":return!1;case"onlySomeReasons":return 0;case"indirectCRL":return!1;case"onlyContainsAttributeCerts":return!1;default:throw new Error("Invalid member name for IssuingDistributionPoint class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Choice({value:[new s.Constructed({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.distributionPointNames||"",value:f.default.schema()})]}),new s.Constructed({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:m.default.schema().valueBlock.value})]})]}),new s.Primitive({name:t.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new s.Primitive({name:t.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new s.Primitive({name:t.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new s.Primitive({name:t.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new s.Primitive({name:t.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.names=(0,l.getParametersValue)(t,"names",e.defaultValues("names")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(r.result.names,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.names,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{names:Array.from(this.names,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"names":return[];default:throw new Error("Invalid member name for GeneralNames class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({value:[new s.Repeated({name:t.blockName||"names",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(84),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),"permittedSubtrees"in t&&(this.permittedSubtrees=(0,l.getParametersValue)(t,"permittedSubtrees",e.defaultValues("permittedSubtrees"))),"excludedSubtrees"in t&&(this.excludedSubtrees=(0,l.getParametersValue)(t,"excludedSubtrees",e.defaultValues("excludedSubtrees"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in r.result&&(this.permittedSubtrees=Array.from(r.result.permittedSubtrees,function(e){return new f.default({schema:e})})),"excludedSubtrees"in r.result&&(this.excludedSubtrees=Array.from(r.result.excludedSubtrees,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return"permittedSubtrees"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Sequence({value:Array.from(this.permittedSubtrees,function(e){return e.toSchema()})})]})),"excludedSubtrees"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Sequence({value:Array.from(this.excludedSubtrees,function(e){return e.toSchema()})})]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"permittedSubtrees"in this&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,function(e){return e.toJSON()})),"excludedSubtrees"in this&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"permittedSubtrees":return[];case"excludedSubtrees":return[];default:throw new Error("Invalid member name for NameConstraints class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.permittedSubtrees||"",value:f.default.schema()})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.excludedSubtrees||"",value:f.default.schema()})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.base=(0,l.getParametersValue)(t,"base",e.defaultValues("base")),this.minimum=(0,l.getParametersValue)(t,"minimum",e.defaultValues("minimum")),"maximum"in t&&(this.maximum=(0,l.getParametersValue)(t,"maximum",e.defaultValues("maximum"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ");this.base=new f.default({schema:r.result.base}),"minimum"in r.result&&(r.result.minimum.valueBlock.isHexOnly?this.minimum=r.result.minimum:this.minimum=r.result.minimum.valueBlock.valueDec),"maximum"in r.result&&(r.result.maximum.valueBlock.isHexOnly?this.maximum=r.result.maximum:this.maximum=r.result.maximum.valueBlock.valueDec)}},{key:"toSchema",value:function(){var e=[];if(e.push(this.base.toSchema()),0!==this.minimum){var t=0;t=this.minimum instanceof s.Integer?this.minimum:new s.Integer({value:this.minimum}),e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if("maximum"in this){var r=0;r=this.maximum instanceof s.Integer?this.maximum:new s.Integer({value:this.maximum}),e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[r]}))}return new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={base:this.base.toJSON()};return 0!==this.minimum&&("number"==typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"base":return new f.default;case"minimum":return 0;case"maximum":return 0;default:throw new Error("Invalid member name for GeneralSubtree class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.base||{}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({name:t.minimum||""})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Integer({name:t.maximum||""})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(86),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.distributionPoints=(0,l.getParametersValue)(t,"distributionPoints",e.defaultValues("distributionPoints")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{distributionPoints:"distributionPoints"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(r.result.distributionPoints,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.distributionPoints,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{distributionPoints:Array.from(this.distributionPoints,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"distributionPoints":return[];default:throw new Error("Invalid member name for CRLDistributionPoints class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.distributionPoints||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=r(61),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),"distributionPoint"in t&&(this.distributionPoint=(0,l.getParametersValue)(t,"distributionPoint",e.defaultValues("distributionPoint"))),"reasons"in t&&(this.reasons=(0,l.getParametersValue)(t,"reasons",e.defaultValues("reasons"))),"cRLIssuer"in t&&(this.cRLIssuer=(0,l.getParametersValue)(t,"cRLIssuer",e.defaultValues("cRLIssuer"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in r.result&&(0===r.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(r.result.distributionPointNames,function(e){return new f.default({schema:e})})),1===r.result.distributionPoint.idBlock.tagNumber&&(r.result.distributionPoint.idBlock.tagClass=1,r.result.distributionPoint.idBlock.tagNumber=16,this.distributionPoint=new m.default({schema:r.result.distributionPoint}))),"reasons"in r.result&&(this.reasons=new s.BitString({valueHex:r.result.reasons.valueBlock.valueHex})),"cRLIssuer"in r.result&&(this.cRLIssuer=Array.from(r.result.cRLIssuerNames,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];if("distributionPoint"in this){var t=void 0;t=this.distributionPoint instanceof Array?new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,function(e){return e.toSchema()})}):new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return"reasons"in this&&e.push(new s.Primitive({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,function(e){return e.toJSON()}):e.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(e.cRLIssuer=Array.from(this.cRLIssuer,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"distributionPoint":return[];case"reasons":return new s.BitString;case"cRLIssuer":return[];default:throw new Error("Invalid member name for DistributionPoint class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Choice({value:[new s.Constructed({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.distributionPointNames||"",value:f.default.schema()})]}),new s.Constructed({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:m.default.schema().valueBlock.value})]})]}),new s.Primitive({name:t.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new s.Constructed({name:t.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new s.Repeated({name:t.cRLIssuerNames||"",value:f.default.schema()})]})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(88),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.certificatePolicies=(0,l.getParametersValue)(t,"certificatePolicies",e.defaultValues("certificatePolicies")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{certificatePolicies:"certificatePolicies"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(r.result.certificatePolicies,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.certificatePolicies,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{certificatePolicies:Array.from(this.certificatePolicies,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"certificatePolicies":return[];default:throw new Error("Invalid member name for CertificatePolicies class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.certificatePolicies||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(89),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.policyIdentifier=(0,l.getParametersValue)(t,"policyIdentifier",e.defaultValues("policyIdentifier")),"policyQualifiers"in t&&(this.policyQualifiers=(0,l.getParametersValue)(t,"policyQualifiers",e.defaultValues("policyQualifiers"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=r.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in r.result&&(this.policyQualifiers=Array.from(r.result.policyQualifiers,function(e){return new f.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(new s.ObjectIdentifier({value:this.policyIdentifier})),"policyQualifiers"in this&&e.push(new s.Sequence({value:Array.from(this.policyQualifiers,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(e.policyQualifiers=Array.from(this.policyQualifiers,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error("Invalid member name for PolicyInformation class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.policyIdentifier||""}),new s.Sequence({optional:!0,value:[new s.Repeated({name:t.policyQualifiers||"",value:f.default.schema()})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.policyQualifierId=(0,s.getParametersValue)(t,"policyQualifierId",e.defaultValues("policyQualifierId")),this.qualifier=(0,s.getParametersValue)(t,"qualifier",e.defaultValues("qualifier")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=r.result.policyQualifierId.valueBlock.toString(),this.qualifier=r.result.qualifier}},{key:"toSchema",value:function(){return new u.Sequence({
value:[new u.ObjectIdentifier({value:this.policyQualifierId}),this.qualifier]})}},{key:"toJSON",value:function(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"policyQualifierId":return"";case"qualifier":return new u.Any;default:throw new Error("Invalid member name for PolicyQualifierInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.policyQualifierId||""}),new u.Any({name:t.qualifier||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(91),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.mappings=(0,l.getParametersValue)(t,"mappings",e.defaultValues("mappings")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{mappings:"mappings"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(r.result.mappings,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.mappings,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{mappings:Array.from(this.mappings,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"mappings":return[];default:throw new Error("Invalid member name for PolicyMappings class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.mappings||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.issuerDomainPolicy=(0,s.getParametersValue)(t,"issuerDomainPolicy",e.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=(0,s.getParametersValue)(t,"subjectDomainPolicy",e.defaultValues("subjectDomainPolicy")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=r.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=r.result.subjectDomainPolicy.valueBlock.toString()}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.issuerDomainPolicy}),new u.ObjectIdentifier({value:this.subjectDomainPolicy})]})}},{key:"toJSON",value:function(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}],[{key:"defaultValues",value:function(e){switch(e){case"issuerDomainPolicy":return"";case"subjectDomainPolicy":return"";default:throw new Error("Invalid member name for PolicyMapping class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.issuerDomainPolicy||""}),new u.ObjectIdentifier({name:t.subjectDomainPolicy||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),"keyIdentifier"in t&&(this.keyIdentifier=(0,l.getParametersValue)(t,"keyIdentifier",e.defaultValues("keyIdentifier"))),"authorityCertIssuer"in t&&(this.authorityCertIssuer=(0,l.getParametersValue)(t,"authorityCertIssuer",e.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in t&&(this.authorityCertSerialNumber=(0,l.getParametersValue)(t,"authorityCertSerialNumber",e.defaultValues("authorityCertSerialNumber"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in r.result&&(r.result.keyIdentifier.idBlock.tagClass=1,r.result.keyIdentifier.idBlock.tagNumber=4,this.keyIdentifier=r.result.keyIdentifier),"authorityCertIssuer"in r.result&&(this.authorityCertIssuer=Array.from(r.result.authorityCertIssuer,function(e){return new f.default({schema:e})})),"authorityCertSerialNumber"in r.result&&(r.result.authorityCertSerialNumber.idBlock.tagClass=1,r.result.authorityCertSerialNumber.idBlock.tagNumber=2,this.authorityCertSerialNumber=r.result.authorityCertSerialNumber)}},{key:"toSchema",value:function(){var e=[];if("keyIdentifier"in this){var t=this.keyIdentifier;t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("authorityCertIssuer"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Sequence({value:Array.from(this.authorityCertIssuer,function(e){return e.toSchema()})})]})),"authorityCertSerialNumber"in this){var r=this.authorityCertSerialNumber;r.idBlock.tagClass=3,r.idBlock.tagNumber=2,e.push(r)}return new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,function(e){return e.toJSON()})),"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"keyIdentifier":return new s.OctetString;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new s.Integer;default:throw new Error("Invalid member name for AuthorityKeyIdentifier class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Primitive({name:t.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.authorityCertIssuer||"",value:f.default.schema()})]}),new s.Primitive({name:t.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),"requireExplicitPolicy"in t&&(this.requireExplicitPolicy=(0,s.getParametersValue)(t,"requireExplicitPolicy",e.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in t&&(this.inhibitPolicyMapping=(0,s.getParametersValue)(t,"inhibitPolicyMapping",e.defaultValues("inhibitPolicyMapping"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in r.result){var n=r.result.requireExplicitPolicy;n.idBlock.tagClass=1,n.idBlock.tagNumber=2;var a=n.toBER(!1),i=u.fromBER(a);this.requireExplicitPolicy=i.result.valueBlock.valueDec}if("inhibitPolicyMapping"in r.result){var o=r.result.inhibitPolicyMapping;o.idBlock.tagClass=1,o.idBlock.tagNumber=2;var s=o.toBER(!1),l=u.fromBER(s);this.inhibitPolicyMapping=l.result.valueBlock.valueDec}}},{key:"toSchema",value:function(){var e=[];if("requireExplicitPolicy"in this){var t=new u.Integer({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("inhibitPolicyMapping"in this){var r=new u.Integer({value:this.inhibitPolicyMapping});r.idBlock.tagClass=3,r.idBlock.tagNumber=1,e.push(r)}return new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}],[{key:"defaultValues",value:function(e){switch(e){case"requireExplicitPolicy":return 0;case"inhibitPolicyMapping":return 0;default:throw new Error("Invalid member name for PolicyConstraints class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Primitive({name:t.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new u.Primitive({name:t.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.keyPurposes=(0,s.getParametersValue)(t,"keyPurposes",e.defaultValues("keyPurposes")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{keyPurposes:"keyPurposes"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(r.result.keyPurposes,function(e){return e.valueBlock.toString()})}},{key:"toSchema",value:function(){return new u.Sequence({value:Array.from(this.keyPurposes,function(e){return new u.ObjectIdentifier({value:e})})})}},{key:"toJSON",value:function(){return{keyPurposes:Array.from(this.keyPurposes)}}}],[{key:"defaultValues",value:function(e){switch(e){case"keyPurposes":return[];default:throw new Error("Invalid member name for ExtKeyUsage class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Repeated({name:t.keyPurposes||"",value:new u.ObjectIdentifier})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(59),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.accessDescriptions=(0,l.getParametersValue)(t,"accessDescriptions",e.defaultValues("accessDescriptions")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{accessDescriptions:"accessDescriptions"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(r.result.accessDescriptions,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.accessDescriptions,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{accessDescriptions:Array.from(this.accessDescriptions,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"accessDescriptions":return[];default:throw new Error("Invalid member name for InfoAccess class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.accessDescriptions||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(77),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.extensions=(0,l.getParametersValue)(t,"extensions",e.defaultValues("extensions")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{extensions:"extensions"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for EXTENSIONS");this.extensions=Array.from(r.result.extensions,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.extensions,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{extensions:Array.from(this.extensions,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"extensions":return[];default:throw new Error("Invalid member name for Extensions class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({optional:t,name:r.blockName||"",value:[new s.Repeated({name:r.extensions||"",value:f.default.schema(r.extension||{})})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(98),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.crlId=(0,l.getParametersValue)(t,"crlId",e.defaultValues("crlId")),this.crlValue=(0,l.getParametersValue)(t,"crlValue",e.defaultValues("crlValue")),"parsedValue"in t&&(this.parsedValue=(0,l.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{id:"crlId",value:"crlValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CRLBag");switch(this.crlId=r.result.crlId.valueBlock.toString(),this.crlValue=r.result.crlValue,this.crlId){case"1.2.840.113549.1.9.23.1":var n=s.fromBER(this.certValue.valueBlock.valueHex);this.parsedValue=new f.default({schema:n.result});break;default:throw new Error('Incorrect "crlId" value in CertBag: '+this.crlId)}}},{key:"toSchema",value:function(){return"parsedValue"in this&&(this.certId="1.2.840.113549.1.9.23.1",this.certValue=new s.OctetString({valueHex:this.parsedValue.toSchema().toBER(!1)})),new s.Sequence({value:[new s.ObjectIdentifier({value:this.crlId}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}},{key:"toJSON",value:function(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"crlId":return"";case"crlValue":return new s.Any;case"parsedValue":return{};default:throw new Error("Invalid member name for CRLBag class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"crlId":return""===t;case"crlValue":return t instanceof s.Any;case"parsedValue":return t instanceof Object&&0===Object.keys(t).length;default:throw new Error("Invalid member name for CRLBag class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.ObjectIdentifier({name:t.id||"id"}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Any({name:t.value||"value"})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"tbsCertList",value:[new l.Integer({optional:!0,name:t.tbsCertListVersion||"tbsCertList.version",value:2}),m.default.schema(t.signature||{names:{blockName:"tbsCertList.signature"}}),v.default.schema(t.issuer||{names:{blockName:"tbsCertList.issuer"}}),g.default.schema(t.tbsCertListThisUpdate||{names:{utcTimeName:"tbsCertList.thisUpdate",generalTimeName:"tbsCertList.thisUpdate"}}),g.default.schema(t.tbsCertListNextUpdate||{names:{utcTimeName:"tbsCertList.nextUpdate",generalTimeName:"tbsCertList.nextUpdate"}},!0),new l.Sequence({optional:!0,value:[new l.Repeated({name:t.tbsCertListRevokedCertificates||"tbsCertList.revokedCertificates",value:new l.Sequence({value:[new l.Integer,g.default.schema(),k.default.schema({},!0)]})})]}),new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[k.default.schema(t.crlExtensions||{names:{blockName:"tbsCertList.extensions"}})]})]})}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(47),h=r(48),m=n(h),d=r(61),v=n(d),p=r(76),g=n(p),y=r(99),b=n(y),w=r(96),k=n(w),S=r(49),C=n(S),P=r(51),A=n(P),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbs=(0,c.getParametersValue)(t,"tbs",e.defaultValues("tbs")),this.version=(0,c.getParametersValue)(t,"version",e.defaultValues("version")),this.signature=(0,c.getParametersValue)(t,"signature",e.defaultValues("signature")),this.issuer=(0,c.getParametersValue)(t,"issuer",e.defaultValues("issuer")),this.thisUpdate=(0,c.getParametersValue)(t,"thisUpdate",e.defaultValues("thisUpdate")),"nextUpdate"in t&&(this.nextUpdate=(0,c.getParametersValue)(t,"nextUpdate",e.defaultValues("nextUpdate"))),"revokedCertificates"in t&&(this.revokedCertificates=(0,c.getParametersValue)(t,"revokedCertificates",e.defaultValues("revokedCertificates"))),"crlExtensions"in t&&(this.crlExtensions=(0,c.getParametersValue)(t,"crlExtensions",e.defaultValues("crlExtensions"))),this.signatureAlgorithm=(0,c.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signatureValue=(0,c.getParametersValue)(t,"signatureValue",e.defaultValues("signatureValue")),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CRL");this.tbs=r.result.tbsCertList.valueBeforeDecode,"tbsCertList.version"in r.result&&(this.version=r.result["tbsCertList.version"].valueBlock.valueDec),this.signature=new m.default({schema:r.result["tbsCertList.signature"]}),this.issuer=new v.default({schema:r.result["tbsCertList.issuer"]}),this.thisUpdate=new g.default({schema:r.result["tbsCertList.thisUpdate"]}),"tbsCertList.nextUpdate"in r.result&&(this.nextUpdate=new g.default({schema:r.result["tbsCertList.nextUpdate"]})),"tbsCertList.revokedCertificates"in r.result&&(this.revokedCertificates=Array.from(r.result["tbsCertList.revokedCertificates"],function(e){return new b.default({schema:e})})),"tbsCertList.extensions"in r.result&&(this.crlExtensions=new k.default({schema:r.result["tbsCertList.extensions"]})),this.signatureAlgorithm=new m.default({schema:r.result.signatureAlgorithm}),this.signatureValue=r.result.signatureValue}},{key:"encodeTBS",value:function(){var t=[];return this.version!==e.defaultValues("version")&&t.push(new l.Integer({value:this.version})),t.push(this.signature.toSchema()),t.push(this.issuer.toSchema()),t.push(this.thisUpdate.toSchema()),"nextUpdate"in this&&t.push(this.nextUpdate.toSchema()),"revokedCertificates"in this&&t.push(new l.Sequence({value:Array.from(this.revokedCertificates,function(e){return e.toSchema()})})),"crlExtensions"in this&&t.push(new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new l.Sequence({value:t})}},{key:"toSchema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=void 0;if(t===!1){if(0===this.tbs.length)return e.schema();r=l.fromBER(this.tbs).result}else r=this.encodeTBS();return new l.Sequence({value:[r,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function(){var t={tbs:(0,c.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==e.defaultValues("version")&&(t.version=this.version),"nextUpdate"in this&&(t.nextUpdate=this.nextUpdate.toJSON()),"revokedCertificates"in this&&(t.revokedCertificates=Array.from(this.revokedCertificates,function(e){return e.toJSON()})),"crlExtensions"in this&&(t.crlExtensions=this.crlExtensions.toJSON()),t}},{key:"isCertificateRevoked",value:function(e){if(this.issuer.isEqual(e.issuer)===!1)return!1;if("revokedCertificates"in this==!1)return!1;var t=!0,r=!1,n=void 0;try{for(var a,i=this.revokedCertificates[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;if(o.userCertificate.isEqual(e.serialNumber))return!0}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return!1}},{key:"sign",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1";if("undefined"==typeof e)return Promise.reject("Need to provide a private key for signing");var n=(0,f.getOIDByAlgorithm)({name:r});if(""===n)return Promise.reject("Unsupported hash algorithm: "+r);var a=(0,f.getAlgorithmParameters)(e.algorithm.name,"sign");switch(a.algorithm.hash.name=r,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signature.algorithmId=(0,f.getOIDByAlgorithm)(a.algorithm),this.signatureAlgorithm.algorithmId=this.signature.algorithmId;break;case"RSA-PSS":switch(r.toUpperCase()){case"SHA-256":a.algorithm.saltLength=32;break;case"SHA-384":a.algorithm.saltLength=48;break;case"SHA-512":a.algorithm.saltLength=64}var i={};if("SHA-1"!==r.toUpperCase()){var o=(0,f.getOIDByAlgorithm)({name:r});if(""===o)return Promise.reject("Unsupported hash algorithm: "+r);i.hashAlgorithm=new m.default({algorithmId:o,algorithmParams:new l.Null}),i.maskGenAlgorithm=new m.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}20!==a.algorithm.saltLength&&(i.saltLength=a.algorithm.saltLength);var u=new C.default(i);this.signature=new m.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:u.toSchema()}),this.signatureAlgorithm=this.signature;break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}this.tbs=this.encodeTBS().toBER(!1);var s=(0,f.getCrypto)();return"undefined"==typeof s?Promise.reject("Unable to create WebCrypto object"):s.sign(a.algorithm,e,new Uint8Array(this.tbs)).then(function(e){"ECDSA"===a.algorithm.name&&(e=(0,f.createCMSECDSASignature)(e)),t.signatureValue=new l.BitString({valueHex:e})},function(e){return Promise.reject("Signing error: "+e)})}},{key:"verify",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Promise.resolve(),n=this.signatureValue,a=this.tbs,i=-1;if("issuerCertificate"in t&&(i=t.issuerCertificate.subjectPublicKeyInfo,this.issuer.isEqual(t.issuerCertificate.subject)===!1))return Promise.resolve(!1);if("publicKeyInfo"in t&&(i=t.publicKeyInfo),i instanceof A.default==!1)return Promise.reject("Issuer's certificate must be provided as an input parameter");if("crlExtensions"in this){var o=!0,u=!1,s=void 0;try{for(var c,h=this.crlExtensions.extensions[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var m=c.value;if(m.critical&&"parsedValue"in m==!1)return Promise.resolve(!1)}}catch(e){u=!0,s=e}finally{try{!o&&h.return&&h.return()}finally{if(u)throw s}}}var d=(0,f.getCrypto)();if("undefined"==typeof d)return Promise.reject("Unable to create WebCrypto object");var v=(0,f.getHashAlgorithm)(this.signatureAlgorithm);return""===v?Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId):(r=r.then(function(){var t=(0,f.getAlgorithmByOID)(e.signature.algorithmId);if("name"in t==="")return Promise.reject("Unsupported public key algorithm: "+e.signature.algorithmId);var r=(0,f.getAlgorithmParameters)(t.name,"importkey");if("hash"in r.algorithm&&(r.algorithm.hash.name=v),"ECDSA"===t.name){var n=!1;if("algorithmParams"in i.algorithm==!0&&"idBlock"in i.algorithm.algorithmParams&&1===i.algorithm.algorithmParams.idBlock.tagClass&&6===i.algorithm.algorithmParams.idBlock.tagNumber&&(n=!0),n===!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var a=(0,f.getAlgorithmByOID)(i.algorithm.algorithmParams.valueBlock.toString());if("name"in a==!1)return Promise.reject("Unsupported named curve algorithm: "+i.algorithm.algorithmParams.valueBlock.toString());r.algorithm.namedCurve=a.name}var o=i.toSchema(),u=o.toBER(!1),s=new Uint8Array(u);return d.importKey("spki",s,r.algorithm,!0,r.usages)}),r=r.then(function(t){var r=(0,f.getAlgorithmParameters)(t.algorithm.name,"verify");"hash"in r.algorithm&&(r.algorithm.hash.name=v);var i=n.valueBlock.valueHex;if("ECDSA"===t.algorithm.name){var o=l.fromBER(i);i=(0,f.createECDSASignatureFromCMS)(o.result)}if("RSA-PSS"===t.algorithm.name){var u=void 0;try{u=new C.default({schema:e.signatureAlgorithm.algorithmParams})}catch(e){return Promise.reject(e)}"saltLength"in u?r.algorithm.saltLength=u.saltLength:r.algorithm.saltLength=20;var s="SHA-1";if("hashAlgorithm"in u){var c=(0,f.getAlgorithmByOID)(u.hashAlgorithm.algorithmId);if("name"in c==!1)return Promise.reject("Unrecognized hash algorithm: "+u.hashAlgorithm.algorithmId);s=c.name}r.algorithm.hash.name=s}return d.verify(r.algorithm,t,new Uint8Array(i),new Uint8Array(a))}))}}],[{key:"defaultValues",value:function(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 1;case"signature":return new m.default;case"issuer":return new v.default;case"thisUpdate":return new g.default;case"nextUpdate":return new g.default;case"revokedCertificates":return[];case"crlExtensions":return new k.default;case"signatureAlgorithm":return new m.default;case"signatureValue":return new l.BitString;default:throw new Error("Invalid member name for CertificateRevocationList class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"CertificateList",value:[o(e),m.default.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new l.BitString({name:t.signatureValue||"signatureValue"})]})}}]),e}();t.default=I},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);
}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(76),f=n(c),h=r(96),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.userCertificate=(0,l.getParametersValue)(t,"userCertificate",e.defaultValues("userCertificate")),this.revocationDate=(0,l.getParametersValue)(t,"revocationDate",e.defaultValues("revocationDate")),"crlEntryExtensions"in t&&(this.crlEntryExtensions=(0,l.getParametersValue)(t,"crlEntryExtensions",e.defaultValues("crlEntryExtensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for REV_CERT");this.userCertificate=r.result.userCertificate,this.revocationDate=new f.default({schema:r.result.revocationDate}),"crlEntryExtensions"in r.result&&(this.crlEntryExtensions=new m.default({schema:r.result.crlEntryExtensions}))}},{key:"toSchema",value:function(){var e=[this.userCertificate,this.revocationDate.toSchema()];return"crlEntryExtensions"in this&&e.push(this.crlEntryExtensions.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON};return"crlEntryExtensions"in this&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"userCertificate":return new s.Integer;case"revocationDate":return new f.default;case"crlEntryExtensions":return new m.default;default:throw new Error("Invalid member name for RevokedCertificate class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.userCertificate||"userCertificate"}),f.default.schema({names:{utcTimeName:t.revocationDate||"revocationDate",generalTimeName:t.revocationDate||"revocationDate"}}),m.default.schema({names:{blockName:t.crlEntryExtensions||"crlEntryExtensions"}},!0)]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.secretTypeId=(0,s.getParametersValue)(t,"secretTypeId",e.defaultValues("secretTypeId")),this.secretValue=(0,s.getParametersValue)(t,"secretValue",e.defaultValues("secretValue")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{id:"secretTypeId",value:"secretValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SecretBag");this.secretTypeId=r.result.secretTypeId.valueBlock.toString(),this.secretValue=r.result.secretValue}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.secretTypeId}),new u.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}},{key:"toJSON",value:function(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"secretTypeId":return"";case"secretValue":return new u.Any;default:throw new Error("Invalid member name for SecretBag class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"secretTypeId":return""===t;case"secretValue":return t instanceof u.Any;default:throw new Error("Invalid member name for SecretBag class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.id||"id"}),new u.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new u.Any({name:t.value||"value"})]})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(102),h=n(f),m=r(106),d=n(m),v=r(71),p=n(v),g=r(55),y=n(g),b=r(48),w=n(b),k=r(122),S=n(k),C=r(107),P=n(C),A=r(109),I=n(A),_=r(114),O=n(_),B=r(115),E=n(B),N=r(110),j=n(N),V=r(113),x=n(V),R=r(118),D=n(R),T=r(119),U=n(T),H=r(72),K=n(H),q=r(120),M=n(q),L=r(123),J=n(L),F=r(111),W=n(F),G=r(112),z=n(G),$=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),"originatorInfo"in t&&(this.originatorInfo=(0,l.getParametersValue)(t,"originatorInfo",e.defaultValues("originatorInfo"))),this.recipientInfos=(0,l.getParametersValue)(t,"recipientInfos",e.defaultValues("recipientInfos")),this.encryptedContentInfo=(0,l.getParametersValue)(t,"encryptedContentInfo",e.defaultValues("encryptedContentInfo")),"unprotectedAttrs"in t&&(this.unprotectedAttrs=(0,l.getParametersValue)(t,"unprotectedAttrs",e.defaultValues("unprotectedAttrs"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",originatorInfo:"originatorInfo",recipientInfos:"recipientInfos",encryptedContentInfo:{names:{blockName:"encryptedContentInfo"}},unprotectedAttrs:"unprotectedAttrs"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_ENVELOPED_DATA");this.version=r.result.version.valueBlock.valueDec,"originatorInfo"in r.result&&(r.result.originatorInfo.idBlock.tagClass=1,r.result.originatorInfo.idBlock.tagNumber=16,this.originatorInfo=new h.default({schema:r.result.originatorInfo})),this.recipientInfos=Array.from(r.result.recipientInfos,function(e){return new d.default({schema:e})}),this.encryptedContentInfo=new p.default({schema:r.result.encryptedContentInfo}),"unprotectedAttrs"in r.result&&(this.unprotectedAttrs=Array.from(r.result.unprotectedAttrs,function(e){return new y.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),"originatorInfo"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new s.Set({value:Array.from(this.recipientInfos,function(e){return e.toSchema()})})),e.push(this.encryptedContentInfo.toSchema()),"unprotectedAttrs"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={version:this.version};return"originatorInfo"in this&&(e.originatorInfo=this.originatorInfo.toJSON()),e.recipientInfos=Array.from(this.recipientInfos,function(e){return e.toJSON()}),e.encryptedContentInfo=this.encryptedContentInfo.toJSON(),"unprotectedAttrs"in this&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,function(e){return e.toJSON()})),e}},{key:"addRecipientByCertificate",value:function(e,t,r){var n=t||{};if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549")!==-1)r=1;else{if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045")===-1)throw new Error("Unknown type of certificate's public key: "+e.subjectPublicKeyInfo.algorithm.algorithmId);r=2}switch("oaepHashAlgorithm"in n==!1&&(n.oaepHashAlgorithm="SHA-512"),"kdfAlgorithm"in n==!1&&(n.kdfAlgorithm="SHA-512"),"kekEncryptionLength"in n==!1&&(n.kekEncryptionLength=256),r){case 1:var a=(0,c.getOIDByAlgorithm)({name:"RSA-OAEP"});if(""===a)throw new Error("Can not find OID for OAEP");var i=(0,c.getOIDByAlgorithm)({name:n.oaepHashAlgorithm});if(""===i)throw new Error("Unknown OAEP hash algorithm: "+n.oaepHashAlgorithm);var o=new w.default({algorithmId:i,algorithmParams:new s.Null}),u=new S.default({hashAlgorithm:o,maskGenAlgorithm:new w.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:o.toSchema()})}),l=new P.default({version:0,rid:new I.default({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new w.default({algorithmId:a,algorithmParams:u.toSchema()}),recipientCertificate:e});this.recipientInfos.push(new d.default({variant:1,value:l}));break;case 2:var f=new O.default({rid:new E.default({variant:1,value:new I.default({issuer:e.issuer,serialNumber:e.serialNumber})})}),h=(0,c.getOIDByAlgorithm)({name:"AES-KW",length:n.kekEncryptionLength});if(""===h)throw new Error("Unknown length for key encryption algorithm: "+n.kekEncryptionLength);var m=new w.default({algorithmId:h,algorithmParams:new s.Null}),v=(0,c.getOIDByAlgorithm)({name:"ECDH",kdf:n.kdfAlgorithm});if(""===v)throw new Error("Unknown KDF algorithm: "+n.kdfAlgorithm);var p=new ArrayBuffer(64),g=new Uint8Array(p);(0,c.getRandomValues)(g);var y=new j.default({version:3,ukm:new s.OctetString({valueHex:p}),keyEncryptionAlgorithm:new w.default({algorithmId:v,algorithmParams:m.toSchema()}),recipientEncryptedKeys:new x.default({encryptedKeys:[f]}),recipientCertificate:e});this.recipientInfos.push(new d.default({variant:2,value:y}));break;default:throw new Error('Unknown "variant" value: '+r)}return!0}},{key:"addRecipientByPreDefinedData",value:function(e,t,r){var n=t||{};if(e instanceof ArrayBuffer==!1)throw new Error('Please pass "preDefinedData" in ArrayBuffer type');if(0===e.byteLength)throw new Error("Pre-defined data could have zero length");if("keyIdentifier"in n==!1){var a=new ArrayBuffer(16),i=new Uint8Array(a);(0,c.getRandomValues)(i),n.keyIdentifier=a}switch("hmacHashAlgorithm"in n==!1&&(n.hmacHashAlgorithm="SHA-512"),"iterationCount"in n==!1&&(n.iterationCount=2048),"keyEncryptionAlgorithm"in n==!1&&(n.keyEncryptionAlgorithm={name:"AES-KW",length:256}),"keyEncryptionAlgorithmParams"in n==!1&&(n.keyEncryptionAlgorithmParams=new s.Null),r){case 1:var o=(0,c.getOIDByAlgorithm)(n.keyEncryptionAlgorithm);if(""===o)throw new Error('Incorrect value for "keyEncryptionAlgorithm"');var u=new D.default({version:4,kekid:new U.default({keyIdentifier:new s.OctetString({valueHex:n.keyIdentifier})}),keyEncryptionAlgorithm:new w.default({algorithmId:o,algorithmParams:n.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new d.default({variant:3,value:u}));break;case 2:var l=(0,c.getOIDByAlgorithm)({name:"PBKDF2"});if(""===l)throw new Error("Can not find OID for PBKDF2");var f=new ArrayBuffer(64),h=new Uint8Array(f);(0,c.getRandomValues)(h);var m=(0,c.getOIDByAlgorithm)({name:"HMAC",hash:{name:n.hmacHashAlgorithm}});if(""===m)throw new Error('Incorrect value for "hmacHashAlgorithm": '+n.hmacHashAlgorithm);var v=new K.default({salt:new s.OctetString({valueHex:f}),iterationCount:n.iterationCount,prf:new w.default({algorithmId:m,algorithmParams:new s.Null})}),p=(0,c.getOIDByAlgorithm)(n.keyEncryptionAlgorithm);if(""===p)throw new Error('Incorrect value for "keyEncryptionAlgorithm"');var g=new M.default({version:0,keyDerivationAlgorithm:new w.default({algorithmId:l,algorithmParams:v.toSchema()}),keyEncryptionAlgorithm:new w.default({algorithmId:p,algorithmParams:n.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new d.default({variant:4,value:g}));break;default:throw new Error('Unknown value for "variant": '+r)}}},{key:"encrypt",value:function(e,t){function r(e){var t=Promise.resolve(),r=void 0,n=void 0,a=void 0,i=void 0,o=void 0;return t=t.then(function(){var t=y.recipientInfos[e].value.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(t instanceof s.ObjectIdentifier==!1)return Promise.reject('Incorrect "recipientCertificate" for index '+e);var r=t.valueBlock.toString();switch(r){case"1.2.840.10045.3.1.7":a="P-256",i=256;break;case"1.3.132.0.34":a="P-384",i=384;break;case"1.3.132.0.35":a="P-521",i=528;break;default:return Promise.reject("Incorrect curve OID for index "+e)}return a},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"])},function(e){return Promise.reject(e)}),t=t.then(function(e){return r=e.publicKey,n=e.privateKey,k.exportKey("spki",r)},function(e){return Promise.reject(e)}),t=t.then(function(t){return o=t,y.recipientInfos[e].value.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:a},usages:[]}})},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.deriveBits({name:"ECDH",public:e},n,i)},function(e){return Promise.reject(e)}),t=t.then(function(t){var r=new w.default({schema:y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmParams}),n=(0,c.getAlgorithmByOID)(r.algorithmId);if("name"in n==!1)return Promise.reject("Incorrect OID for key encryption algorithm: "+r.algorithmId);for(var a=n.length,i=new ArrayBuffer(4),o=new Uint8Array(i),u=3;u>=0;u--)o[u]=a,a>>=8;var l=new J.default({keyInfo:new w.default({algorithmId:r.algorithmId,algorithmParams:new s.Null}),entityUInfo:y.recipientInfos[e].value.ukm,suppPubInfo:new s.OctetString({valueHex:i})}),f=l.toSchema().toBER(!1),h=(0,c.getAlgorithmByOID)(y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId);return"name"in h==!1?Promise.reject("Incorrect OID for key encryption algorithm: "+y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId):(0,c.kdf)(h.kdf,t,n.length,f)},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.importKey("raw",e,{name:"AES-KW"},!0,["wrapKey"])},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.wrapKey("raw",m,e,{name:"AES-KW"})},function(e){return Promise.reject(e)}),t=t.then(function(t){var r=s.fromBER(o),n=new W.default;n.variant=3,n.value=new z.default({schema:r.result}),"algorithmParams"in n.value.algorithm&&delete n.value.algorithm.algorithmParams,y.recipientInfos[e].value.originator=n,y.recipientInfos[e].value.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new s.OctetString({valueHex:t})},function(e){return Promise.reject(e)})}function n(e){var t=Promise.resolve();return t=t.then(function(){var t=y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmParams,r=new S.default({schema:t}),n=(0,c.getAlgorithmByOID)(r.hashAlgorithm.algorithmId);return"name"in n==!1?Promise.reject("Incorrect OID for hash algorithm: "+r.hashAlgorithm.algorithmId):y.recipientInfos[e].value.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"RSA-OAEP",hash:{name:n.name}},usages:["encrypt","wrapKey"]}})},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.encrypt(e.algorithm,e,v)},function(e){return Promise.reject(e)}),t=t.then(function(t){y.recipientInfos[e].value.encryptedKey=new s.OctetString({valueHex:t})},function(e){return Promise.reject(e)})}function a(e){var t=Promise.resolve(),r=void 0;return t=t.then(function(){return r=(0,c.getAlgorithmByOID)(y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId),"name"in r==!1?Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId):k.importKey("raw",new Uint8Array(y.recipientInfos[e].value.preDefinedKEK),r,!0,["wrapKey"])},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.wrapKey("raw",m,e,r)},function(e){return Promise.reject(e)}),t=t.then(function(t){y.recipientInfos[e].value.encryptedKey=new s.OctetString({valueHex:t})},function(e){return Promise.reject(e)})}function i(e){var t=Promise.resolve(),r=void 0,n=void 0;return t=t.then(function(){if("keyDerivationAlgorithm"in y.recipientInfos[e].value==!1)return Promise.reject('Please append encoded "keyDerivationAlgorithm"');if("algorithmParams"in y.recipientInfos[e].value.keyDerivationAlgorithm==!1)return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"');try{r=new K.default({schema:y.recipientInfos[e].value.keyDerivationAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"')}return Promise.resolve()},function(e){return Promise.reject(e)}),t=t.then(function(){var t=new Uint8Array(y.recipientInfos[e].value.password);return k.importKey("raw",t,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),t=t.then(function(t){if(n=(0,c.getAlgorithmByOID)(y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId),"name"in n==!1)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+y.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId);var a="SHA-1";if("prf"in r){var i=(0,c.getAlgorithmByOID)(r.prf.algorithmId);if("name"in i==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");a=i.hash.name}var o=new Uint8Array(r.salt.valueBlock.valueHex),u=r.iterationCount;return k.deriveKey({name:"PBKDF2",hash:{name:a},salt:o,iterations:u},t,n,!0,["wrapKey"])},function(e){return Promise.reject(e)}),t=t.then(function(e){return k.wrapKey("raw",m,e,n)},function(e){return Promise.reject(e)}),t=t.then(function(t){y.recipientInfos[e].value.encryptedKey=new s.OctetString({valueHex:t})},function(e){return Promise.reject(e)})}var o=this,u=Promise.resolve(),l=new ArrayBuffer(16),f=new Uint8Array(l);(0,c.getRandomValues)(f);var h=new Uint8Array(t),m=void 0,d=void 0,v=void 0,g=[],y=this,b=(0,c.getOIDByAlgorithm)(e);if(""===b)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');var k=(0,c.getCrypto)();return"undefined"==typeof k?Promise.reject("Unable to create WebCrypto object"):(u=u.then(function(){return k.generateKey(e,!0,["encrypt"])}),u=u.then(function(t){return m=t,k.encrypt({name:e.name,iv:f},m,h)},function(e){return Promise.reject(e)}),u=u.then(function(e){return d=e,k.exportKey("raw",m)},function(e){return Promise.reject(e)}).then(function(e){return v=e,!0},function(e){return Promise.reject(e)}),u=u.then(function(){o.version=2,o.encryptedContentInfo=new p.default({contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new w.default({algorithmId:b,algorithmParams:new s.OctetString({valueHex:l})}),encryptedContent:new s.OctetString({valueHex:d})})},function(e){return Promise.reject(e)}),u=u.then(function(){for(var e=0;e<o.recipientInfos.length;e++){var t=Promise.resolve();switch(o.recipientInfos[e].variant){case 1:t=n(e);break;case 2:t=r(e);break;case 3:t=a(e);break;case 4:t=i(e);break;default:return Promise.reject("Uknown recipient type in array with index "+e)}g.push(t)}return Promise.all(g)},function(e){return Promise.reject(e)}))}},{key:"decrypt",value:function(e,t){function r(e){var t=Promise.resolve(),r=void 0,n=void 0,a=void 0,i=void 0;return t=t.then(function(){if("recipientCertificate"in f==!1)return Promise.reject('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo"');if("recipientPrivateKey"in f==!1)return Promise.reject('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');var t=f.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(t instanceof s.ObjectIdentifier==!1)return Promise.reject('Incorrect "recipientCertificate" for index '+e);switch(a=t.valueBlock.toString()){case"1.2.840.10045.3.1.7":r="P-256",n=256;break;case"1.3.132.0.34":r="P-384",n=384;break;case"1.3.132.0.35":r="P-521",n=528;break;default:return Promise.reject("Incorrect curve OID for index "+e)}return m.importKey("pkcs8",f.recipientPrivateKey,{name:"ECDH",namedCurve:r},!0,["deriveBits"])},function(e){return Promise.reject(e)}),t=t.then(function(t){i=t,"algorithmParams"in h.recipientInfos[e].value.originator.value.algorithm==!1&&(h.recipientInfos[e].value.originator.value.algorithm.algorithmParams=new s.ObjectIdentifier({value:a}));var n=h.recipientInfos[e].value.originator.value.toSchema().toBER(!1);return m.importKey("spki",n,{name:"ECDH",namedCurve:r},!0,[])},function(e){return Promise.reject(e)}),t=t.then(function(e){return m.deriveBits({name:"ECDH",public:e},i,n)},function(e){return Promise.reject(e)}),t=t.then(function(t){var r=new w.default({schema:h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmParams}),n=(0,c.getAlgorithmByOID)(r.algorithmId);if("name"in n==!1)return Promise.reject("Incorrect OID for key encryption algorithm: "+r.algorithmId);for(var a=n.length,i=new ArrayBuffer(4),o=new Uint8Array(i),u=3;u>=0;u--)o[u]=a,a>>=8;var l=new J.default({keyInfo:new w.default({algorithmId:r.algorithmId,algorithmParams:new s.Null}),entityUInfo:h.recipientInfos[e].value.ukm,suppPubInfo:new s.OctetString({valueHex:i})}),f=l.toSchema().toBER(!1),m=(0,c.getAlgorithmByOID)(h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId);return"name"in m==!1?Promise.reject("Incorrect OID for key encryption algorithm: "+h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId):(0,c.kdf)(m.kdf,t,n.length,f)},function(e){return Promise.reject(e)}),t=t.then(function(e){return m.importKey("raw",e,{name:"AES-KW"},!0,["unwrapKey"])},function(e){return Promise.reject(e)}),t=t.then(function(t){var r=(0,c.getAlgorithmByOID)(h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return"name"in r==!1?Promise.reject('Incorrect "contentEncryptionAlgorithm": '+h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId):m.unwrapKey("raw",h.recipientInfos[e].value.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHex,t,{name:"AES-KW"},r,!0,["decrypt"])},function(e){return Promise.reject(e)})}function n(e){var t=Promise.resolve();return t=t.then(function(){if("recipientPrivateKey"in f==!1)return Promise.reject('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');var t=h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmParams,r=new S.default({schema:t}),n=(0,c.getAlgorithmByOID)(r.hashAlgorithm.algorithmId);return"name"in n==!1?Promise.reject("Incorrect OID for hash algorithm: "+r.hashAlgorithm.algorithmId):m.importKey("pkcs8",f.recipientPrivateKey,{name:"RSA-OAEP",hash:{name:n.name}},!0,["decrypt"])},function(e){return Promise.reject(e)}),t=t.then(function(t){return m.decrypt(t.algorithm,t,h.recipientInfos[e].value.encryptedKey.valueBlock.valueHex)},function(e){return Promise.reject(e)}),t=t.then(function(e){var t=(0,c.getAlgorithmByOID)(h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return"name"in t==!1?Promise.reject('Incorrect "contentEncryptionAlgorithm": '+h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId):m.importKey("raw",e,t,!0,["decrypt"])},function(e){return Promise.reject(e)})}function a(e){var t=Promise.resolve(),r=void 0;return t=t.then(function(){return"preDefinedData"in f==!1?Promise.reject('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"'):(r=(0,c.getAlgorithmByOID)(h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId),"name"in r==!1?Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId):m.importKey("raw",f.preDefinedData,r,!0,["unwrapKey"]))},function(e){return Promise.reject(e)}),t=t.then(function(t){var n=(0,c.getAlgorithmByOID)(h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return"name"in n==!1?Promise.reject('Incorrect "contentEncryptionAlgorithm": '+h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId):m.unwrapKey("raw",h.recipientInfos[e].value.encryptedKey.valueBlock.valueHex,t,r,n,!0,["decrypt"])},function(e){return Promise.reject(e)})}function i(e){var t=Promise.resolve(),r=void 0,n=void 0;return t=t.then(function(){if("preDefinedData"in f==!1)return Promise.reject('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if("keyDerivationAlgorithm"in h.recipientInfos[e].value==!1)return Promise.reject('Please append encoded "keyDerivationAlgorithm"');if("algorithmParams"in h.recipientInfos[e].value.keyDerivationAlgorithm==!1)return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"');try{r=new K.default({schema:h.recipientInfos[e].value.keyDerivationAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "keyDerivationAlgorithm"')}return m.importKey("raw",f.preDefinedData,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),t=t.then(function(t){if(n=(0,c.getAlgorithmByOID)(h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId),"name"in n==!1)return Promise.reject('Incorrect OID for "keyEncryptionAlgorithm": '+h.recipientInfos[e].value.keyEncryptionAlgorithm.algorithmId);var a="SHA-1";if("prf"in r){var i=(0,c.getAlgorithmByOID)(r.prf.algorithmId);if("name"in i==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");a=i.hash.name}var o=new Uint8Array(r.salt.valueBlock.valueHex),u=r.iterationCount;return m.deriveKey({name:"PBKDF2",hash:{name:a},salt:o,iterations:u},t,n,!0,["unwrapKey"])},function(e){return Promise.reject(e)}),t=t.then(function(t){var r=(0,c.getAlgorithmByOID)(h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);return"name"in r==!1?Promise.reject('Incorrect "contentEncryptionAlgorithm": '+h.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId):m.unwrapKey("raw",h.recipientInfos[e].value.encryptedKey.valueBlock.valueHex,t,n,r,!0,["decrypt"])},function(e){return Promise.reject(e)})}var o=this,u=Promise.resolve(),f=t||{},h=this;if(e+1>this.recipientInfos.length)return Promise.reject('Maximum value for "index" is: '+(this.recipientInfos.length-1));var m=(0,c.getCrypto)();return"undefined"==typeof m?Promise.reject("Unable to create WebCrypto object"):(u=u.then(function(){var t=Promise.resolve();switch(o.recipientInfos[e].variant){case 1:t=n(e);break;case 2:t=r(e);break;case 3:t=a(e);break;case 4:t=i(e);break;default:return Promise.reject("Uknown recipient type in array with index "+e)}return t},function(e){return Promise.reject(e)}),u=u.then(function(e){var t=(0,c.getAlgorithmByOID)(o.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);if("name"in t==!1)return Promise.reject('Incorrect "contentEncryptionAlgorithm": '+o.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId);var r=o.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex,n=new Uint8Array(r),a=new ArrayBuffer(0);if(o.encryptedContentInfo.encryptedContent.idBlock.isConstructed===!1)a=o.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else{var i=!0,u=!1,s=void 0;try{for(var f,h=o.encryptedContentInfo.encryptedContent.valueBlock.value[Symbol.iterator]();!(i=(f=h.next()).done);i=!0){var d=f.value;a=(0,l.utilConcatBuf)(a,d.valueBlock.valueHex)}}catch(e){u=!0,s=e}finally{try{!i&&h.return&&h.return()}finally{if(u)throw s}}}return m.decrypt({name:t.name,iv:n},e,a)},function(e){return Promise.reject(e)}))}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"originatorInfo":return new h.default;case"recipientInfos":return[];case"encryptedContentInfo":return new p.default;case"unprotectedAttrs":return[];default:throw new Error("Invalid member name for EnvelopedData class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===e.defaultValues(t);case"originatorInfo":return 0===r.certs.certificates.length&&0===r.crls.crls.length;case"recipientInfos":case"unprotectedAttrs":return 0===r.length;case"encryptedContentInfo":return p.default.compareWithDefault("contentType",r.contentType)&&p.default.compareWithDefault("contentEncryptionAlgorithm",r.contentEncryptionAlgorithm)&&p.default.compareWithDefault("encryptedContent",r.encryptedContent);default:throw new Error("Invalid member name for EnvelopedData class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.Constructed({name:t.originatorInfo||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:h.default.schema().valueBlock.value}),new s.Set({value:[new s.Repeated({name:t.recipientInfos||"",value:d.default.schema()})]}),p.default.schema(t.encryptedContentInfo||{}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.unprotectedAttrs||"",value:y.default.schema()})]})]})}}]),e}();t.default=$},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(103),f=n(c),h=r(104),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.certs=(0,l.getParametersValue)(t,"certs",e.defaultValues("certs")),this.crls=(0,l.getParametersValue)(t,"crls",e.defaultValues("crls")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{certs:"certs",crls:"crls"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OriginatorInfo");r.result.certs.idBlock.tagClass=1,r.result.certs.idBlock.tagNumber=17,this.certs=new f.default({schema:r.result.certs}),r.result.crls.idBlock.tagClass=1,r.result.crls.idBlock.tagNumber=17,this.crls=new m.default({schema:r.result.crls})}},{key:"toSchema",value:function(){return new s.Sequence({value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})]})}},{key:"toJSON",value:function(){return{certs:this.certs.toJSON(),crls:this.crls.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"certs":return new f.default;case"crls":return new m.default;default:throw new Error("Invalid member name for OriginatorInfo class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"certs":return 0===t.certificates.length;case"crls":return 0===t.crls.length&&0===t.otherRevocationInfos.length;default:throw new Error("Invalid member name for OriginatorInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({name:t.certs||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:f.default.schema().valueBlock.value}),new s.Constructed({name:t.crls||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:m.default.schema().valueBlock.value})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(75),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.certificates=(0,l.getParametersValue)(t,"certificates",e.defaultValues("certificates")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_CERTIFICATE_SET");this.certificates=Array.from(r.result.certificates,function(e){return 1===e.idBlock.tagClass?new f.default({schema:e}):e})}},{key:"toSchema",value:function(){return new s.Set({value:Array.from(this.certificates,function(e){return e instanceof f.default?e.toSchema():e})})}},{key:"toJSON",value:function(){return{certificates:Array.from(this.certificates,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"certificates":return[];default:throw new Error("Invalid member name for Attribute class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Set({name:t.blockName||"",value:[new s.Repeated({name:t.certificates||"",value:new s.Choice({value:[f.default.schema(),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new s.Any]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new s.Any]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:3},value:[new s.ObjectIdentifier,new s.Any]})]})})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(98),h=n(f),m=r(105),d=n(m),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.crls=(0,c.getParametersValue)(t,"crls",e.defaultValues("crls")),this.otherRevocationInfos=(0,c.getParametersValue)(t,"otherRevocationInfos",e.defaultValues("otherRevocationInfos")),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema({names:{crls:"crls"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CSM_REVOCATION_INFO_CHOICES");var n=!0,a=!1,i=void 0;try{for(var o,u=r.result.crls[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;1===s.idBlock.tagClass?this.crls.push(new h.default({schema:s})):this.otherRevocationInfos.push(new d.default({schema:s}))}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}}},{key:"toSchema",value:function(){var e=[];return e.push.apply(e,i(Array.from(this.crls,function(e){return e.toSchema()}))),e.push.apply(e,i(Array.from(this.otherRevocationInfos,function(e){var t=e.toSchema();return t.idBlock.tagClass=3,t.idBlock.tagNumber=1,t}))),new l.Set({value:e})}},{key:"toJSON",value:function(){return{crls:Array.from(this.crls,function(e){return e.toJSON()}),otherRevocationInfos:Array.from(this.otherRevocationInfos,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"crls":return[];case"otherRevocationInfos":return[];default:throw new Error("Invalid member name for RevocationInfoChoices class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Set({name:t.blockName||"",value:[new l.Repeated({name:t.crls||"",value:new l.Choice({value:[h.default.schema(),new l.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[new l.ObjectIdentifier,new l.Any]})]})})]})}}]),e}();t.default=v},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.otherRevInfoFormat=(0,s.getParametersValue)(t,"otherRevInfoFormat",e.defaultValues("otherRevInfoFormat")),this.otherRevInfo=(0,s.getParametersValue)(t,"otherRevInfo",e.defaultValues("otherRevInfo")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OtherRevocationInfoFormat");this.otherRevInfoFormat=r.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=r.result.otherRevInfo}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.otherRevInfoFormat}),this.otherRevInfo]})}},{key:"toJSON",value:function(){var e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof u.Any||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"otherRevInfoFormat":return"";case"otherRevInfo":return new u.Any;default:throw new Error("Invalid member name for OtherRevocationInfoFormat class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.otherRevInfoFormat||"otherRevInfoFormat"}),new u.Any({name:t.otherRevInfo||"otherRevInfo"})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(107),f=n(c),h=r(110),m=n(h),d=r(118),v=n(d),p=r(120),g=n(p),y=r(121),b=n(y),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.variant=(0,l.getParametersValue)(t,"variant",e.defaultValues("variant")),"value"in t&&(this.value=(0,l.getParametersValue)(t,"value",e.defaultValues("value"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{blockName:"blockName"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_RECIPIENT_INFO");if(1===r.result.blockName.idBlock.tagClass)this.variant=1,this.value=new f.default({schema:r.result.blockName});else{var n=r.result.blockName.idBlock.tagNumber;switch(r.result.blockName.idBlock.tagClass=1,r.result.blockName.idBlock.tagNumber=16,n){case 1:this.variant=2,this.value=new m.default({schema:r.result.blockName});break;case 2:this.variant=3,this.value=new v.default({schema:r.result.blockName});break;case 3:this.variant=4,this.value=new g.default({schema:r.result.blockName});break;case 4:this.variant=5,this.value=new b.default({schema:r.result.blockName});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}},{key:"toSchema",value:function(){var e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new s.Any}}},{key:"toJSON",value:function(){var e={variant:this.variant};return this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for RecipientInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"variant":return r===e.defaultValues(t);case"value":return 0===Object.keys(r).length;default:throw new Error("Invalid member name for RecipientInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Choice({value:[f.default.schema({names:{blockName:t.blockName||""}}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1},value:m.default.schema().valueBlock.value}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2},value:v.default.schema().valueBlock.value}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:3},value:g.default.schema().valueBlock.value}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:4},value:b.default.schema().valueBlock.value})]})}}]),e}();t.default=w},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=r(75),m=n(h),d=r(108),v=n(d),p=r(109),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.rid=(0,l.getParametersValue)(t,"rid",e.defaultValues("rid")),this.keyEncryptionAlgorithm=(0,l.getParametersValue)(t,"keyEncryptionAlgorithm",e.defaultValues("keyEncryptionAlgorithm")),this.encryptedKey=(0,l.getParametersValue)(t,"encryptedKey",e.defaultValues("encryptedKey")),this.recipientCertificate=(0,l.getParametersValue)(t,"recipientCertificate",e.defaultValues("recipientCertificate")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",rid:{names:{blockName:"rid"}},keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for KeyTransRecipientInfo");this.version=r.result.version.valueBlock.valueDec,3===r.result.rid.idBlock.tagClass?this.rid=r.result.rid.valueBlock.value[0]:this.rid=new g.default({schema:r.result.rid}),this.keyEncryptionAlgorithm=new f.default({schema:r.result.keyEncryptionAlgorithm}),this.encryptedKey=r.result.encryptedKey}},{key:"toSchema",value:function(){var e=[];return this.rid instanceof g.default?(this.version=0,e.push(new s.Integer({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new s.Integer({value:this.version})),e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.rid]}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new s.Sequence({value:e})}},{key:"toJSON",value:function(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return-1;case"rid":return{};case"keyEncryptionAlgorithm":return new f.default;case"encryptedKey":return new s.OctetString;case"recipientCertificate":return new m.default;default:throw new Error("Invalid member name for KeyTransRecipientInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===e.defaultValues("version");case"rid":return 0===Object.keys(r).length;case"keyEncryptionAlgorithm":case"encryptedKey":return r.isEqual(e.defaultValues(t));case"recipientCertificate":return!1;default:throw new Error("Invalid member name for KeyTransRecipientInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),v.default.schema(t.rid||{}),f.default.schema(t.keyEncryptionAlgorithm||{}),new s.OctetString({name:t.encryptedKey||""})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(109),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.variant=(0,l.getParametersValue)(t,"variant",e.defaultValues("variant")),"value"in t&&(this.value=(0,l.getParametersValue)(t,"value",e.defaultValues("value"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{blockName:"blockName"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RecipientIdentifier");1===r.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new f.default({schema:r.result.blockName})):(this.variant=2,this.value=r.result.blockName.valueBlock.value[0])}},{key:"toSchema",value:function(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.value]});default:return new s.Any}}},{key:"toJSON",value:function(){var e={variant:this.variant};return 1!==this.variant&&2!==this.variant||(e.value=this.value.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for RecipientIdentifier class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"variant":return t===-1;case"values":return 0===Object.keys(t).length;default:throw new Error("Invalid member name for RecipientIdentifier class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Choice({value:[f.default.schema({names:{blockName:t.blockName||""}}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:0},value:[new s.OctetString]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(61),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.issuer=(0,l.getParametersValue)(t,"issuer",e.defaultValues("issuer")),this.serialNumber=(0,l.getParametersValue)(t,"serialNumber",e.defaultValues("serialNumber")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{issuer:{names:{blockName:"issuer"}},serialNumber:"serialNumber"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for IssuerAndSerialNumber");this.issuer=new f.default({schema:r.result.issuer}),this.serialNumber=r.result.serialNumber}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.issuer.toSchema(),this.serialNumber]})}},{key:"toJSON",value:function(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"issuer":return new f.default;case"serialNumber":return new s.Integer;default:throw new Error("Invalid member name for IssuerAndSerialNumber class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.issuer||{}),new s.Integer({name:t.serialNumber||""})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(111),f=n(c),h=r(48),m=n(h),d=r(113),v=n(d),p=r(75),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.originator=(0,l.getParametersValue)(t,"originator",e.defaultValues("originator")),"ukm"in t&&(this.ukm=(0,l.getParametersValue)(t,"ukm",e.defaultValues("ukm"))),this.keyEncryptionAlgorithm=(0,l.getParametersValue)(t,"keyEncryptionAlgorithm",e.defaultValues("keyEncryptionAlgorithm")),this.recipientEncryptedKeys=(0,l.getParametersValue)(t,"recipientEncryptedKeys",e.defaultValues("recipientEncryptedKeys")),this.recipientCertificate=(0,l.getParametersValue)(t,"recipientCertificate",e.defaultValues("recipientCertificate")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",originator:{names:{blockName:"originator"}},ukm:"ukm",keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},recipientEncryptedKeys:{names:{blockName:"recipientEncryptedKeys"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for KeyAgreeRecipientInfo");this.version=r.result.version.valueBlock.valueDec,this.originator=new f.default({schema:r.result.originator}),"ukm"in r.result&&(this.ukm=r.result.ukm),this.keyEncryptionAlgorithm=new m.default({schema:r.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new v.default({schema:r.result.recipientEncryptedKeys})}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),"ukm"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={version:this.version,originator:this.originator.toJSON()};return"ukm"in this&&(e.ukm=this.ukm.toJSON()),e.keyEncryptionAlgorithm=this.keyEncryptionAlgorithm.toJSON(),e.recipientEncryptedKeys=this.recipientEncryptedKeys.toJSON(),e}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"originator":return new f.default;case"ukm":return new s.OctetString;case"keyEncryptionAlgorithm":return new m.default;case"recipientEncryptedKeys":return new v.default;case"recipientCertificate":return new g.default;default:throw new Error("Invalid member name for KeyAgreeRecipientInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return 0===r;case"originator":return r.variant===-1&&"value"in r==!1;case"ukm":return r.isEqual(e.defaultValues("ukm"));case"keyEncryptionAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"recipientEncryptedKeys":return 0===r.encryptedKeys.length;case"recipientCertificate":return!1;default:throw new Error("Invalid member name for KeyAgreeRecipientInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[f.default.schema(t.originator||{})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.OctetString({name:t.ukm||""})]}),m.default.schema(t.keyEncryptionAlgorithm||{}),v.default.schema(t.recipientEncryptedKeys||{})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(109),f=n(c),h=r(112),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.variant=(0,l.getParametersValue)(t,"variant",e.defaultValues("variant")),"value"in t&&(this.value=(0,l.getParametersValue)(t,"value",e.defaultValues("value"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{blockName:"blockName"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OriginatorIdentifierOrKey");1===r.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new f.default({schema:r.result.blockName})):0===r.result.blockName.idBlock.tagNumber?(r.result.blockName.idBlock.tagClass=1,r.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=r.result.blockName):(r.result.blockName.idBlock.tagClass=1,r.result.blockName.idBlock.tagNumber=16,this.variant=3,this.value=new m.default({schema:r.result.blockName}))}},{key:"toSchema",value:function(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:var e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e;default:return new s.Any}}},{key:"toJSON",value:function(){var e={variant:this.variant};return 1!==this.variant&&2!==this.variant&&3!==this.variant||(e.value=this.value.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for OriginatorIdentifierOrKey class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"variant":return t===-1;case"value":return 0===Object.keys(t).length;default:throw new Error("Invalid member name for OriginatorIdentifierOrKey class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Choice({value:[f.default.schema({names:{blockName:t.blockName||""}}),new s.Primitive({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||""}),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||"",value:m.default.schema().valueBlock.value})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.algorithm=(0,l.getParametersValue)(t,"algorithm",e.defaultValues("algorithm")),this.publicKey=(0,l.getParametersValue)(t,"publicKey",e.defaultValues("publicKey")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{algorithm:{names:{blockName:"algorithm"}},publicKey:"publicKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OriginatorPublicKey");this.algorithm=new f.default({schema:r.result.algorithm}),this.publicKey=r.result.publicKey}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.algorithm.toSchema(),this.publicKey]})}},{key:"toJSON",value:function(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"algorithm":return new f.default;case"publicKey":return new s.BitString;default:throw new Error("Invalid member name for OriginatorPublicKey class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"algorithm":case"publicKey":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for OriginatorPublicKey class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.algorithm||{}),new s.BitString({name:t.publicKey||""})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(114),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.encryptedKeys=(0,l.getParametersValue)(t,"encryptedKeys",e.defaultValues("encryptedKeys")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{RecipientEncryptedKeys:"RecipientEncryptedKeys"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RecipientEncryptedKeys");this.encryptedKeys=Array.from(r.result.RecipientEncryptedKeys,function(e){return new f.default({schema:e})})}},{key:"toSchema",value:function(){return new s.Sequence({value:Array.from(this.encryptedKeys,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){return{encryptedKeys:Array.from(this.encryptedKeys,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"encryptedKeys":return[];default:throw new Error("Invalid member name for RecipientEncryptedKeys class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"encryptedKeys":return 0===t.length;default:throw new Error("Invalid member name for RecipientEncryptedKeys class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Repeated({name:t.RecipientEncryptedKeys||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(115),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.rid=(0,l.getParametersValue)(t,"rid",e.defaultValues("rid")),this.encryptedKey=(0,l.getParametersValue)(t,"encryptedKey",e.defaultValues("encryptedKey")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{rid:{names:{blockName:"rid"}},encryptedKey:"encryptedKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RecipientEncryptedKey");this.rid=new f.default({schema:r.result.rid}),this.encryptedKey=r.result.encryptedKey}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.rid.toSchema(),this.encryptedKey]})}},{key:"toJSON",value:function(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"rid":return new f.default;case"encryptedKey":return new s.OctetString;default:throw new Error("Invalid member name for RecipientEncryptedKey class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"rid":return r.variant===-1&&"value"in r==!1;case"encryptedKey":return r.isEqual(e.defaultValues("encryptedKey"));default:throw new Error("Invalid member name for RecipientEncryptedKey class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",
value:[f.default.schema(t.rid||{}),new s.OctetString({name:t.encryptedKey||""})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(109),f=n(c),h=r(116),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.variant=(0,l.getParametersValue)(t,"variant",e.defaultValues("variant")),this.value=(0,l.getParametersValue)(t,"value",e.defaultValues("value")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{blockName:"blockName"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for KeyAgreeRecipientIdentifier");1===r.result.blockName.idBlock.tagClass?(this.variant=1,this.value=new f.default({schema:r.result.blockName})):(this.variant=2,r.result.blockName.idBlock.tagClass=1,r.result.blockName.idBlock.tagNumber=16,this.value=new m.default({schema:r.result.blockName}))}},{key:"toSchema",value:function(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new s.Any}}},{key:"toJSON",value:function(){var e={variant:this.variant};return 1!==this.variant&&2!==this.variant||(e.value=this.value.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"variant":return-1;case"value":return{};default:throw new Error("Invalid member name for KeyAgreeRecipientIdentifier class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"variant":return t===-1;case"value":return 0===Object.keys(t).length;default:throw new Error("Invalid member name for KeyAgreeRecipientIdentifier class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Choice({value:[f.default.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||""}}),new s.Constructed({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:0},value:m.default.schema(t.rKeyId||{names:{blockName:t.blockName||""}}).valueBlock.value})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(117),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.subjectKeyIdentifier=(0,l.getParametersValue)(t,"subjectKeyIdentifier",e.defaultValues("subjectKeyIdentifier")),"date"in t&&(this.date=(0,l.getParametersValue)(t,"date",e.defaultValues("date"))),"other"in t&&(this.other=(0,l.getParametersValue)(t,"other",e.defaultValues("other"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{subjectKeyIdentifier:"subjectKeyIdentifier",date:"date",other:{names:{blockName:"other"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RecipientKeyIdentifier");this.subjectKeyIdentifier=r.result.subjectKeyIdentifier,"date"in r.result&&(this.date=r.result.date),"other"in r.result&&(this.other=new f.default({schema:r.result.other}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.subjectKeyIdentifier),"date"in this&&e.push(this.date),"other"in this&&e.push(this.other.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return"date"in this&&(e.date=this.date),"other"in this&&(e.other=this.other.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"subjectKeyIdentifier":return new s.OctetString;case"date":return new s.GeneralizedTime;case"other":return new f.default;default:throw new Error("Invalid member name for RecipientKeyIdentifier class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"subjectKeyIdentifier":return r.isEqual(e.defaultValues("subjectKeyIdentifier"));case"date":return 0===r.year&&0===r.month&&0===r.day&&0===r.hour&&0===r.minute&&0===r.second&&0===r.millisecond;case"other":return""===r.keyAttrId&&"keyAttr"in r==!1;default:throw new Error("Invalid member name for RecipientKeyIdentifier class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.OctetString({name:t.subjectKeyIdentifier||""}),new s.GeneralizedTime({optional:!0,name:t.date||""}),f.default.schema(t.other||{})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.keyAttrId=(0,s.getParametersValue)(t,"keyAttrId",e.defaultValues("keyAttrId")),"keyAttr"in t&&(this.keyAttr=(0,s.getParametersValue)(t,"keyAttr",e.defaultValues("keyAttr"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{keyAttrId:"keyAttrId",keyAttr:"keyAttr"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OtherKeyAttribute");this.keyAttrId=r.result.keyAttrId.valueBlock.toString(),"keyAttr"in r.result&&(this.keyAttr=r.result.keyAttr)}},{key:"toSchema",value:function(){var e=[];return e.push(new u.ObjectIdentifier({value:this.keyAttrId})),"keyAttr"in this&&e.push(this.keyAttr.toSchema()),new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={keyAttrId:this.keyAttrId};return"keyAttr"in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"keyAttrId":return"";case"keyAttr":return{};default:throw new Error("Invalid member name for OtherKeyAttribute class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"keyAttrId":return""===t;case"keyAttr":return 0===Object.keys(t).length;default:throw new Error("Invalid member name for OtherKeyAttribute class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({optional:t.optional||!0,name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.keyAttrId||""}),new u.Any({optional:!0,name:t.keyAttr||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(119),f=n(c),h=r(48),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.kekid=(0,l.getParametersValue)(t,"kekid",e.defaultValues("kekid")),this.keyEncryptionAlgorithm=(0,l.getParametersValue)(t,"keyEncryptionAlgorithm",e.defaultValues("keyEncryptionAlgorithm")),this.encryptedKey=(0,l.getParametersValue)(t,"encryptedKey",e.defaultValues("encryptedKey")),this.preDefinedKEK=(0,l.getParametersValue)(t,"preDefinedKEK",e.defaultValues("preDefinedKEK")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",kekid:{names:{blockName:"kekid"}},keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for KEKRecipientInfo");this.version=r.result.version.valueBlock.valueDec,this.kekid=new f.default({schema:r.result.kekid}),this.keyEncryptionAlgorithm=new m.default({schema:r.result.keyEncryptionAlgorithm}),this.encryptedKey=r.result.encryptedKey}},{key:"toSchema",value:function(){return new s.Sequence({value:[new s.Integer({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}},{key:"toJSON",value:function(){return{version:this.version,kekid:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"kekid":return new f.default;case"keyEncryptionAlgorithm":return new m.default;case"encryptedKey":return new s.OctetString;case"preDefinedKEK":return new ArrayBuffer(0);default:throw new Error("Invalid member name for KEKRecipientInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"KEKRecipientInfo":return r===e.defaultValues("version");case"kekid":return r.compareWithDefault("keyIdentifier",r.keyIdentifier)&&"date"in r==!1&&"other"in r==!1;case"keyEncryptionAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"encryptedKey":return r.isEqual(e.defaultValues("encryptedKey"));case"preDefinedKEK":return 0===r.byteLength;default:throw new Error("Invalid member name for KEKRecipientInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),f.default.schema(t.kekid||{}),m.default.schema(t.keyEncryptionAlgorithm||{}),new s.OctetString({name:t.encryptedKey||""})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(117),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.keyIdentifier=(0,l.getParametersValue)(t,"keyIdentifier",e.defaultValues("keyIdentifier")),"date"in t&&(this.date=(0,l.getParametersValue)(t,"date",e.defaultValues("date"))),"other"in t&&(this.other=(0,l.getParametersValue)(t,"other",e.defaultValues("other"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{keyIdentifier:"keyIdentifier",date:"date",other:{names:{blockName:"other"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for KEKIdentifier");this.keyIdentifier=r.result.keyIdentifier,"date"in r.result&&(this.date=r.result.date),"other"in r.result&&(this.other=new f.default({schema:r.result.other}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.keyIdentifier),"date"in this&&e.push(this.date),"other"in this&&e.push(this.other.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={keyIdentifier:this.keyIdentifier.toJSON()};return"date"in this&&(e.date=this.date),"other"in this&&(e.other=this.other.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"keyIdentifier":return new s.OctetString;case"date":return new s.GeneralizedTime;case"other":return new f.default;default:throw new Error("Invalid member name for KEKIdentifier class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"keyIdentifier":return r.isEqual(e.defaultValues("keyIdentifier"));case"date":return 0===r.year&&0===r.month&&0===r.day&&0===r.hour&&0===r.minute&&0===r.second&&0===r.millisecond;case"other":return r.compareWithDefault("keyAttrId",r.keyAttrId)&&"keyAttr"in r==!1;default:throw new Error("Invalid member name for KEKIdentifier class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.OctetString({name:t.keyIdentifier||""}),new s.GeneralizedTime({optional:!0,name:t.date||""}),f.default.schema(t.other||{})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),"keyDerivationAlgorithm"in t&&(this.keyDerivationAlgorithm=(0,l.getParametersValue)(t,"keyDerivationAlgorithm",e.defaultValues("keyDerivationAlgorithm"))),this.keyEncryptionAlgorithm=(0,l.getParametersValue)(t,"keyEncryptionAlgorithm",e.defaultValues("keyEncryptionAlgorithm")),this.encryptedKey=(0,l.getParametersValue)(t,"encryptedKey",e.defaultValues("encryptedKey")),this.password=(0,l.getParametersValue)(t,"password",e.defaultValues("password")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",keyDerivationAlgorithm:"keyDerivationAlgorithm",keyEncryptionAlgorithm:{names:{blockName:"keyEncryptionAlgorithm"}},encryptedKey:"encryptedKey"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PasswordRecipientinfo");this.version=r.result.version.valueBlock.valueDec,"keyDerivationAlgorithm"in r.result&&(r.result.keyDerivationAlgorithm.idBlock.tagClass=1,r.result.keyDerivationAlgorithm.idBlock.tagNumber=16,this.keyDerivationAlgorithm=new f.default({schema:r.result.keyDerivationAlgorithm})),this.keyEncryptionAlgorithm=new f.default({schema:r.result.keyEncryptionAlgorithm}),this.encryptedKey=r.result.encryptedKey}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),"keyDerivationAlgorithm"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new s.Sequence({value:e})}},{key:"toJSON",value:function(){return{version:this.version,keyDerivationAlgorithm:this.keyDerivationAlgorithm.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return-1;case"keyDerivationAlgorithm":return new f.default;case"keyEncryptionAlgorithm":return new f.default;case"encryptedKey":return new s.OctetString;case"password":return new ArrayBuffer(0);default:throw new Error("Invalid member name for PasswordRecipientinfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===-1;case"keyDerivationAlgorithm":case"keyEncryptionAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"encryptedKey":return r.isEqual(e.defaultValues("encryptedKey"));case"password":return 0===r.byteLength;default:throw new Error("Invalid member name for PasswordRecipientinfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||""}),new s.Constructed({name:t.keyDerivationAlgorithm||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:f.default.schema().valueBlock.value}),f.default.schema(t.keyEncryptionAlgorithm||{}),new s.OctetString({name:t.encryptedKey||""})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.oriType=(0,s.getParametersValue)(t,"oriType",e.defaultValues("oriType")),this.oriValue=(0,s.getParametersValue)(t,"oriValue",e.defaultValues("oriValue")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{oriType:"oriType",oriValue:"oriValue"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OtherRecipientInfo");this.oriType=r.result.oriType.valueBlock.toString(),this.oriValue=r.result.oriValue}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.oriType}),this.oriValue]})}},{key:"toJSON",value:function(){var t={oriType:this.oriType};return e.compareWithDefault("oriValue",this.oriValue)===!1&&(t.oriValue=this.oriValue.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"oriType":return"";case"oriValue":return{};default:throw new Error("Invalid member name for OtherRecipientInfo class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"oriType":return""===t;case"oriValue":return 0===Object.keys(t).length;default:throw new Error("Invalid member name for OtherRecipientInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.oriType||""}),new u.Any({name:t.oriValue||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.hashAlgorithm=(0,l.getParametersValue)(t,"hashAlgorithm",e.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=(0,l.getParametersValue)(t,"maskGenAlgorithm",e.defaultValues("maskGenAlgorithm")),this.pSourceAlgorithm=(0,l.getParametersValue)(t,"pSourceAlgorithm",e.defaultValues("pSourceAlgorithm")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},pSourceAlgorithm:{names:{blockName:"pSourceAlgorithm"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for RSAESOAEPParams");"hashAlgorithm"in r.result&&(this.hashAlgorithm=new f.default({schema:r.result.hashAlgorithm})),"maskGenAlgorithm"in r.result&&(this.maskGenAlgorithm=new f.default({schema:r.result.maskGenAlgorithm})),"pSourceAlgorithm"in r.result&&(this.pSourceAlgorithm=new f.default({schema:r.result.pSourceAlgorithm}))}},{key:"toSchema",value:function(){var t=[];return this.hashAlgorithm.isEqual(e.defaultValues("hashAlgorithm"))||t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(e.defaultValues("maskGenAlgorithm"))||t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(e.defaultValues("pSourceAlgorithm"))||t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={};return this.hashAlgorithm.isEqual(e.defaultValues("hashAlgorithm"))||(t.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(e.defaultValues("maskGenAlgorithm"))||(t.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(e.defaultValues("pSourceAlgorithm"))||(t.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"hashAlgorithm":return new f.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null});case"maskGenAlgorithm":return new f.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new f.default({algorithmId:"1.3.14.3.2.26",algorithmParams:new s.Null}).toSchema()});case"pSourceAlgorithm":return new f.default({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new s.OctetString({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:throw new Error("Invalid member name for RSAESOAEPParams class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Constructed({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[f.default.schema(t.hashAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[f.default.schema(t.maskGenAlgorithm||{})]}),new s.Constructed({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[f.default.schema(t.pSourceAlgorithm||{})]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.keyInfo=(0,l.getParametersValue)(t,"keyInfo",e.defaultValues("keyInfo")),"entityUInfo"in t&&(this.entityUInfo=(0,l.getParametersValue)(t,"entityUInfo",e.defaultValues("entityUInfo"))),this.suppPubInfo=(0,l.getParametersValue)(t,"suppPubInfo",e.defaultValues("suppPubInfo")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{keyInfo:{names:{blockName:"keyInfo"}},entityUInfo:"entityUInfo",suppPubInfo:"suppPubInfo"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ECC_CMS_SharedInfo");this.keyInfo=new f.default({schema:r.result.keyInfo}),"entityUInfo"in r.result&&(this.entityUInfo=r.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=r.result.suppPubInfo.valueBlock.value[0]}},{key:"toSchema",value:function(){var e=[];return e.push(this.keyInfo.toSchema()),"entityUInfo"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={keyInfo:this.keyInfo.toJSON()};return"entityUInfo"in this&&(e.entityUInfo=this.entityUInfo.toJSON()),e.suppPubInfo=this.suppPubInfo.toJSON(),e}}],[{key:"defaultValues",value:function(e){switch(e){case"keyInfo":return new f.default;case"entityUInfo":return new s.OctetString;case"suppPubInfo":return new s.OctetString;default:throw new Error("Invalid member name for ECCCMSSharedInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"keyInfo":case"entityUInfo":case"suppPubInfo":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for ECCCMSSharedInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.keyInfo||{}),new s.Constructed({name:t.entityUInfo||"",idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new s.OctetString]}),new s.Constructed({name:t.suppPubInfo||"",idBlock:{tagClass:3,tagNumber:2},value:[new s.OctetString]})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(47),h=r(125),m=n(h),d=r(48),v=n(d),p=r(75),g=n(p),y=r(127),b=n(y),w=r(49),k=n(w),S=r(61),C=n(S),P=r(128),A=n(P),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbsResponseData=(0,c.getParametersValue)(t,"tbsResponseData",e.defaultValues("tbsResponseData")),this.signatureAlgorithm=(0,c.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signature=(0,c.getParametersValue)(t,"signature",e.defaultValues("signature")),"certs"in t&&(this.certs=(0,c.getParametersValue)(t,"certs",e.defaultValues("certs"))),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OCSP_BASIC_RESPONSE");this.tbsResponseData=new m.default({schema:r.result["BasicOCSPResponse.tbsResponseData"]}),this.signatureAlgorithm=new v.default({schema:r.result["BasicOCSPResponse.signatureAlgorithm"]}),this.signature=r.result["BasicOCSPResponse.signature"],"BasicOCSPResponse.certs"in r.result&&(this.certs=Array.from(r.result["BasicOCSPResponse.certs"],function(e){return new g.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),"certs"in this&&e.push(new l.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new l.Sequence({value:Array.from(this.certs,function(e){return e.toSchema()})})]})),new l.Sequence({value:e})}},{key:"toJSON",value:function(){var e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return"certs"in this&&(e.certs=Array.from(this.certs,function(e){return e.toJSON()})),e}},{key:"getCertificateStatus",value:function(e,t){var r=this,n=Promise.resolve(),a={isForCertificate:!1,status:2},i={},o=[],u=[],s=!0,l=!1,c=void 0;try{for(var h,m=this.tbsResponseData.responses[Symbol.iterator]();!(s=(h=m.next()).done);s=!0){var d=h.value,v=(0,f.getAlgorithmByOID)(d.certID.hashAlgorithm.algorithmId);if("name"in v==!1)return Promise.reject("Wrong CertID hashing algorithm: "+d.certID.hashAlgorithm.algorithmId);if(v.name in i==!1){i[v.name]=1;var p=new b.default;o.push(p),u.push(p.createForCertificate(e,{hashAlgorithm:v.name,issuerCertificate:t}))}}}catch(e){l=!0,c=e}finally{try{!s&&m.return&&m.return()}finally{if(l)throw c}}return n=n.then(function(){return Promise.all(u)}),n=n.then(function(){var e=!0,t=!1,n=void 0;try{for(var i,u=r.tbsResponseData.responses[Symbol.iterator]();!(e=(i=u.next()).done);e=!0){var s=i.value,l=!0,c=!1,f=void 0;try{for(var h,m=o[Symbol.iterator]();!(l=(h=m.next()).done);l=!0){var d=h.value;if(s.certID.isEqual(d)){a.isForCertificate=!0;try{switch(s.certStatus.idBlock.isConstructed){case!0:1===s.certStatus.idBlock.tagNumber&&(a.status=1);break;case!1:switch(s.certStatus.idBlock.tagNumber){case 0:a.status=0;break;case 2:a.status=2}}}catch(e){}return a}}}catch(e){c=!0,f=e}finally{try{!l&&m.return&&m.return()}finally{if(c)throw f}}}}catch(e){t=!0,n=e}finally{try{!e&&u.return&&u.return()}finally{if(t)throw n}}return a})}},{key:"sign",value:function(e,t){var r=this;if("undefined"==typeof e)return Promise.reject("Need to provide a private key for signing");if("undefined"==typeof t)t="SHA-1";else{var n=(0,f.getOIDByAlgorithm)({name:t});if(""===n)return Promise.reject("Unsupported hash algorithm: "+t)}var a=(0,f.getAlgorithmParameters)(e.algorithm.name,"sign");
switch(a.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signatureAlgorithm.algorithmId=(0,f.getOIDByAlgorithm)(a.algorithm);break;case"RSA-PSS":switch(t.toUpperCase()){case"SHA-256":a.algorithm.saltLength=32;break;case"SHA-384":a.algorithm.saltLength=48;break;case"SHA-512":a.algorithm.saltLength=64}var i={};if("SHA-1"!==t.toUpperCase()){var o=(0,f.getOIDByAlgorithm)({name:t});if(""===o)return Promise.reject("Unsupported hash algorithm: "+t);i.hashAlgorithm=new v.default({algorithmId:o,algorithmParams:new l.Null}),i.maskGenAlgorithm=new v.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}20!==a.algorithm.saltLength&&(i.saltLength=a.algorithm.saltLength);var u=new k.default(i);this.signatureAlgorithm=new v.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:u.toSchema()});break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}this.tbsResponseData.tbs=this.tbsResponseData.toSchema(!0).toBER(!1);var s=(0,f.getCrypto)();return"undefined"==typeof s?Promise.reject("Unable to create WebCrypto object"):s.sign(a.algorithm,e,new Uint8Array(this.tbsResponseData.tbs)).then(function(e){"ECDSA"===a.algorithm.name&&(e=(0,f.createCMSECDSASignature)(e)),r.signature=new l.BitString({valueHex:e})},function(e){return Promise.reject("Signing error: "+e)})}},{key:"verify",value:function(){function e(e){if(e.issuer.isEqual(n.issuer)===!0&&e.serialNumber.isEqual(n.serialNumber)===!0)return null;var t=!1,r=!0,a=!1,i=void 0;try{for(var o,u=e.extensions[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;"2.5.29.19"===s.extnID&&"cA"in s.parsedValue&&s.parsedValue.cA===!0&&(t=!0)}}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return t?e:null}var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("certs"in this==!1)return Promise.reject("No certificates attached to the BasicOCSPResponce");var n=null,a=new Uint8Array(this.tbsResponseData.tbs),i=-1,u=Promise.resolve(),s="",h=[];"trustedCerts"in r&&(h=r.trustedCerts);var m=(0,f.getCrypto)();if("undefined"==typeof m)return Promise.reject("Unable to create WebCrypto object");if(s=(0,f.getHashAlgorithm)(this.signatureAlgorithm),""===s)return Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId);var d=0,v={};if(this.tbsResponseData.responderID instanceof C.default)d=0,v=this.tbsResponseData.responderID;else{if(!(this.tbsResponseData.responderID instanceof l.OctetString))return Promise.reject("Wrong value for responderID");d=1,v=this.tbsResponseData.responderID}return u=0===d?u.then(function(){var e=!0,r=!1,n=void 0;try{for(var a,u=t.certs.entries()[Symbol.iterator]();!(e=(a=u.next()).done);e=!0){var s=o(a.value,2),l=s[0],c=s[1];if(c.subject.isEqual(v)){i=l;break}}}catch(e){r=!0,n=e}finally{try{!e&&u.return&&u.return()}finally{if(r)throw n}}}):u.then(function(){return Promise.all(Array.from(t.certs,function(e){return m.digest({name:"sha-1"},new Uint8Array(e.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))})).then(function(e){var r=!0,n=!1,a=void 0;try{for(var u,s=t.certs.entries()[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=o(u.value,2),f=l[0];l[1];if((0,c.isEqualBuffer)(e[f],v.valueBlock.valueHex)){i=f;break}}}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}})}),u=u.then(function(){return i===-1?Promise.reject("Correct certificate was not found in OCSP response"):(n=t.certs[i],Promise.all(Array.from(t.certs,function(t){return e(t)})).then(function(e){var t=[];t.push(n);var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!==s&&t.push(s)}}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}var l=new A.default({certs:t,trustedCerts:h});return l.verify().then(function(e){return e.result===!0?Promise.resolve():Promise.reject("Validation of signer's certificate failed")},function(e){return Promise.reject("Validation of signer's certificate failed with error: "+(e instanceof Object?e.resultMessage:e))})},function(e){return Promise.reject("Error during checking certificates for CA flag: "+e)}))}),u=u.then(function(){var e=void 0;e="1.2.840.113549.1.1.10"===t.certs[i].signatureAlgorithm.algorithmId?t.certs[i].signatureAlgorithm.algorithmId:t.certs[i].subjectPublicKeyInfo.algorithm.algorithmId;var r=(0,f.getAlgorithmByOID)(e);if("name"in r==!1)return Promise.reject("Unsupported public key algorithm: "+e);var n=r.name,a=(0,f.getAlgorithmParameters)(n,"importkey");if("hash"in a.algorithm&&(a.algorithm.hash.name=s),"ECDSA"===n){if(t.certs[i].subjectPublicKeyInfo.algorithm.algorithmParams instanceof l.ObjectIdentifier==!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var o=(0,f.getAlgorithmByOID)(t.certs[i].subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());if("name"in o==!1)return Promise.reject("Unsupported named curve algorithm: "+t.certs[i].subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());a.algorithm.namedCurve=o.name}var u=t.certs[i].subjectPublicKeyInfo.toSchema(),c=u.toBER(!1),h=new Uint8Array(c);return m.importKey("spki",h,a.algorithm,!0,a.usages)}),u=u.then(function(e){var r=(0,f.getAlgorithmParameters)(e.algorithm.name,"verify");"hash"in r.algorithm&&(r.algorithm.hash.name=s);var n=t.signature.valueBlock.valueHex;if("ECDSA"===e.algorithm.name){var i=l.fromBER(n);n=(0,f.createECDSASignatureFromCMS)(i.result)}if("RSA-PSS"===e.algorithm.name){var o=void 0;try{o=new k.default({schema:t.signatureAlgorithm.algorithmParams})}catch(e){return Promise.reject(e)}"saltLength"in o?r.algorithm.saltLength=o.saltLength:r.algorithm.saltLength=20;var u="SHA-1";if("hashAlgorithm"in o){var c=(0,f.getAlgorithmByOID)(o.hashAlgorithm.algorithmId);if("name"in c==!1)return Promise.reject("Unrecognized hash algorithm: "+o.hashAlgorithm.algorithmId);u=c.name}r.algorithm.hash.name=u}return m.verify(r.algorithm,e,new Uint8Array(n),a)})}}],[{key:"defaultValues",value:function(e){switch(e){case"tbsResponseData":return new m.default;case"signatureAlgorithm":return new v.default;case"signature":return new l.BitString;case"certs":return[];default:throw new Error("Invalid member name for BasicOCSPResponse class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"type":var n=m.default.compareWithDefault("tbs",r.tbs)&&m.default.compareWithDefault("responderID",r.responderID)&&m.default.compareWithDefault("producedAt",r.producedAt)&&m.default.compareWithDefault("responses",r.responses);return"responseExtensions"in r&&(n=n&&m.default.compareWithDefault("responseExtensions",r.responseExtensions)),n;case"signatureAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"signature":return r.isEqual(e.defaultValues(t));case"certs":return 0===r.length;default:throw new Error("Invalid member name for BasicOCSPResponse class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.blockName||"BasicOCSPResponse",value:[m.default.schema(t.tbsResponseData||{names:{blockName:"BasicOCSPResponse.tbsResponseData"}}),v.default.schema(t.signatureAlgorithm||{names:{blockName:"BasicOCSPResponse.signatureAlgorithm"}}),new l.BitString({name:t.signature||"BasicOCSPResponse.signature"}),new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new l.Sequence({value:[new l.Repeated({name:"BasicOCSPResponse.certs",value:g.default.schema(t.certs||{})})]})]})]})}}]),e}();t.default=I},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(61),f=n(c),h=r(126),m=n(h),d=r(77),v=n(d),p=r(96),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbs=(0,l.getParametersValue)(t,"tbs",e.defaultValues("tbs")),this.responderID=(0,l.getParametersValue)(t,"responderID",e.defaultValues("responderID")),this.producedAt=(0,l.getParametersValue)(t,"producedAt",e.defaultValues("producedAt")),this.responses=(0,l.getParametersValue)(t,"responses",e.defaultValues("responses")),"responseExtensions"in t&&(this.responseExtensions=(0,l.getParametersValue)(t,"responseExtensions",e.defaultValues("responseExtensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ocsp.ResponseData");this.tbs=r.result.ResponseData.valueBeforeDecode,"ResponseData.version"in r.result&&(this.version=r.result["ResponseData.version"].valueBlock.valueDec),1===r.result["ResponseData.responderID"].idBlock.tagNumber?this.responderID=new f.default({schema:r.result["ResponseData.responderID"].valueBlock.value[0]}):this.responderID=r.result["ResponseData.responderID"].valueBlock.value[0],this.producedAt=r.result["ResponseData.producedAt"].toDate(),this.responses=Array.from(r.result["ResponseData.responses"],function(e){return new m.default({schema:e})}),"ResponseData.responseExtensions"in r.result&&(this.responseExtensions=Array.from(r.result["ResponseData.responseExtensions"].valueBlock.value,function(e){return new v.default({schema:e})}))}},{key:"toSchema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=void 0;if(t===!1){if(0===this.tbs.length)return e.schema();r=s.fromBER(this.tbs).result}else{var n=[];"version"in this&&n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({value:this.version})]})),this.responderID instanceof f.default?n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]})):n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),n.push(new s.GeneralizedTime({valueDate:this.producedAt})),n.push(new s.Sequence({value:Array.from(this.responses,function(e){return e.toSchema()})})),"responseExtensions"in this&&n.push(new s.Sequence({value:Array.from(this.responseExtensions,function(e){return e.toSchema()})})),r=new s.Sequence({value:n})}return r}},{key:"toJSON",value:function(){var e={};return"version"in this&&(e.version=this.version),"responderID"in this&&(e.responderID=this.responderID),"producedAt"in this&&(e.producedAt=this.producedAt),"responses"in this&&(e.responses=Array.from(this.responses,function(e){return e.toJSON()})),"responseExtensions"in this&&(e.responseExtensions=Array.from(this.responseExtensions,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"tbs":return new ArrayBuffer(0);case"responderID":return{};case"producedAt":return new Date(0,0,0);case"responses":case"responseExtensions":return[];default:throw new Error("Invalid member name for ResponseData class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"tbs":return 0===r.byteLength;case"responderID":return 0===Object.keys(r).length;case"producedAt":return r===e.defaultValues(t);case"responses":case"responseExtensions":return 0===r.length;default:throw new Error("Invalid member name for ResponseData class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"ResponseData",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({name:t.version||"ResponseData.version"})]}),new s.Choice({value:[new s.Constructed({name:t.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:1},value:[f.default.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new s.Constructed({name:t.responderID||"ResponseData.responderID",idBlock:{tagClass:3,tagNumber:2},value:[new s.OctetString({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new s.GeneralizedTime({name:t.producedAt||"ResponseData.producedAt"}),new s.Sequence({value:[new s.Repeated({name:"ResponseData.responses",value:m.default.schema(t.response||{})})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[g.default.schema(t.extensions||{names:{blockName:"ResponseData.responseExtensions"}})]})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(127),f=n(c),h=r(77),m=n(h),d=r(96),v=n(d),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.certID=(0,l.getParametersValue)(t,"certID",e.defaultValues("certID")),this.certStatus=(0,l.getParametersValue)(t,"certStatus",e.defaultValues("certStatus")),this.thisUpdate=(0,l.getParametersValue)(t,"thisUpdate",e.defaultValues("thisUpdate")),"nextUpdate"in t&&(this.nextUpdate=(0,l.getParametersValue)(t,"nextUpdate",e.defaultValues("nextUpdate"))),"singleExtensions"in t&&(this.singleExtensions=(0,l.getParametersValue)(t,"singleExtensions",e.defaultValues("singleExtensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{certID:{names:{blockName:"certID"}},certStatus:"certStatus",thisUpdate:"thisUpdate",nextUpdate:"nextUpdate",singleExtensions:{names:{blockName:"singleExtensions"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SingleResponse");this.certID=new f.default({schema:r.result.certID}),this.certStatus=r.result.certStatus,this.thisUpdate=r.result.thisUpdate.toDate(),"nextUpdate"in r.result&&(this.nextUpdate=r.result.nextUpdate.toDate()),"singleExtensions"in r.result&&(this.singleExtensions=Array.from(r.result.singleExtensions.valueBlock.value,function(e){return new m.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new s.GeneralizedTime({valueDate:this.thisUpdate})),"nextUpdate"in this&&e.push(new s.GeneralizedTime({valueDate:this.nextUpdate})),"singleExtensions"in this&&e.push(new s.Sequence({value:Array.from(this.singleExtensions,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return"nextUpdate"in this&&(e.nextUpdate=this.nextUpdate),"singleExtensions"in this&&(e.singleExtensions=Array.from(this.singleExtensions,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"certID":return new f.default;case"certStatus":return{};case"thisUpdate":case"nextUpdate":return new Date(0,0,0);case"singleExtensions":return[];default:throw new Error("Invalid member name for SingleResponse class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"certID":return f.default.compareWithDefault("hashAlgorithm",r.hashAlgorithm)&&f.default.compareWithDefault("issuerNameHash",r.issuerNameHash)&&f.default.compareWithDefault("issuerKeyHash",r.issuerKeyHash)&&f.default.compareWithDefault("serialNumber",r.serialNumber);case"certStatus":return 0===Object.keys(r).length;case"thisUpdate":case"nextUpdate":return r===e.defaultValues(t);default:throw new Error("Invalid member name for SingleResponse class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.certID||{}),new s.Choice({value:[new s.Primitive({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:0},lenBlockLength:1}),new s.Constructed({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:1},value:[new s.GeneralizedTime,new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Enumerated]})]}),new s.Primitive({name:t.certStatus||"",idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new s.GeneralizedTime({name:t.thisUpdate||""}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.GeneralizedTime({name:t.nextUpdate||""})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[v.default.schema(t.singleExtensions||{})]})]})}}]),e}();t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(48),h=n(f),m=r(75),d=(n(m),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.hashAlgorithm=(0,l.getParametersValue)(t,"hashAlgorithm",e.defaultValues("hashAlgorithm")),this.issuerNameHash=(0,l.getParametersValue)(t,"issuerNameHash",e.defaultValues("issuerNameHash")),this.issuerKeyHash=(0,l.getParametersValue)(t,"issuerKeyHash",e.defaultValues("issuerKeyHash")),this.serialNumber=(0,l.getParametersValue)(t,"serialNumber",e.defaultValues("serialNumber")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{hashAlgorithm:"hashAlgorithm",issuerNameHash:"issuerNameHash",issuerKeyHash:"issuerKeyHash",serialNumber:"serialNumber"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CertID");this.hashAlgorithm=new h.default({schema:r.result.hashAlgorithm}),this.issuerNameHash=r.result.issuerNameHash,this.issuerKeyHash=r.result.issuerKeyHash,this.serialNumber=r.result.serialNumber}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}},{key:"toJSON",value:function(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}},{key:"isEqual",value:function(e){return!this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId&&((0,l.isEqualBuffer)(this.issuerNameHash.valueBlock.valueHex,e.issuerNameHash.valueBlock.valueHex)!==!1&&((0,l.isEqualBuffer)(this.issuerKeyHash.valueBlock.valueHex,e.issuerKeyHash.valueBlock.valueHex)!==!1&&!!this.serialNumber.isEqual(e.serialNumber)))}},{key:"createForCertificate",value:function(e,t){var r=this,n=Promise.resolve(),a=void 0,i=(0,c.getCrypto)();if("undefined"==typeof i)return Promise.reject("Unable to create WebCrypto object");if("hashAlgorithm"in t==!1)return Promise.reject('Parameter "hashAlgorithm" is mandatory for "OCSP_REQUEST.createForCertificate"');var o=(0,c.getOIDByAlgorithm)({name:t.hashAlgorithm});return""===o?Promise.reject('Incorrect "hashAlgorithm": '+this.hashAlgorithm):(this.hashAlgorithm=new h.default({algorithmId:o,algorithmParams:new s.Null}),"issuerCertificate"in t?(a=t.issuerCertificate,this.serialNumber=e.serialNumber,n=n.then(function(){return i.digest({name:t.hashAlgorithm},a.subject.toSchema().toBER(!1))},function(e){return Promise.reject(e)}),n=n.then(function(e){r.issuerNameHash=new s.OctetString({valueHex:e});var n=a.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex;return i.digest({name:t.hashAlgorithm},n)},function(e){return Promise.reject(e)}).then(function(e){r.issuerKeyHash=new s.OctetString({valueHex:e})},function(e){return Promise.reject(e)})):Promise.reject('Parameter "issuerCertificate" is mandatory for "OCSP_REQUEST.createForCertificate"'))}}],[{key:"defaultValues",value:function(e){switch(e){case"hashAlgorithm":return new h.default;case"issuerNameHash":case"issuerKeyHash":return new s.OctetString;case"serialNumber":return new s.Integer;default:throw new Error("Invalid member name for CertID class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"hashAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"issuerNameHash":case"issuerKeyHash":case"serialNumber":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for CertID class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[h.default.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||""}}),new s.OctetString({name:t.issuerNameHash||""}),new s.OctetString({name:t.issuerKeyHash||""}),new s.Integer({name:t.serialNumber||""})]})}}]),e}());t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(44),s=r(47),l=r(98),c=(n(l),r(75)),f=(n(c),r(129)),h=n(f),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.trustedCerts=(0,u.getParametersValue)(t,"trustedCerts",e.defaultValues("trustedCerts")),this.certs=(0,u.getParametersValue)(t,"certs",e.defaultValues("certs")),this.crls=(0,u.getParametersValue)(t,"crls",e.defaultValues("crls")),this.ocsps=(0,u.getParametersValue)(t,"ocsps",e.defaultValues("ocsps")),this.checkDate=(0,u.getParametersValue)(t,"checkDate",e.defaultValues("checkDate")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"sort",value:function(){function e(e,t){var r,n,a,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=[],!e.subject.isEqual(e.issuer)){o.next=12;break}return o.prev=2,o.next=5,e.verify();case 5:if(n=o.sent,n!==!0){o.next=8;break}return o.abrupt("return",[t]);case 8:o.next=12;break;case 10:o.prev=10,o.t0=o.catch(2);case 12:a=0;case 13:if(!(a<c.length)){o.next=26;break}return o.prev=14,o.next=17,e.verify(c[a]);case 17:i=o.sent,i===!0&&r.push(a),o.next=23;break;case 21:o.prev=21,o.t1=o.catch(14);case 23:a++,o.next=13;break;case 26:return o.abrupt("return",r.length?r:[-1]);case 27:case"end":return o.stop()}},l[0],this,[[2,10],[14,21]])}function t(r,n){var a,i,o,u,s,f,h,m,d,v;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=function(e){for(var t=!0,r=0;r<e.length;r++){for(var n=0;n<e.length;n++)if(n!==r&&e[r]===e[n]){t=!1;break}if(!t)break}return t},a=[],l.next=4,e(r,n);case 4:if(o=l.sent,1!==o.length||o[0]!==-1){l.next=7;break}throw new Error("Incorrect result");case 7:if(1!==o.length){l.next=17;break}if(o[0]!==n){l.next=11;break}return a.push(o),l.abrupt("return",a);case 11:return l.next=13,t(c[o[0]],o[0]);case 13:for(u=l.sent,s=0;s<u.length;s++)f=u[s].slice(),f.splice(0,0,o[0]),i(f)?a.push(f):a.push(u[s]);l.next=29;break;case 17:h=0;case 18:if(!(h<o.length)){l.next=29;break}if(o[h]!==n){l.next=22;break}return a.push([o[h]]),l.abrupt("continue",26);case 22:return l.next=24,t(c[o[h]],o[h]);case 24:for(m=l.sent,d=0;d<m.length;d++)v=m[d].slice(),v.splice(0,0,o[h]),i(v)?a.push(v):a.push(m[d]);case 26:h++,l.next=18;break;case 29:return l.abrupt("return",a);case 30:case"end":return l.stop()}},l[1],this)}function r(e){var t,r,n,i,o,u;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t=[],r=[],n=[],t.push.apply(t,a(c.filter(function(t){return e.issuer.isEqual(t.subject)}))),0!==t.length){s.next=6;break}return s.abrupt("return",{status:1,statusMessage:"No certificate's issuers"});case 6:if(r.push.apply(r,a(f.crls.filter(function(t){return t.issuer.isEqual(e.issuer)}))),0!==r.length){s.next=9;break}return s.abrupt("return",{status:1,statusMessage:"No CRLs for specific certificate issuer"});case 9:i=0;case 10:if(!(i<r.length)){s.next=32;break}if(!(r[i].nextUpdate.value<f.checkDate)){s.next=13;break}return s.abrupt("continue",29);case 13:o=0;case 14:if(!(o<t.length)){s.next=29;break}return s.prev=15,s.next=18,r[i].verify({issuerCertificate:t[o]});case 18:if(u=s.sent,!u){s.next=22;break}return n.push({crl:r[i],certificate:t[o]}),s.abrupt("break",29);case 22:s.next=26;break;case 24:s.prev=24,s.t0=s.catch(15);case 26:o++,s.next=14;break;case 29:i++,s.next=10;break;case 32:if(!n.length){s.next=34;break}return s.abrupt("return",{status:0,statusMessage:"",result:n});case 34:return s.abrupt("return",{status:1,statusMessage:"No valid CRLs found"});case 35:case"end":return s.stop()}},l[2],this,[[15,24]])}function n(e,t){var r,n,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(r=(0,s.getAlgorithmByOID)(e.signatureAlgorithm.algorithmId),"name"in r!=!1){i.next=3;break}return i.abrupt("return",1);case 3:if("hash"in r!=!1){i.next=5;break}return i.abrupt("return",1);case 5:n=0;case 6:if(!(n<f.ocsps.length)){i.next=17;break}return i.next=9,f.ocsps[n].getCertificateStatus(e,t);case 9:if(a=i.sent,!a.isForCertificate){i.next=14;break}if(0!==a.status){i.next=13;break}return i.abrupt("return",0);case 13:return i.abrupt("return",1);case 14:n++,i.next=6;break;case 17:return i.abrupt("return",2);case 18:case"end":return i.stop()}},l[3],this)}function i(e){var t,r,n,a,i,o,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t=!1,r=!1,n=!1,a=!1,!("extensions"in e)){s.next=20;break}i=0;case 6:if(!(i<e.extensions.length)){s.next=14;break}if(e.extensions[i].critical!==!0||"parsedValue"in e.extensions[i]!=!1){s.next=9;break}return s.abrupt("return",{result:!1,resultCode:6,resultMessage:"Unable to parse critical certificate extension: "+e.extensions[i].extnID});case 9:"2.5.29.15"===e.extensions[i].extnID&&(n=!0,o=new Uint8Array(e.extensions[i].parsedValue.valueBlock.valueHex),4===(4&o[0])&&(r=!0),2===(2&o[0])&&(a=!0)),"2.5.29.19"===e.extensions[i].extnID&&"cA"in e.extensions[i].parsedValue&&e.extensions[i].parsedValue.cA===!0&&(t=!0);case 11:i++,s.next=6;break;case 14:if(r!==!0||t!==!1){s.next=16;break}return s.abrupt("return",{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'});case 16:if(n!==!0||t!==!0||r!==!1){s.next=18;break}return s.abrupt("return",{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'});case 18:if(t!==!0||n!==!0||!u||a!==!1){s.next=20;break}return s.abrupt("return",{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'});case 20:if(t!==!1){s.next=22;break}return s.abrupt("return",{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"});case 22:return s.abrupt("return",{result:!0,resultCode:0,resultMessage:""});case 23:case"end":return s.stop()}},l[4],this)}function o(e,t){var a,o,u,s,c,h,m,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:a=0;case 1:if(!(a<e.length)){l.next=7;break}if(!(e[a].notBefore.value>t||e[a].notAfter.value<t)){l.next=4;break}return l.abrupt("return",{result:!1,resultCode:8,resultMessage:"Certificate validity period is out of checking date"});case 4:a++,l.next=1;break;case 7:if(!(e.length<2)){l.next=9;break}return l.abrupt("return",{result:!1,resultCode:9,resultMessage:"Too short certificate path"});case 9:o=e.length-2;case 10:if(!(o>=0)){l.next=17;break}if(e[o].issuer.isEqual(e[o].subject)!==!1){l.next=14;break}if(e[o].issuer.isEqual(e[o+1].subject)!==!1){l.next=14;break}return l.abrupt("return",{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"});case 14:o--,l.next=10;break;case 17:if(0===f.crls.length&&0===f.ocsps.length){l.next=58;break}u=0;case 19:if(!(u<e.length-2)){l.next=58;break}if(s=void 0,c=void 0,0===f.ocsps.length){l.next=32;break}return l.next=25,n(e[u],e[u+1]);case 25:s=l.sent,l.t0=s,l.next=0===l.t0?29:1===l.t0?30:2===l.t0?31:32;break;case 29:return l.abrupt("continue",55);case 30:return l.abrupt("return",{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"});case 31:return l.abrupt("break",32);case 32:if(0===f.crls.length){l.next=53;break}return l.next=35,r(e[u]);case 35:if(c=l.sent,!c.status){l.next=38;break}throw{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates: "+c.statusMessage};case 38:h=0;case 39:if(!(h<c.result.length)){l.next=51;break}if(m=c.result[h].crl.isCertificateRevoked(e[u]),!m){l.next=43;break}return l.abrupt("return",{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"});case 43:return l.next=45,i(c.result[h].certificate,!0);case 45:if(d=l.sent,d.result!==!1){l.next=48;break}return l.abrupt("return",{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"});case 48:h++,l.next=39;break;case 51:l.next=55;break;case 53:if(2!==s){l.next=55;break}return l.abrupt("return",{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"});case 55:u++,l.next=19;break;case 58:v=1;case 59:if(!(v<e.length)){l.next=68;break}return l.next=62,i(e[v]);case 62:if(p=l.sent,p.result!==!1){l.next=65;break}return l.abrupt("return",{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"});case 65:v++,l.next=59;break;case 68:return l.abrupt("return",{result:!0});case 69:case"end":return l.stop()}},l[5],this)}var l=[e,t,r,n,i,o].map(regeneratorRuntime.mark),c=[],f=this;return(0,h.default)(regeneratorRuntime.mark(function e(){var r,n,i,s,l,h,m,d,v,p,g,y,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.push.apply(c,a(f.trustedCerts)),c.push.apply(c,a(f.certs)),r=0;case 3:if(!(r<c.length)){e.next=18;break}n=0;case 5:if(!(n<c.length)){e.next=15;break}if(r!==n){e.next=8;break}return e.abrupt("continue",12);case 8:if(!(0,u.isEqualBuffer)(c[r].tbs,c[n].tbs)){e.next=12;break}return c.splice(n,1),r=0,e.abrupt("break",15);case 12:n++,e.next=5;break;case 15:r++,e.next=3;break;case 18:return i=void 0,s=[c[c.length-1]],e.next=22,t(c[c.length-1],c.length-1);case 22:if(i=e.sent,0!==i.length){e.next=25;break}return e.abrupt("return",{result:!1,resultCode:60,resultMessage:"Unable to find certificate path"});case 25:l=0;case 26:if(!(l<i.length)){e.next=48;break}h=!1,m=0;
case 29:if(!(m<i[l].length)){e.next=44;break}d=c[i[l][m]],v=0;case 32:if(!(v<f.trustedCerts.length)){e.next=39;break}if(!(0,u.isEqualBuffer)(d.tbs,f.trustedCerts[v].tbs)){e.next=36;break}return h=!0,e.abrupt("break",39);case 36:v++,e.next=32;break;case 39:if(!h){e.next=41;break}return e.abrupt("break",44);case 41:m++,e.next=29;break;case 44:h||(i.splice(l,1),l=0);case 45:l++,e.next=26;break;case 48:if(0!==i.length){e.next=50;break}throw{result:!1,resultCode:97,resultMessage:"No valid certificate paths found"};case 50:for(p=i[0].length,g=0,y=0;y<i.length;y++)i[y].length<p&&(p=i[y].length,g=y);for(b=0;b<i[g].length;b++)s.push(c[i[g][b]]);return e.next=56,o(s,f.checkDate);case 56:if(i=e.sent,i.result!==!1){e.next=59;break}throw i;case 59:return e.abrupt("return",s);case 60:case"end":return e.stop()}},e,this)}))}},{key:"verify",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===this.certs.length)return Promise.reject("Empty certificate array");var r=Promise.resolve(),n=[];n.push("2.5.29.32.0");var a=!1,i=!1,o=!1,u=[],l=[],c=[];"initialPolicySet"in t&&(n=t.initialPolicySet),"initialExplicitPolicy"in t&&(a=t.initialExplicitPolicy),"initialPolicyMappingInhibit"in t&&(i=t.initialPolicyMappingInhibit),"initialInhibitPolicy"in t&&(o=t.initialInhibitPolicy),"initialPermittedSubtreesSet"in t&&(u=t.initialPermittedSubtreesSet),"initialExcludedSubtreesSet"in t&&(l=t.initialExcludedSubtreesSet),"initialRequiredNameForms"in t&&(c=t.initialRequiredNameForms);var f=a,h=i,m=o,d=new Array(3);d[0]=!1,d[1]=!1,d[2]=!1;var v=0,p=0,g=0,y=u,b=l,w=c,k=1;return r=this.sort().then(function(t){e.certs=t}),r=r.then(function(){var t=[];t.push("2.5.29.32.0");for(var r=[],a=new Array(e.certs.length-1),i=0;i<e.certs.length-1;i++)a[i]=!0;r.push(a);for(var o=new Array(e.certs.length-1),u=new Array(e.certs.length-1),s=f?e.certs.length-1:-1,l=e.certs.length-2;l>=0;l--,k++)if("extensions"in e.certs[l]){for(var c=0;c<e.certs[l].extensions.length;c++){if("2.5.29.32"===e.certs[l].extensions[c].extnID){u[l]=e.certs[l].extensions[c].parsedValue;for(var y=0;y<t.length;y++)if("2.5.29.32.0"===t[y]){delete r[y][l];break}for(var b=0;b<e.certs[l].extensions[c].parsedValue.certificatePolicies.length;b++){for(var w=-1,S=0;S<t.length;S++)if(e.certs[l].extensions[c].parsedValue.certificatePolicies[b].policyIdentifier===t[S]){w=S;break}if(w===-1){t.push(e.certs[l].extensions[c].parsedValue.certificatePolicies[b].policyIdentifier);var C=new Array(e.certs.length-1);C[l]=!0,r.push(C)}else r[w][l]=!0}}if("2.5.29.33"===e.certs[l].extensions[c].extnID){if(h)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};o[l]=e.certs[l].extensions[c].parsedValue}"2.5.29.36"===e.certs[l].extensions[c].extnID&&f===!1&&(0===e.certs[l].extensions[c].parsedValue.requireExplicitPolicy?(f=!0,s=l):d[0]===!1?(d[0]=!0,v=e.certs[l].extensions[c].parsedValue.requireExplicitPolicy):v=v>e.certs[l].extensions[c].parsedValue.requireExplicitPolicy?e.certs[l].extensions[c].parsedValue.requireExplicitPolicy:v,0===e.certs[l].extensions[c].parsedValue.inhibitPolicyMapping?h=!0:d[1]===!1?(d[1]=!0,p=e.certs[l].extensions[c].parsedValue.inhibitPolicyMapping+1):p=p>e.certs[l].extensions[c].parsedValue.inhibitPolicyMapping+1?e.certs[l].extensions[c].parsedValue.inhibitPolicyMapping+1:p),"2.5.29.54"===e.certs[l].extensions[c].extnID&&m===!1&&(0===e.certs[l].extensions[c].parsedValue.valueBlock.valueDec?m=!0:d[2]===!1?(d[2]=!0,g=e.certs[l].extensions[c].parsedValue.valueBlock.valueDec):g=g>e.certs[l].extensions[c].parsedValue.valueBlock.valueDec?e.certs[l].extensions[c].parsedValue.valueBlock.valueDec:g)}if(m===!0){for(var P=-1,A=0;A<t.length;A++)if("2.5.29.32.0"===t[A]){P=A;break}P!==-1&&delete r[0][l]}f===!1&&d[0]===!0&&(v--,0===v&&(f=!0,s=l,d[0]=!1)),h===!1&&d[1]===!0&&(p--,0===p&&(h=!0,d[1]=!1)),m===!1&&d[2]===!0&&(g--,0===g&&(m=!0,d[2]=!1))}for(var I=0;I<e.certs.length-1;I++)if(I<e.certs.length-2&&"undefined"!=typeof o[I+1])for(var _=0;_<o[I+1].mappings.length;_++){if("2.5.29.32.0"===o[I+1].mappings[_].issuerDomainPolicy||"2.5.29.32.0"===o[I+1].mappings[_].subjectDomainPolicy)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};for(var O=-1,B=-1,E=0;E<t.length;E++)t[E]===o[I+1].mappings[_].issuerDomainPolicy&&(O=E),t[E]===o[I+1].mappings[_].subjectDomainPolicy&&(B=E);"undefined"!=typeof r[O][I]&&delete r[O][I];for(var N=0;N<u[I].certificatePolicies.length;N++)if(o[I+1].mappings[_].subjectDomainPolicy===u[I].certificatePolicies[N].policyIdentifier&&O!==-1&&B!==-1)for(var j=0;j<=I;j++)"undefined"!=typeof r[B][j]&&(r[O][j]=!0,delete r[B][j])}for(var V=0;V<t.length;V++)if("2.5.29.32.0"===t[V])for(var x=0;x<s;x++)delete r[V][x];for(var R=[],D=0;D<r.length;D++){for(var T=!0,U=0;U<e.certs.length-1;U++){var H=!1;if(U<s&&"2.5.29.32.0"===t[D]&&t.length>1){T=!1;break}if("undefined"==typeof r[D][U]){if(U>=s)for(var K=0;K<t.length;K++)if("2.5.29.32.0"===t[K]){r[K][U]===!0&&(H=!0);break}if(!H){T=!1;break}}}T===!0&&R.push(t[D])}var q=[];if(1===n.length&&"2.5.29.32.0"===n[0]&&f===!1)q=n;else if(1===R.length&&"2.5.29.32.0"===R[0])q=n;else for(var M=0;M<R.length;M++)for(var L=0;L<n.length;L++)if(n[L]===R[M]||"2.5.29.32.0"===n[L]){q.push(R[M]);break}return{result:q.length>0,resultCode:0,resultMessage:q.length>0?"":'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:R,userConstrPolicies:q,explicitPolicyIndicator:f,policyMappings:o}}),r=r.then(function(t){function r(e,t){var r=(0,s.stringPrep)(e),n=(0,s.stringPrep)(t),a=r.split("."),i=n.split("."),o=a.length,u=i.length;if(0===o||0===u||o<u)return!1;for(var l=0;l<o;l++)if(0===a[l].length)return!1;for(var c=0;c<u;c++)if(0===i[c].length){if(0===c){if(1===u)return!1;continue}return!1}for(var f=0;f<u;f++)if(0!==i[u-1-f].length&&0!==a[o-1-f].localeCompare(i[u-1-f]))return!1;return!0}function n(e,t){var n=(0,s.stringPrep)(e),a=(0,s.stringPrep)(t),i=n.split("@"),o=a.split("@");if(0===i.length||0===o.length||i.length<o.length)return!1;if(1===o.length){var u=r(i[1],o[0]);if(u){var l=i[1].split("."),c=o[0].split(".");return 0===c[0].length||l.length===c.length}return!1}return 0===n.localeCompare(a)}function a(e,t){var n=(0,s.stringPrep)(e),a=(0,s.stringPrep)(t),i=n.split("/"),o=a.split("/");if(o.length>1)return!1;if(i.length>1)for(var u=0;u<i.length;u++)if(i[u].length>0&&":"!==i[u].charAt(i[u].length-1)){var l=i[u].split(":");n=l[0];break}var c=r(n,a);if(c){var f=n.split("."),h=a.split(".");return 0===h[0].length||f.length===h.length}return!1}function i(e,t){var r=new Uint8Array(e.valueBlock.valueHex),n=new Uint8Array(t.valueBlock.valueHex);if(4===r.length&&8===n.length){for(var a=0;a<4;a++)if((r[a]^n[a])&n[a+4])return!1;return!0}if(16===r.length&&32===n.length){for(var i=0;i<16;i++)if((r[i]^n[i])&n[i+16])return!1;return!0}return!1}function o(e,t){if(0===e.typesAndValues.length||0===t.typesAndValues.length)return!0;if(e.typesAndValues.length<t.typesAndValues.length)return!1;for(var r=!0,n=0,a=0;a<t.typesAndValues.length;a++){for(var i=!1,o=n;o<e.typesAndValues.length;o++)if(i=e.typesAndValues[o].isEqual(t.typesAndValues[a]),e.typesAndValues[o].type===t.typesAndValues[a].type&&(r=r&&i),i===!0){if(0===n||n===o){n=o+1;break}return!1}if(i===!1)return!1}return 0!==n&&r}if(t.result===!1)return t;k=1;for(var u=e.certs.length-2;u>=0;u--,k++){var l=[],c=[],f=[];if("extensions"in e.certs[u])for(var h=0;h<e.certs[u].extensions.length;h++)"2.5.29.30"===e.certs[u].extensions[h].extnID&&("permittedSubtrees"in e.certs[u].extensions[h].parsedValue&&(c=c.concat(e.certs[u].extensions[h].parsedValue.permittedSubtrees)),"excludedSubtrees"in e.certs[u].extensions[h].parsedValue&&(f=f.concat(e.certs[u].extensions[h].parsedValue.excludedSubtrees))),"2.5.29.17"===e.certs[u].extensions[h].extnID&&(l=l.concat(e.certs[u].extensions[h].parsedValue.altNames));for(var m=w.length<=0,d=0;d<w.length;d++)switch(w[d].base.type){case 4:if(w[d].base.value.typesAndValues.length!==e.certs[u].subject.typesAndValues.length)continue;m=!0;for(var v=0;v<e.certs[u].subject.typesAndValues.length;v++)if(e.certs[u].subject.typesAndValues[v].type!==w[d].base.value.typesAndValues[v].type){m=!1;break}if(m===!0)break}if(m===!1)return t.result=!1,t.resultCode=21,t.resultMessage="No neccessary name form found",Promise.reject(t);var p=[];p[0]=[],p[1]=[],p[2]=[],p[3]=[],p[4]=[];for(var g=0;g<y.length;g++)switch(y[g].base.type){case 1:p[0].push(y[g]);break;case 2:p[1].push(y[g]);break;case 4:p[2].push(y[g]);break;case 6:p[3].push(y[g]);break;case 7:p[4].push(y[g])}for(var S=0;S<5;S++){for(var C=!1,P=!1,A=p[S],I=0;I<A.length;I++){switch(S){case 0:if(l.length>0)for(var _=0;_<l.length;_++)1===l[_].type&&(P=!0,C=C||n(l[_].value,A[I].base.value));else for(var O=0;O<e.certs[u].subject.typesAndValues.length;O++)"1.2.840.113549.1.9.1"!==e.certs[u].subject.typesAndValues[O].type&&"0.9.2342.19200300.100.1.3"!==e.certs[u].subject.typesAndValues[O].type||(P=!0,C=C||n(e.certs[u].subject.typesAndValues[O].value.valueBlock.value,A[I].base.value));break;case 1:if(l.length>0)for(var B=0;B<l.length;B++)2===l[B].type&&(P=!0,C=C||r(l[B].value,A[I].base.value));break;case 2:P=!0,C=o(e.certs[u].subject,A[I].base.value);break;case 3:if(l.length>0)for(var E=0;E<l.length;E++)6===l[E].type&&(P=!0,C=C||a(l[E].value,A[I].base.value));break;case 4:if(l.length>0)for(var N=0;N<l.length;N++)7===l[N].type&&(P=!0,C=C||i(l[N].value,A[I].base.value))}if(C)break}if(C===!1&&A.length>0&&P)return t.result=!1,t.resultCode=41,t.resultMessage='Failed to meet "permitted sub-trees" name constraint',Promise.reject(t)}for(var j=!1,V=0;V<b.length;V++){switch(b[V].base.type){case 1:if(l.length>=0)for(var x=0;x<l.length;x++)1===l[x].type&&(j=j||n(l[x].value,b[V].base.value));else for(var R=0;R<e.subject.typesAndValues.length;R++)"1.2.840.113549.1.9.1"!==e.subject.typesAndValues[R].type&&"0.9.2342.19200300.100.1.3"!==e.subject.typesAndValues[R].type||(j=j||n(e.subject.typesAndValues[R].value.valueBlock.value,b[V].base.value));break;case 2:if(l.length>0)for(var D=0;D<l.length;D++)2===l[D].type&&(j=j||r(l[D].value,b[V].base.value));break;case 4:j=j||o(e.certs[u].subject,b[V].base.value);break;case 6:if(l.length>0)for(var T=0;T<l.length;T++)6===l[T].type&&(j=j||a(l[T].value,b[V].base.value));break;case 7:if(l.length>0)for(var U=0;U<l.length;U++)7===l[U].type&&(j=j||i(l[U].value,b[V].base.value))}if(j)break}if(j===!0)return t.result=!1,t.resultCode=42,t.resultMessage='Failed to meet "excluded sub-trees" name constraint',Promise.reject(t);y=y.concat(c),b=b.concat(f)}return t}),r=r.then(function(e){return e},function(e){if(e instanceof Object){if("resultMessage"in e)return e;if("message"in e)return{result:!1,resultCode:-1,resultMessage:e.message}}return{result:!1,resultCode:-1,resultMessage:e}})}}],[{key:"defaultValues",value:function(e){switch(e){case"trustedCerts":return[];case"certs":return[];case"crls":return[];case"ocsps":return[];case"checkDate":return new Date;default:throw new Error("Invalid member name for CertificateChainValidationEngine class: "+e)}}}]),e}();t.default=m},function(e,t){"use strict";function r(e){if(!n(e)){if(!a(e))throw new Error("Only generator instance of generator function is a valid input");e=e()}return new Promise(function(t,i){var o=function(t){var r=void 0;try{r=e.throw(t)}catch(e){return i(e)}return u(r)},u=function u(s){var l=void 0;try{l=e.next(s)}catch(e){return i(e)}switch(!0){case l.value instanceof Promise:return l.done?t(l.value):l.value.then(u,o);case a(l.value):case n(l.value):return l.done?r(l.value).then(function(e){t(e)},o):r(l.value).then(u,o);case"function"==typeof l.value:l.value=l.value();default:return l.done?t(l.value):u(l.value)}};u()})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=function(e){return"undefined"!=typeof e&&("function"==typeof e.next&&"function"==typeof e.throw)},a=function(e){if("undefined"==typeof e)return!1;var t=e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName||n(e))}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({name:t.CertificationRequestInfo||"CertificationRequestInfo",value:[new l.Integer({name:t.CertificationRequestInfoVersion||"CertificationRequestInfo.version"}),v.default.schema(t.subject||{names:{blockName:"CertificationRequestInfo.subject"}}),m.default.schema({names:{blockName:"CertificationRequestInfo.subjectPublicKeyInfo"}}),new l.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new l.Repeated({optional:!0,name:t.CertificationRequestInfoAttributes||"CertificationRequestInfo.attributes",value:b.default.schema(t.attributes||{})})]})]})}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),l=a(s),c=r(44),f=r(47),h=r(51),m=n(h),d=r(61),v=n(d),p=r(48),g=n(p),y=r(55),b=n(y),w=r(49),k=n(w),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbs=(0,c.getParametersValue)(t,"tbs",e.defaultValues("tbs")),this.version=(0,c.getParametersValue)(t,"version",e.defaultValues("version")),this.subject=(0,c.getParametersValue)(t,"subject",e.defaultValues("subject")),this.subjectPublicKeyInfo=(0,c.getParametersValue)(t,"subjectPublicKeyInfo",e.defaultValues("subjectPublicKeyInfo")),"attributes"in t&&(this.attributes=(0,c.getParametersValue)(t,"attributes",e.defaultValues("attributes"))),this.signatureAlgorithm=(0,c.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signatureValue=(0,c.getParametersValue)(t,"signatureValue",e.defaultValues("signatureValue")),"schema"in t&&this.fromSchema(t.schema)}return u(e,[{key:"fromSchema",value:function(t){var r=l.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PKCS10");this.tbs=r.result.CertificationRequestInfo.valueBeforeDecode,this.version=r.result["CertificationRequestInfo.version"].valueBlock.valueDec,this.subject=new v.default({schema:r.result["CertificationRequestInfo.subject"]}),this.subjectPublicKeyInfo=new m.default({schema:r.result["CertificationRequestInfo.subjectPublicKeyInfo"]}),"CertificationRequestInfo.attributes"in r.result&&(this.attributes=Array.from(r.result["CertificationRequestInfo.attributes"],function(e){return new b.default({schema:e})})),this.signatureAlgorithm=new g.default({schema:r.result.signatureAlgorithm}),this.signatureValue=r.result.signatureValue}},{key:"encodeTBS",value:function(){var e=[new l.Integer({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return"attributes"in this&&e.push(new l.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,function(e){return e.toSchema()})})),new l.Sequence({value:e})}},{key:"toSchema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=void 0;if(t===!1){if(0===this.tbs.length)return e.schema();r=l.fromBER(this.tbs).result}else r=this.encodeTBS();return new l.Sequence({value:[r,this.signatureAlgorithm.toSchema(),this.signatureValue]})}},{key:"toJSON",value:function(){var e={tbs:(0,c.bufferToHexCodes)(this.tbs,0,this.tbs.byteLength),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,function(e){return e.toJSON()})),e}},{key:"sign",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1";if("undefined"==typeof e)return Promise.reject("Need to provide a private key for signing");var n=(0,f.getOIDByAlgorithm)({name:r});if(""===n)return Promise.reject("Unsupported hash algorithm: {$hashAlgorithm}");var a=(0,f.getAlgorithmParameters)(e.algorithm.name,"sign");switch(a.algorithm.hash.name=r,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signatureAlgorithm.algorithmId=(0,f.getOIDByAlgorithm)(a.algorithm);break;case"RSA-PSS":switch(r.toUpperCase()){case"SHA-256":a.algorithm.saltLength=32;break;case"SHA-384":a.algorithm.saltLength=48;break;case"SHA-512":a.algorithm.saltLength=64}var i={};if("SHA-1"!==r.toUpperCase()){var o=(0,f.getOIDByAlgorithm)({name:r});if(""===o)return Promise.reject("Unsupported hash algorithm: "+r);i.hashAlgorithm=new g.default({algorithmId:o,algorithmParams:new l.Null}),i.maskGenAlgorithm=new g.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}20!==a.algorithm.saltLength&&(i.saltLength=a.algorithm.saltLength);var u=new k.default(i);this.signatureAlgorithm=new g.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:u.toSchema()});break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}this.tbs=this.encodeTBS().toBER(!1);var s=(0,f.getCrypto)();return"undefined"==typeof s?Promise.reject("Unable to create WebCrypto object"):s.sign(a.algorithm,e,new Uint8Array(this.tbs)).then(function(e){"ECDSA"===a.algorithm.name&&(e=(0,f.createCMSECDSASignature)(e)),t.signatureValue=new l.BitString({valueHex:e})},function(e){return Promise.reject("Signing error: "+e)})}},{key:"verify",value:function(){var e=this,t=Promise.resolve(),r=this.subjectPublicKeyInfo,n=this.signatureValue,a=this.tbs,i=(0,f.getCrypto)();if("undefined"==typeof i)return Promise.reject("Unable to create WebCrypto object");var o=(0,f.getHashAlgorithm)(this.signatureAlgorithm);return""===o?Promise.reject("Unsupported signature algorithm: "+this.signatureAlgorithm.algorithmId):(t=t.then(function(){var t=void 0;t="1.2.840.113549.1.1.10"===e.signatureAlgorithm.algorithmId?e.signatureAlgorithm.algorithmId:e.subjectPublicKeyInfo.algorithm.algorithmId;var n=(0,f.getAlgorithmByOID)(t);if("name"in n==!1)return Promise.reject("Unsupported public key algorithm: "+t);var a=n.name,u=(0,f.getAlgorithmParameters)(a,"importkey");if("hash"in u.algorithm&&(u.algorithm.hash.name=o),"ECDSA"===n.name){var s=!1;if("algorithmParams"in r.algorithm==!0&&"idBlock"in r.algorithm.algorithmParams&&1===r.algorithm.algorithmParams.idBlock.tagClass&&6===r.algorithm.algorithmParams.idBlock.tagNumber&&(s=!0),s===!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var l=(0,f.getAlgorithmByOID)(r.algorithm.algorithmParams.valueBlock.toString());if("name"in l==!1)return Promise.reject("Unsupported named curve algorithm: "+r.algorithm.algorithmParams.valueBlock.toString());u.algorithm.namedCurve=l.name}var c=r.toSchema(),h=c.toBER(!1),m=new Uint8Array(h);return i.importKey("spki",m,u.algorithm,!0,u.usages)}),t=t.then(function(t){var r=(0,f.getAlgorithmParameters)(t.algorithm.name,"verify");"hash"in r.algorithm&&(r.algorithm.hash.name=o);var u=n.valueBlock.valueHex;if("ECDSA"===t.algorithm.name){var s=l.fromBER(u);u=(0,f.createECDSASignatureFromCMS)(s.result)}if("RSA-PSS"===t.algorithm.name){var c=void 0;try{c=new k.default({schema:e.signatureAlgorithm.algorithmParams})}catch(e){return Promise.reject(e)}"saltLength"in c?r.algorithm.saltLength=c.saltLength:r.algorithm.saltLength=20;var h="SHA-1";if("hashAlgorithm"in c){var m=(0,f.getAlgorithmByOID)(c.hashAlgorithm.algorithmId);if("name"in m==!1)return Promise.reject("Unrecognized hash algorithm: "+c.hashAlgorithm.algorithmId);h=m.name}r.algorithm.hash.name=h}return i.verify(r.algorithm,t,new Uint8Array(u),new Uint8Array(a))}))}}],[{key:"defaultValues",value:function(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"subject":return new v.default;case"subjectPublicKeyInfo":return new m.default;case"attributes":return[];case"signatureAlgorithm":return new g.default;case"signatureValue":return new l.BitString;default:throw new Error("Invalid member name for CertificationRequest class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.getParametersValue)(e,"names",{});return new l.Sequence({value:[o(t.certificationRequestInfo||{}),new l.Sequence({name:t.signatureAlgorithm||"signatureAlgorithm",value:[new l.ObjectIdentifier,new l.Any({optional:!0})]}),new l.BitString({name:t.signatureValue||"signatureValue"})]})}}]),e}();t.default=S},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.digestAlgorithm=(0,l.getParametersValue)(t,"digestAlgorithm",e.defaultValues("digestAlgorithm")),this.digest=(0,l.getParametersValue)(t,"digest",e.defaultValues("digest")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{digestAlgorithm:{names:{blockName:"digestAlgorithm"}},digest:"digest"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for DigestInfo");this.digestAlgorithm=new f.default({schema:r.result.digestAlgorithm}),this.digest=r.result.digest}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.digestAlgorithm.toSchema(),this.digest]})}},{key:"toJSON",value:function(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"digestAlgorithm":return new f.default;case"digest":return new s.OctetString;default:throw new Error("Invalid member name for DigestInfo class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"digestAlgorithm":return f.default.compareWithDefault("algorithmId",t.algorithmId)&&"algorithmParams"in t==!1;case"digest":return t.isEqual(this.constructor.defaultValues(e));default:throw new Error("Invalid member name for DigestInfo class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.digestAlgorithm||{names:{blockName:"digestAlgorithm"}}),new s.OctetString({name:t.digest||"digest"})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a(this,e),this.eContentType=(0,s.getParametersValue)(t,"eContentType",e.defaultValues("eContentType")),"eContent"in t&&(this.eContent=(0,s.getParametersValue)(t,"eContent",e.defaultValues("eContent")),1===this.eContent.idBlock.tagClass&&4===this.eContent.idBlock.tagNumber&&this.eContent.idBlock.isConstructed===!1)){for(var r=new u.OctetString({idBlock:{isConstructed:!0},isConstructed:!0}),n=0,i=this.eContent.valueBlock.valueHex.byteLength;i>0;){for(var o=new Uint8Array(this.eContent.valueBlock.valueHex,n,n+65536>this.eContent.valueBlock.valueHex.byteLength?this.eContent.valueBlock.valueHex.byteLength-n:65536),l=new ArrayBuffer(o.length),c=new Uint8Array(l),f=0;f<c.length;f++)c[f]=o[f];r.valueBlock.value.push(new u.OctetString({valueHex:l})),i-=o.length,n+=o.length}this.eContent=r}"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{eContentType:"eContentType",eContent:"eContent"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for EncapsulatedContentInfo");this.eContentType=r.result.eContentType.valueBlock.toString(),"eContent"in r.result&&(this.eContent=r.result.eContent)}},{key:"toSchema",value:function(){var t=[];return t.push(new u.ObjectIdentifier({value:this.eContentType})),"eContent"in this&&e.compareWithDefault("eContent",this.eContent)===!1&&t.push(new u.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new u.Sequence({value:t})}},{key:"toJSON",value:function(){var t={eContentType:this.eContentType};return"eContent"in this&&e.compareWithDefault("eContent",this.eContent)===!1&&(t.eContent=this.eContent.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"eContentType":return"";case"eContent":return new u.OctetString;default:throw new Error("Invalid member name for EncapsulatedContentInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"eContentType":return""===r;case"eContent":return r.isEqual(e.defaultValues("eContent"));default:throw new Error("Invalid member name for EncapsulatedContentInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.eContentType||""}),new u.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new u.Any({name:t.eContent||""})]})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=r(54),s=n(u),l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(s.default);t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(131),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.mac=(0,l.getParametersValue)(t,"mac",e.defaultValues("mac")),this.macSalt=(0,l.getParametersValue)(t,"macSalt",e.defaultValues("macSalt")),"iterations"in t&&(this.iterations=(0,l.getParametersValue)(t,"iterations",e.defaultValues("iterations"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{mac:{names:{blockName:"mac"}},macSalt:"macSalt",iterations:"iterations"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for MacData");this.mac=new f.default({schema:r.result.mac}),this.macSalt=r.result.macSalt,"iterations"in r.result&&(this.iterations=r.result.iterations.valueBlock.valueDec)}},{key:"toSchema",value:function(){var e=[this.mac.toSchema(),this.macSalt];return"iterations"in this&&e.push(new s.Integer({value:this.iterations})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return"iterations"in this&&(e.iterations=this.iterations.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"mac":return new f.default;case"macSalt":return new s.OctetString;case"iterations":return 1;default:throw new Error("Invalid member name for MacData class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"mac":return f.default.compareWithDefault("digestAlgorithm",r.digestAlgorithm)&&f.default.compareWithDefault("digest",r.digest);case"macSalt":return r.isEqual(e.defaultValues(t));case"iterations":return r===e.defaultValues(t);default:throw new Error("Invalid member name for MacData class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",optional:t.optional||!0,value:[f.default.schema(t.mac||{names:{blockName:"mac"}}),new s.OctetString({name:t.macSalt||"macSalt"}),new s.Integer({optional:!0,name:t.iterations||"iterations"})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.hashAlgorithm=(0,l.getParametersValue)(t,"hashAlgorithm",e.defaultValues("hashAlgorithm")),this.hashedMessage=(0,l.getParametersValue)(t,"hashedMessage",e.defaultValues("hashedMessage")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},hashedMessage:"hashedMessage"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for MessageImprint");this.hashAlgorithm=new f.default({schema:r.result.hashAlgorithm}),this.hashedMessage=r.result.hashedMessage}},{key:"toSchema",value:function(){return new s.Sequence({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}},{key:"toJSON",value:function(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"hashAlgorithm":return new f.default;case"hashedMessage":return new s.OctetString;default:throw new Error("Invalid member name for MessageImprint class: "+e);
}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"hashAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"hashedMessage":return 0===r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for MessageImprint class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.hashAlgorithm||{}),new s.OctetString({name:t.hashedMessage||""})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(137),h=n(f),m=r(139),d=n(m),v=r(138),p=n(v),g=r(127),y=n(g),b=r(75),w=(n(b),r(48)),k=n(w),S=r(49),C=n(S),P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbsRequest=(0,l.getParametersValue)(t,"tbsRequest",e.defaultValues("tbsRequest")),"optionalSignature"in t&&(this.optionalSignature=(0,l.getParametersValue)(t,"optionalSignature",e.defaultValues("optionalSignature"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OCSP_REQUEST");this.tbsRequest=new h.default({schema:r.result.tbsRequest}),"optionalSignature"in r.result&&(this.optionalSignature=new d.default({schema:r.result.optionalSignature}))}},{key:"toSchema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];return t.push(this.tbsRequest.toSchema(e)),"optionalSignature"in this&&t.push(this.optionalSignature.toSchema()),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var e={tbsRequest:this.tbsRequest.toJSON()};return"optionalSignature"in this&&(e.optionalSignature=this.optionalSignature.toJSON()),e}},{key:"createForCertificate",value:function(e,t){var r=this,n=Promise.resolve(),a=new y.default;return n=n.then(function(){return a.createForCertificate(e,t)}),n=n.then(function(){r.tbsRequest=new h.default({requestList:[new p.default({reqCert:a})]})},function(e){return Promise.reject(e)})}},{key:"sign",value:function(e,t){var r=this;if("undefined"==typeof e)return Promise.reject("Need to provide a private key for signing");if("undefined"==typeof t)t="SHA-1";else{var n=(0,c.getOIDByAlgorithm)({name:t});if(""===n)return Promise.reject("Unsupported hash algorithm: "+t)}if("optionalSignature"in this==!1)return Promise.reject('Need to create "optionalSignature" field before signing');var a=(0,c.getAlgorithmParameters)(e.algorithm.name,"sign");switch(a.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.optionalSignature.signatureAlgorithm.algorithmId=(0,c.getOIDByAlgorithm)(a.algorithm);break;case"RSA-PSS":switch(t.toUpperCase()){case"SHA-256":a.algorithm.saltLength=32;break;case"SHA-384":a.algorithm.saltLength=48;break;case"SHA-512":a.algorithm.saltLength=64}var i={};if("SHA-1"!==t.toUpperCase()){var o=(0,c.getOIDByAlgorithm)({name:t});if(""===o)return Promise.reject("Unsupported hash algorithm: "+t);i.hashAlgorithm=new k.default({algorithmId:o,algorithmParams:new s.Null}),i.maskGenAlgorithm=new k.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:i.hashAlgorithm.toSchema()})}20!==a.algorithm.saltLength&&(i.saltLength=a.algorithm.saltLength);var u=new C.default(i);this.optionalSignature.signatureAlgorithm=new k.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:u.toSchema()});break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}var l=this.tbsRequest.toSchema(!0).toBER(!1),f=(0,c.getCrypto)();return"undefined"==typeof f?Promise.reject("Unable to create WebCrypto object"):f.sign(a.algorithm,e,new Uint8Array(l)).then(function(e){"ECDSA"===a.algorithm.name&&(e=(0,c.createCMSECDSASignature)(e)),r.optionalSignature.signature=new s.BitString({valueHex:e})},function(e){return Promise.reject("Signing error: "+e)})}},{key:"verify",value:function(){}}],[{key:"defaultValues",value:function(e){switch(e){case"tbsRequest":return new h.default;case"optionalSignature":return new d.default;default:throw new Error("Invalid member name for OCSPRequest class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"tbsRequest":return h.default.compareWithDefault("tbs",t.tbs)&&h.default.compareWithDefault("version",t.version)&&h.default.compareWithDefault("requestorName",t.requestorName)&&h.default.compareWithDefault("requestList",t.requestList)&&h.default.compareWithDefault("requestExtensions",t.requestExtensions);case"optionalSignature":return d.default.compareWithDefault("signatureAlgorithm",t.signatureAlgorithm)&&d.default.compareWithDefault("signature",t.signature)&&d.default.compareWithDefault("certs",t.certs);default:throw new Error("Invalid member name for OCSPRequest class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"OCSPRequest",value:[h.default.schema(t.tbsRequest||{names:{blockName:"tbsRequest"}}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[d.default.schema(t.optionalSignature||{names:{blockName:"optionalSignature"}})]})]})}}]),e}();t.default=P},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(60),f=n(c),h=r(138),m=n(h),d=r(77),v=n(d),p=r(96),g=n(p),y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.tbs=(0,l.getParametersValue)(t,"tbs",e.defaultValues("tbs")),"version"in t&&(this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version"))),"requestorName"in t&&(this.requestorName=(0,l.getParametersValue)(t,"requestorName",e.defaultValues("requestorName"))),this.requestList=(0,l.getParametersValue)(t,"requestList",e.defaultValues("requestList")),"requestExtensions"in t&&(this.requestExtensions=(0,l.getParametersValue)(t,"requestExtensions",e.defaultValues("requestExtensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for TBSRequest");this.tbs=r.result.TBSRequest.valueBeforeDecode,"TBSRequest.version"in r.result&&(this.version=r.result["TBSRequest.version"].valueBlock.valueDec),"TBSRequest.requestorName"in r.result&&(this.requestorName=new f.default({schema:r.result["TBSRequest.requestorName"]})),this.requestList=Array.from(r.result["TBSRequest.requests"],function(e){return new m.default({schema:e})}),"TBSRequest.requestExtensions"in r.result&&(this.requestExtensions=Array.from(r.result["TBSRequest.requestExtensions"].valueBlock.value,function(e){return new v.default({schema:e})}))}},{key:"toSchema",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=void 0;if(t===!1){if(0===this.tbs.byteLength)return e.schema();r=s.fromBER(this.tbs).result}else{var n=[];"version"in this&&n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({value:this.version})]})),"requestorName"in this&&n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:1},value:[this.requestorName.toSchema()]})),n.push(new s.Sequence({value:Array.from(this.requestList,function(e){return e.toSchema()})})),"requestExtensions"in this&&n.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:2},value:[new s.Sequence({value:Array.from(this.requestExtensions,function(e){return e.toSchema()})})]})),r=new s.Sequence({value:n})}return r}},{key:"toJSON",value:function(){var e={};return"version"in this&&(e.version=this.version),"requestorName"in this&&(e.requestorName=this.requestorName.toJSON()),e.requestList=Array.from(this.requestList,function(e){return e.toJSON()}),"requestExtensions"in this&&(e.requestExtensions=Array.from(this.requestExtensions,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"requestorName":return new f.default;case"requestList":case"requestExtensions":return[];default:throw new Error("Invalid member name for TBSRequest class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"tbs":return 0===r.byteLength;case"version":return r===e.defaultValues(t);case"requestorName":return r.type===f.default.defaultValues("type")&&0===Object.keys(r.value).length;case"requestList":case"requestExtensions":return 0===r.length;default:throw new Error("Invalid member name for TBSRequest class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"TBSRequest",value:[new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Integer({name:t.TBSRequestVersion||"TBSRequest.version"})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[f.default.schema(t.requestorName||{names:{blockName:"TBSRequest.requestorName"}})]}),new s.Sequence({name:t.requestList||"TBSRequest.requestList",value:[new s.Repeated({name:t.requests||"TBSRequest.requests",value:m.default.schema(t.requestNames||{})})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[g.default.schema(t.extensions||{names:{blockName:t.requestExtensions||"TBSRequest.requestExtensions"}})]})]})}}]),e}();t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(127),f=n(c),h=r(77),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.reqCert=(0,l.getParametersValue)(t,"reqCert",e.defaultValues("reqCert")),"singleRequestExtensions"in t&&(this.singleRequestExtensions=(0,l.getParametersValue)(t,"singleRequestExtensions",e.defaultValues("singleRequestExtensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{reqCert:{names:{blockName:"reqCert"}},singleRequestExtensions:{names:{blockName:"singleRequestExtensions"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for Request");this.reqCert=new f.default({schema:r.result.reqCert}),"singleRequestExtensions"in r.result&&(this.singleRequestExtensions=Array.from(r.result.singleRequestExtensions.valueBlock.value,function(e){return new m.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.reqCert.toSchema()),"singleRequestExtensions"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Sequence({value:Array.from(this.singleRequestExtensions,function(e){return e.toSchema()})})]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={reqCert:this.reqCert.toJSON()};return"singleRequestExtensions"in this&&(e.singleRequestExtensions=Array.from(this.singleRequestExtensions,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"reqCert":return new f.default;case"singleRequestExtensions":return[];default:throw new Error("Invalid member name for Request class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"reqCert":return r.isEqual(e.defaultValues(t));case"singleRequestExtensions":return 0===r.length;default:throw new Error("Invalid member name for Request class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.reqCert||{}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[m.default.schema(t.extensions||{names:{blockName:t.singleRequestExtensions||""}})]})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=r(75),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.signatureAlgorithm=(0,l.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signature=(0,l.getParametersValue)(t,"signature",e.defaultValues("signature")),"certs"in t&&(this.certs=(0,l.getParametersValue)(t,"certs",e.defaultValues("certs"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{signatureAlgorithm:{names:{blockName:"signatureAlgorithm"}},signature:"signature",certs:"certs"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ocsp.Signature");this.signatureAlgorithm=new f.default({schema:r.result.signatureAlgorithm}),this.signature=r.result.signature,"certs"in r.result&&(this.certs=Array.from(r.result.certs,function(e){return new m.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),"certs"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Sequence({value:Array.from(this.certs,function(e){return e.toSchema()})})]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return"certs"in this&&(e.certs=Array.from(this.certs,function(e){return e.toJSON()})),e}}],[{key:"defaultValues",value:function(e){switch(e){case"signatureAlgorithm":return new f.default;case"signature":return new s.BitString;case"certs":return[];default:throw new Error("Invalid member name for Signature class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"signatureAlgorithm":return""===r.algorithmId&&"algorithmParams"in r==!1;case"signature":return r.isEqual(e.defaultValues(t));case"certs":return 0===r.length;default:throw new Error("Invalid member name for Signature class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[f.default.schema(t.signatureAlgorithm||{}),new s.BitString({name:t.signature||""}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Sequence({value:[new s.Repeated({name:t.certs||"",value:m.default.schema(t.certs||{})})]})]})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(141),f=n(c),h=r(124),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.responseStatus=(0,l.getParametersValue)(t,"responseStatus",e.defaultValues("responseStatus")),"responseBytes"in t&&(this.responseBytes=(0,l.getParametersValue)(t,"responseBytes",e.defaultValues("responseBytes"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OCSP_RESPONSE");this.responseStatus=r.result.responseStatus,"responseBytes"in r.result&&(this.responseBytes=new f.default({schema:r.result.responseBytes}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.responseStatus),"responseBytes"in this&&e.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:[this.responseBytes.toSchema()]})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={responseStatus:this.responseStatus.toJSON()};return"responseBytes"in this&&(e.responseBytes=this.responseBytes.toJSON()),e}},{key:"getCertificateStatus",value:function(e,t){var r=void 0,n={isForCertificate:!1,status:2};if("responseBytes"in this==!1)return n;if("1.3.6.1.5.5.7.48.1.1"!==this.responseBytes.responseType)return n;try{var a=s.fromBER(this.responseBytes.response.valueBlock.valueHex);r=new m.default({schema:a.result})}catch(e){return n}return r.getCertificateStatus(e,t)}},{key:"sign",value:function(e,t){if("1.3.6.1.5.5.7.48.1.1"===this.responseBytes.responseType){var r=s.fromBER(this.responseBytes.response.valueBlock.valueHex),n=new m.default({schema:r.result});return n.sign(e,t)}return Promise.reject("Unknown ResponseBytes type: "+this.responseBytes.responseType)}},{key:"verify",value:function(){if("responseBytes"in this==!1)return Promise.reject("Empty ResponseBytes field");if("1.3.6.1.5.5.7.48.1.1"===this.responseBytes.responseType){var e=s.fromBER(this.responseBytes.response.valueBlock.valueHex),t=new m.default({schema:e.result});return t.verify()}return Promise.reject("Unknown ResponseBytes type: "+this.responseBytes.responseType)}}],[{key:"defaultValues",value:function(e){switch(e){case"responseStatus":return new s.Enumerated;case"responseBytes":return new f.default;default:throw new Error("Invalid member name for OCSPResponse class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"responseStatus":return r.isEqual(e.defaultValues(t));case"responseBytes":return f.default.compareWithDefault("responseType",r.responseType)&&f.default.compareWithDefault("response",r.response);default:throw new Error("Invalid member name for OCSPResponse class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"OCSPResponse",value:[new s.Enumerated({name:t.responseStatus||"responseStatus"}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[f.default.schema(t.responseBytes||{names:{blockName:"responseBytes"}})]})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.responseType=(0,s.getParametersValue)(t,"responseType",e.defaultValues("responseType")),this.response=(0,s.getParametersValue)(t,"response",e.defaultValues("response")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{responseType:"responseType",response:"response"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for ResponseBytes");this.responseType=r.result.responseType.valueBlock.toString(),this.response=r.result.response}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.responseType}),this.response]})}},{key:"toJSON",value:function(){return{responseType:this.responseType,response:this.response.toJSON()}}}],[{key:"defaultValues",value:function(e){switch(e){case"responseType":return"";case"response":return new u.OctetString;default:throw new Error("Invalid member name for ResponseBytes class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"responseType":return""===r;case"response":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for ResponseBytes class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.responseType||""}),new u.OctetString({name:t.response||""})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.otherCertFormat=(0,s.getParametersValue)(t,"otherCertFormat",e.defaultValues("otherCertFormat")),this.otherCert=(0,s.getParametersValue)(t,"otherCert",e.defaultValues("otherCert")),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for OtherCertificateFormat");this.otherCertFormat=r.result.otherCertFormat.valueBlock.toString(),this.otherCert=r.result.otherCert}},{key:"toSchema",value:function(){return new u.Sequence({value:[new u.ObjectIdentifier({value:this.otherCertFormat}),this.otherCert]})}},{key:"toJSON",value:function(){var e={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof u.Any||(e.otherCert=this.otherCert.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"otherCertFormat":return"";case"otherCert":return new u.Any;default:throw new Error("Invalid member name for OtherCertificateFormat class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.ObjectIdentifier({name:t.otherCertFormat||"otherCertFormat"}),new u.Any({name:t.otherCert||"otherCert"})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(66),h=n(f),m=r(134),d=n(m),v=r(131),p=n(v),g=r(48),y=n(g),b=r(144),w=n(b),k=r(132),S=n(k),C=r(55),P=n(C),A=r(145),I=n(A),_=r(109),O=n(_),B=r(146),E=n(B),N=r(65),j=n(N),V=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.authSafe=(0,l.getParametersValue)(t,"authSafe",e.defaultValues("authSafe")),"macData"in t&&(this.macData=(0,l.getParametersValue)(t,"macData",e.defaultValues("macData"))),"parsedValue"in t&&(this.parsedValue=(0,l.getParametersValue)(t,"parsedValue",e.defaultValues("parsedValue"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{version:"version",authSafe:{names:{blockName:"authSafe"}},macData:{names:{blockName:"macData"}}}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PFX");this.version=r.result.version.valueBlock.valueDec,this.authSafe=new h.default({schema:r.result.authSafe}),"macData"in r.result&&(this.macData=new d.default({schema:r.result.macData}))}},{key:"toSchema",value:function(){var e=[new s.Integer({value:this.version}),this.authSafe.toSchema()];return"macData"in this&&e.push(this.macData.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={version:this.version,authSafe:this.authSafe.toJSON()};return"macData"in this&&(e.macData=this.macData.toJSON()),e}},{key:"makeInternalValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t instanceof Object==!1)return Promise.reject('The "parameters" must has "Object" type');if("parsedValue"in this==!1)return Promise.reject('Please call "parseValues" function first in order to make "parsedValue" data');if("integrityMode"in this.parsedValue==!1)return Promise.reject('Absent mandatory parameter "integrityMode" inside "parsedValue"');var r=Promise.resolve(),n=(0,c.getCrypto)();if("undefined"==typeof n)return Promise.reject("Unable to create WebCrypto object");if("authenticatedSafe"in this.parsedValue==!1)return Promise.reject('Absent mandatory parameter "authenticatedSafe" in "parsedValue"');switch(this.parsedValue.integrityMode){case 0:if("iterations"in t==!1)return Promise.reject('Absent mandatory parameter "iterations"');if("pbkdf2HashAlgorithm"in t==!1)return Promise.reject('Absent mandatory parameter "pbkdf2HashAlgorithm"');if("hmacHashAlgorithm"in t==!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("password"in t==!1)return Promise.reject('Absent mandatory parameter "password"');var a=new ArrayBuffer(64),i=new Uint8Array(a);(0,c.getRandomValues)(i);var o=void 0;switch(t.hmacHashAlgorithm.toLowerCase()){case"sha-1":o=160;break;case"sha-256":o=256;break;case"sha-384":o=384;break;case"sha-512":o=512;break;default:return Promise.reject('Incorrect "parameters.hmacHashAlgorithm" parameter: '+t.hmacHashAlgorithm)}var u={name:"HMAC",length:o,hash:{name:t.hmacHashAlgorithm}};r=r.then(function(){var e=new Uint8Array(t.password);return n.importKey("raw",e,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),r=r.then(function(e){return n.deriveKey({name:"PBKDF2",hash:{name:t.pbkdf2HashAlgorithm},salt:i,iterations:t.iterations},e,u,!1,["sign"])},function(e){return Promise.reject(e)}),r=r.then(function(t){e.authSafe=new h.default({contentType:"1.2.840.113549.1.7.1",content:new s.OctetString({valueHex:e.parsedValue.authenticatedSafe.toSchema().toBER(!1)})});var r=e.authSafe.content.toBER(!1),a=new Uint8Array(r);return n.sign(u,t,a)},function(e){return Promise.reject(e)}),r=r.then(function(r){e.macData=new d.default({mac:new p.default({digestAlgorithm:new y.default({algorithmId:(0,c.getOIDByAlgorithm)({name:t.hmacHashAlgorithm})}),digest:new s.OctetString({valueHex:r})}),macSalt:new s.OctetString({valueHex:a}),iterations:t.iterations})},function(e){return Promise.reject(e)});break;case 1:if("signingCertificate"in t==!1)return Promise.reject('Absent mandatory parameter "signingCertificate"');if("privateKey"in t==!1)return Promise.reject('Absent mandatory parameter "privateKey"');if("hashAlgorithm"in t==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');var l=this.parsedValue.authenticatedSafe.toSchema().toBER(!1),f=new w.default({version:1,encapContentInfo:new S.default({eContentType:"1.2.840.113549.1.7.1",eContent:new s.OctetString({valueHex:l})}),certificates:[t.signingCertificate]});r=r.then(function(){return n.digest({name:t.hashAlgorithm},new Uint8Array(l))}),r=r.then(function(e){var r=[];r.push(new P.default({type:"1.2.840.113549.1.9.3",values:[new s.ObjectIdentifier({value:"1.2.840.113549.1.7.1"})]})),r.push(new P.default({type:"1.2.840.113549.1.9.5",values:[new s.UTCTime({valueDate:new Date})]})),r.push(new P.default({type:"1.2.840.113549.1.9.4",values:[new s.OctetString({valueHex:e})]})),f.signerInfos.push(new I.default({version:1,sid:new O.default({issuer:t.signingCertificate.issuer,serialNumber:t.signingCertificate.serialNumber}),signedAttrs:new E.default({type:0,attributes:r})}))},function(e){return Promise.reject("Error during making digest for message: "+e)}),r=r.then(function(){return f.sign(t.privateKey,0,t.hashAlgorithm)}),r=r.then(function(){e.authSafe=new h.default({contentType:"1.2.840.113549.1.7.2",content:f.toSchema(!0)})},function(e){return Promise.reject("Error during making signature: "+e)});break;default:return Promise.reject('Parameter "integrityMode" has unknown value: '+t.integrityMode)}return r}},{key:"parseInternalValues",value:function(e){var t=this;if(e instanceof Object==!1)return Promise.reject('The "parameters" must has "Object" type');"checkIntegrity"in e==!1&&(e.checkIntegrity=!0);var r=Promise.resolve(),n=(0,c.getCrypto)();if("undefined"==typeof n)return Promise.reject("Unable to create WebCrypto object");switch(this.parsedValue={},this.authSafe.contentType){case"1.2.840.113549.1.7.1":if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if(this.parsedValue.integrityMode=0,this.authSafe.content instanceof s.OctetString==!1)return Promise.reject('Wrong type of "this.authSafe.content"');var a=s.fromBER(this.authSafe.content.valueBlock.valueHex);if(a.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "this.authSafe.content"');if(this.parsedValue.authenticatedSafe=new j.default({schema:a.result}),e.checkIntegrity){if("macData"in this==!1)return Promise.reject('Absent "macData" value, can not check PKCS# data integrity');
var i=(0,c.getAlgorithmByOID)(this.macData.mac.digestAlgorithm.algorithmId);if("name"in i==!1)return Promise.reject("Unsupported digest algorithm: "+this.macData.mac.digestAlgorithm.algorithmId);var o=void 0;switch(i.name.toLowerCase()){case"sha-1":o=160;break;case"sha-256":o=256;break;case"sha-384":o=384;break;case"sha-512":o=512;break;default:return Promise.reject('Incorrect "hashAlgorithm": '+i.name)}var u={name:"HMAC",length:o,hash:{name:i.name}};r=r.then(function(){var t=new Uint8Array(e.password);return n.importKey("raw",t,"PBKDF2",!1,["deriveKey"])},function(e){return Promise.reject(e)}),r=r.then(function(e){return n.deriveKey({name:"PBKDF2",hash:{name:i.name},salt:new Uint8Array(t.macData.macSalt.valueBlock.valueHex),iterations:t.macData.iterations},e,u,!1,["verify"])},function(e){return Promise.reject(e)}),r=r.then(function(e){var r=t.authSafe.content.toBER(!1),a=new Uint8Array(r);return n.verify(u,e,new Uint8Array(t.macData.mac.digest.valueBlock.valueHex),a)},function(e){return Promise.reject(e)}),r=r.then(function(e){if(e===!1)return Promise.reject("Integrity for the PKCS#12 data is broken!")},function(e){return Promise.reject(e)})}break;case"1.2.840.113549.1.7.2":this.parsedValue.integrityMode=1;var f=new w.default({schema:this.authSafe.content});if("eContent"in f.encapContentInfo==!1)return Promise.reject('Absent of attached data in "cmsSigned.encapContentInfo"');if(f.encapContentInfo.eContent instanceof s.OctetString==!1)return Promise.reject('Wrong type of "cmsSigned.encapContentInfo.eContent"');var h=new ArrayBuffer(0);if(f.encapContentInfo.eContent.idBlock.isConstructed===!1)h=f.encapContentInfo.eContent.valueBlock.valueHex;else for(var m=0;m<f.encapContentInfo.eContent.valueBlock.value.length;m++)h=(0,l.utilConcatBuf)(h,f.encapContentInfo.eContent.valueBlock.value[m].valueBlock.valueHex);var d=s.fromBER(h);if(d.offset===-1)return Promise.reject('Error during parsing of ASN.1 data inside "this.authSafe.content"');this.parsedValue.authenticatedSafe=new j.default({schema:d.result}),r=r.then(function(){return f.verify({signer:0,checkChain:!1})}).then(function(e){if(e===!1)return Promise.reject("Integrity for the PKCS#12 data is broken!")},function(e){return Promise.reject("Error during integrity verification: "+e)});break;default:return Promise.reject('Incorrect value for "this.authSafe.contentType": '+this.authSafe.contentType)}return r.then(function(){return t},function(e){return Promise.reject("Error during parsing: "+e)})}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 3;case"authSafe":return new h.default;case"macData":return new d.default;case"parsedValue":return{};default:throw new Error("Invalid member name for PFX class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===e.defaultValues(t);case"authSafe":return h.default.compareWithDefault("contentType",r.contentType)&&h.default.compareWithDefault("content",r.content);case"macData":return d.default.compareWithDefault("mac",r.mac)&&d.default.compareWithDefault("macSalt",r.macSalt)&&d.default.compareWithDefault("iterations",r.iterations);case"parsedValue":return r instanceof Object&&0===Object.keys(r).length;default:throw new Error("Invalid member name for PFX class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"",value:[new s.Integer({name:t.version||"version"}),h.default.schema(t.authSafe||{names:{blockName:"authSafe"}}),d.default.schema(t.macData||{names:{blockName:"macData",optional:!0}})]})}}]),e}();t.default=V},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(43),c=a(l),f=r(44),h=r(47),m=r(48),d=n(m),v=r(132),p=n(v),g=r(75),y=n(g),b=r(142),w=n(b),k=r(98),S=n(k),C=r(105),P=n(C),A=r(145),I=n(A),_=r(103),O=n(_),B=r(104),E=n(B),N=r(109),j=n(N),V=r(147),x=n(V),R=r(128),D=n(R),T=r(124),U=n(T),H=r(49),K=n(H),q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.version=(0,f.getParametersValue)(t,"version",e.defaultValues("version")),this.digestAlgorithms=(0,f.getParametersValue)(t,"digestAlgorithms",e.defaultValues("digestAlgorithms")),this.encapContentInfo=(0,f.getParametersValue)(t,"encapContentInfo",e.defaultValues("encapContentInfo")),"certificates"in t&&(this.certificates=(0,f.getParametersValue)(t,"certificates",e.defaultValues("certificates"))),"crls"in t&&(this.crls=(0,f.getParametersValue)(t,"crls",e.defaultValues("crls"))),this.signerInfos=(0,f.getParametersValue)(t,"signerInfos",e.defaultValues("signerInfos")),"schema"in t&&this.fromSchema(t.schema)}return s(e,[{key:"fromSchema",value:function(t){var r=c.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_SIGNED_DATA");this.version=r.result["SignedData.version"].valueBlock.valueDec,"SignedData.digestAlgorithms"in r.result&&(this.digestAlgorithms=Array.from(r.result["SignedData.digestAlgorithms"],function(e){return new d.default({schema:e})})),this.encapContentInfo=new p.default({schema:r.result["SignedData.encapContentInfo"]}),"SignedData.certificates"in r.result&&(this.certificates=Array.from(r.result["SignedData.certificates"],function(e){return 1===e.idBlock.tagClass?new y.default({schema:e}):3===e.idBlock.tagClass&&3===e.idBlock.tagNumber?(e.idBlock.tagClass=1,e.idBlock.tagNumber=16,new w.default({schema:e})):new y.default})),"SignedData.crls"in r.result&&(this.crls=Array.from(r.result["SignedData.crls"],function(e){return 1===e.idBlock.tagClass?new S.default({schema:e}):(e.idBlock.tagClass=1,e.idBlock.tagNumber=16,new P.default({schema:e}))})),"SignedData.signerInfos"in r.result&&(this.signerInfos=Array.from(r.result["SignedData.signerInfos"],function(e){return new I.default({schema:e})}))}},{key:"toSchema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];return t.push(new c.Integer({value:this.version})),t.push(new c.Set({value:Array.from(this.digestAlgorithms,function(t){return t.toSchema(e)})})),t.push(this.encapContentInfo.toSchema()),"certificates"in this&&t.push(new c.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.certificates,function(t){if(t instanceof w.default){var r=t.toSchema(e);return r.idBlock.tagClass=3,r.idBlock.tagNumber=3,r}return t.toSchema(e)})})),"crls"in this&&t.push(new c.Constructed({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,function(t){if(t instanceof P.default){var r=t.toSchema(e);return r.idBlock.tagClass=3,r.idBlock.tagNumber=1,r}return t.toSchema(e)})})),t.push(new c.Set({value:Array.from(this.signerInfos,function(t){return t.toSchema(e)})})),new c.Sequence({value:t})}},{key:"toJSON",value:function(){var e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,function(e){return e.toJSON()}),encapContentInfo:this.encapContentInfo.toJSON()};return"certificates"in this&&(e.certificates=Array.from(this.certificates,function(e){return e.toJSON()})),"crls"in this&&(e.crls=Array.from(this.crls,function(e){return e.toJSON()})),e.signerInfos=Array.from(this.signerInfos,function(e){return e.toJSON()}),e}},{key:"verify",value:function(){function e(e){if(e.issuer.isEqual(I.issuer)===!0&&e.serialNumber.isEqual(I.serialNumber)===!0)return null;var t=!1,r=!0,n=!1,a=void 0;try{for(var i,o=e.extensions[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;"2.5.29.19"===u.extnID&&"cA"in u.parsedValue&&u.parsedValue.cA===!0&&(t=!0)}}catch(e){n=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw a}}return t?e:null}var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.signer,a=void 0===n?-1:n,o=r.data,s=void 0===o?new ArrayBuffer(0):o,l=r.trustedCerts,m=void 0===l?[]:l,d=r.checkDate,v=void 0===d?new Date:d,p=r.checkChain,g=void 0!==p&&p,b=(r.includeSignerCertificate,r.extendedMode),w=void 0!==b&&b,k=Promise.resolve(),C=new ArrayBuffer(0),P=void 0,A="",I={},_=(0,h.getCrypto)();return"undefined"==typeof _?Promise.reject("Unable to create WebCrypto object"):a===-1?w?Promise.reject({date:v,code:1,message:"Unable to get signer index from input parameters",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to get signer index from input parameters"):"certificates"in this==!1?w?Promise.reject({date:v,code:2,message:"No certificates attached to this signed data",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("No certificates attached to this signed data"):(k=this.signerInfos[a].sid instanceof j.default?k.then(function(){var e=!0,r=!1,n=void 0;try{for(var i,o=t.certificates[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var u=i.value;if(u instanceof y.default!=!1&&u.issuer.isEqual(t.signerInfos[a].sid.issuer)&&u.serialNumber.isEqual(t.signerInfos[a].sid.serialNumber))return I=u,Promise.resolve()}}catch(e){r=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}return w?Promise.reject({date:v,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to find signer certificate")}):k.then(function(){return Promise.all(Array.from(t.certificates.filter(function(e){return e instanceof y.default}),function(e){return _.digest({name:"sha-1"},new Uint8Array(e.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))})).then(function(e){var r=!0,n=!1,i=void 0;try{for(var o,s=t.certificates.entries()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=u(o.value,2),c=l[0],h=l[1];if(h instanceof y.default!=!1&&(0,f.isEqualBuffer)(e[c],t.signerInfos[a].sid.valueBlock.valueHex))return I=h,Promise.resolve()}}catch(e){n=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw i}}return w?Promise.reject({date:v,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to find signer certificate")},function(){return w?Promise.reject({date:v,code:3,message:"Unable to find signer certificate",signatureVerified:null,signerCertificate:null,signerCertificateVerified:null}):Promise.reject("Unable to find signer certificate")})}),k=k.then(function(){if("1.2.840.113549.1.9.16.1.4"===t.encapContentInfo.eContentType){if("eContent"in t.encapContentInfo==!1)return!1;var e=c.fromBER(t.encapContentInfo.eContent.valueBlock.valueHex),r=void 0;try{r=new x.default({schema:e.result})}catch(e){return!1}return 0===s.byteLength?w?Promise.reject({date:v,code:4,message:"Missed detached data input array",signatureVerified:null,signerCertificate:I,signerCertificateVerified:null}):Promise.reject("Missed detached data input array"):r.verify({data:s})}return!0}),g&&(k=k.then(function(r){return r!==!1&&Promise.all(Array.from(t.certificates.filter(function(e){return e instanceof y.default}),function(t){return e(t)})).then(function(e){var r,n=new D.default({checkDate:v,certs:Array.from(e.filter(function(e){return null!==e})),trustedCerts:m});if(n.certs.push(I),"crls"in t){var a=!0,o=!1,u=void 0;try{for(var s,l=t.crls[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;c instanceof S.default?n.crls.push(c):"1.3.6.1.5.5.7.48.1.1"===c.otherRevInfoFormat&&n.ocsps.push(new U.default({schema:c.otherRevInfo}))}}catch(e){o=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw u}}}return"ocsps"in t&&(r=n.ocsps).push.apply(r,i(t.ocsps)),n.verify().then(function(e){return e.result===!0?Promise.resolve(!0):w?Promise.reject({date:v,code:5,message:"Validation of signer's certificate failed: "+e.resultMessage,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!1}):Promise.reject("Validation of signer's certificate failed")},function(e){return w?Promise.reject({date:v,code:5,message:"Validation of signer's certificate failed with error: "+(e instanceof Object?e.resultMessage:e),signatureVerified:null,signerCertificate:I,signerCertificateVerified:!1}):Promise.reject("Validation of signer's certificate failed with error: "+(e instanceof Object?e.resultMessage:e))})},function(e){return w?Promise.reject({date:v,code:6,message:"Error during checking certificates for CA flag: "+e,signatureVerified:null,signerCertificate:I,signerCertificateVerified:null}):Promise.reject("Error during checking certificates for CA flag: "+e)})})),k=k.then(function(e){if(e===!1)return!1;var r=(0,h.getAlgorithmByOID)(t.signerInfos[a].digestAlgorithm.algorithmId);return"name"in r==!1?w?Promise.reject({date:v,code:7,message:"Unsupported signature algorithm: "+t.signerInfos[a].digestAlgorithm.algorithmId,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject("Unsupported signature algorithm: "+t.signerInfos[a].digestAlgorithm.algorithmId):(A=r.name,!0)}),k=k.then(function(e){if(e===!1)return!1;if("eContent"in t.encapContentInfo)if(1===t.encapContentInfo.eContent.idBlock.tagClass&&4===t.encapContentInfo.eContent.idBlock.tagNumber)if(t.encapContentInfo.eContent.idBlock.isConstructed===!1)s=t.encapContentInfo.eContent.valueBlock.valueHex;else{var r=!0,n=!1,i=void 0;try{for(var o,u=t.encapContentInfo.eContent.valueBlock.value[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value;s=(0,f.utilConcatBuf)(s,l.valueBlock.valueHex)}}catch(e){n=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw i}}}else s=t.encapContentInfo.eContent.valueBlock.valueHex;else if(0===s.byteLength)return w?Promise.reject({date:v,code:8,message:"Missed detached data input array",signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject("Missed detached data input array");if("signedAttrs"in t.signerInfos[a]){var c=!1,h=!1,m=!0,d=!1,p=void 0;try{for(var g,y=t.signerInfos[a].signedAttrs.attributes[Symbol.iterator]();!(m=(g=y.next()).done);m=!0){var b=g.value;if("1.2.840.113549.1.9.3"===b.type&&(c=!0),"1.2.840.113549.1.9.4"===b.type&&(h=!0,C=b.values[0].valueBlock.valueHex),c&&h)break}}catch(e){d=!0,p=e}finally{try{!m&&y.return&&y.return()}finally{if(d)throw p}}if(c===!1)return w?Promise.reject({date:v,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject('Attribute "content-type" is a mandatory attribute for "signed attributes"');if(h===!1)return w?Promise.reject({date:v,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject('Attribute "message-digest" is a mandatory attribute for "signed attributes"')}return!0}),k=k.then(function(e){if(e===!1)return!1;var t=void 0;t="1.2.840.113549.1.1.10"===I.signatureAlgorithm.algorithmId?I.signatureAlgorithm.algorithmId:I.subjectPublicKeyInfo.algorithm.algorithmId;var r=(0,h.getAlgorithmByOID)(t);if("name"in r==!1)return w?Promise.reject({date:v,code:11,message:"Unsupported public key algorithm: "+t,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject("Unsupported public key algorithm: "+t);var n=(0,h.getAlgorithmParameters)(r.name,"importkey");if("hash"in n.algorithm&&(n.algorithm.hash.name=A),"ECDSA"===r.name){var a=!1;if("algorithmParams"in I.subjectPublicKeyInfo.algorithm==!0&&"idBlock"in I.subjectPublicKeyInfo.algorithm.algorithmParams&&1===I.subjectPublicKeyInfo.algorithm.algorithmParams.idBlock.tagClass&&6===I.subjectPublicKeyInfo.algorithm.algorithmParams.idBlock.tagNumber&&(a=!0),a===!1)return Promise.reject("Incorrect type for ECDSA public key parameters");var i=(0,h.getAlgorithmByOID)(I.subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());if("name"in i==!1)return Promise.reject("Unsupported named curve algorithm: "+I.subjectPublicKeyInfo.algorithm.algorithmParams.valueBlock.toString());n.algorithm.namedCurve=i.name}var o=I.subjectPublicKeyInfo.toSchema(),u=o.toBER(!1),s=new Uint8Array(u);return _.importKey("spki",s,n.algorithm,!0,n.usages)}),k=k.then(function(e){return"boolean"!=typeof e&&(P=e,!("signedAttrs"in t.signerInfos[a])||_.digest(A,new Uint8Array(s)))}).then(function(e){return e!==!1&&(!("signedAttrs"in t.signerInfos[a])||!!(0,f.isEqualBuffer)(e,C)&&(s=t.signerInfos[a].signedAttrs.encodedValue,!0))}).then(function(e){if(e===!1)return!1;var r=(0,h.getAlgorithmParameters)(P.algorithm.name,"verify");if("hash"in r.algorithm&&(r.algorithm.hash.name=A),"RSA-PSS"===P.algorithm.name){var n=void 0;try{n=new K.default({schema:t.signerInfos[a].signatureAlgorithm.algorithmParams})}catch(e){return w?Promise.reject({date:v,code:12,message:e,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject(e)}"saltLength"in n?r.algorithm.saltLength=n.saltLength:r.algorithm.saltLength=20;var i="SHA-1";if("hashAlgorithm"in n){var o=(0,h.getAlgorithmByOID)(n.hashAlgorithm.algorithmId);if("name"in o==!1)return w?Promise.reject({date:v,code:13,message:"Unrecognized hash algorithm: "+n.hashAlgorithm.algorithmId,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject("Unrecognized hash algorithm: "+n.hashAlgorithm.algorithmId);i=o.name}r.algorithm.hash.name=i}var u=t.signerInfos[a].signature.valueBlock.valueHex;if("ECDSA"===P.algorithm.name){var l=c.fromBER(u);u=(0,h.createECDSASignatureFromCMS)(l.result)}return _.verify(r.algorithm,P,new Uint8Array(u),new Uint8Array(s))}),k=k.then(function(e){return w?{date:v,code:14,message:"",signatureVerified:e,signerCertificate:I,signerCertificateVerified:!0}:e},function(e){return w?"code"in e?Promise.reject(e):Promise.reject({date:v,code:15,message:"Error during verification: "+e.message,signatureVerified:null,signerCertificate:I,signerCertificateVerified:!0}):Promise.reject(e)}))}},{key:"sign",value:function(e,t,r,n){var a=this;n=n||new ArrayBuffer(0);var i="";if("undefined"==typeof e)return Promise.reject("Need to provide a private key for signing");if("undefined"==typeof r&&(r="SHA-1"),i=(0,h.getOIDByAlgorithm)({name:r}),""===i)return Promise.reject("Unsupported hash algorithm: "+r);0===this.digestAlgorithms.filter(function(e){return e.algorithmId===i}).length&&this.digestAlgorithms.push(new d.default({algorithmId:i,algorithmParams:new c.Null})),this.signerInfos[t].digestAlgorithm=new d.default({algorithmId:i,algorithmParams:new c.Null});var o=(0,h.getAlgorithmParameters)(e.algorithm.name,"sign");switch(o.algorithm.hash.name=r,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":this.signerInfos[t].signatureAlgorithm.algorithmId=(0,h.getOIDByAlgorithm)(o.algorithm);break;case"RSA-PSS":switch(r.toUpperCase()){case"SHA-256":o.algorithm.saltLength=32;break;case"SHA-384":o.algorithm.saltLength=48;break;case"SHA-512":o.algorithm.saltLength=64}var u={};if("SHA-1"!==r.toUpperCase()){if(i=(0,h.getOIDByAlgorithm)({name:r}),""===i)return Promise.reject("Unsupported hash algorithm: "+r);u.hashAlgorithm=new d.default({algorithmId:i,algorithmParams:new c.Null}),u.maskGenAlgorithm=new d.default({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:u.hashAlgorithm.toSchema()})}20!==o.algorithm.saltLength&&(u.saltLength=o.algorithm.saltLength);var s=new K.default(u);this.signerInfos[t].signatureAlgorithm=new d.default({algorithmId:"1.2.840.113549.1.1.10",algorithmParams:s.toSchema()});break;default:return Promise.reject("Unsupported signature algorithm: "+e.algorithm.name)}if("signedAttrs"in this.signerInfos[t])if(0!==this.signerInfos[t].signedAttrs.encodedValue.byteLength)n=this.signerInfos[t].signedAttrs.encodedValue;else{n=this.signerInfos[t].signedAttrs.toSchema(!0).toBER(!1);var l=new Uint8Array(n);l[0]=49}else if("eContent"in this.encapContentInfo)if(1===this.encapContentInfo.eContent.idBlock.tagClass&&4===this.encapContentInfo.eContent.idBlock.tagNumber)if(this.encapContentInfo.eContent.idBlock.isConstructed===!1)n=this.encapContentInfo.eContent.valueBlock.valueHex;else{var m=!0,v=!1,p=void 0;try{for(var g,y=this.encapContentInfo.eContent.valueBlock.value[Symbol.iterator]();!(m=(g=y.next()).done);m=!0){var b=g.value;n=(0,f.utilConcatBuf)(n,b.valueBlock.valueHex)}}catch(e){v=!0,p=e}finally{try{!m&&y.return&&y.return()}finally{if(v)throw p}}}else n=this.encapContentInfo.eContent.valueBlock.valueHex;else if(0===n.byteLength)return Promise.reject("Missed detached data input array");var w=(0,h.getCrypto)();return"undefined"==typeof w?Promise.reject("Unable to create WebCrypto object"):w.sign(o.algorithm,e,new Uint8Array(n)).then(function(e){return"ECDSA"===o.algorithm.name&&(e=(0,h.createCMSECDSASignature)(e)),a.signerInfos[t].signature=new c.OctetString({valueHex:e}),e},function(e){return Promise.reject("Signing error: "+e)})}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"digestAlgorithms":return[];case"encapContentInfo":return new p.default;case"certificates":return[];case"crls":return[];case"signerInfos":return[];default:throw new Error("Invalid member name for SignedData class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return r===e.defaultValues("version");case"encapContentInfo":return new p.default;case"digestAlgorithms":case"certificates":case"crls":case"signerInfos":return 0===r.length;default:throw new Error("Invalid member name for SignedData class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,f.getParametersValue)(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new c.Sequence({name:t.blockName||"SignedData",optional:t.optional,value:[new c.Integer({name:t.version||"SignedData.version"}),new c.Set({value:[new c.Repeated({name:t.digestAlgorithms||"SignedData.digestAlgorithms",value:d.default.schema()})]}),p.default.schema(t.encapContentInfo||{names:{blockName:"SignedData.encapContentInfo"}}),new c.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:O.default.schema(t.certificates||{names:{certificates:"SignedData.certificates"}}).valueBlock.value}),new c.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:E.default.schema(t.crls||{names:{crls:"SignedData.crls"}}).valueBlock.value}),new c.Set({value:[new c.Repeated({name:t.signerInfos||"SignedData.signerInfos",value:I.default.schema()})]})]})}}]),e}();t.default=q},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(48),f=n(c),h=r(146),m=n(h),d=r(109),v=n(d),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.sid=(0,l.getParametersValue)(t,"sid",e.defaultValues("sid")),this.digestAlgorithm=(0,l.getParametersValue)(t,"digestAlgorithm",e.defaultValues("digestAlgorithm")),"signedAttrs"in t&&(this.signedAttrs=(0,l.getParametersValue)(t,"signedAttrs",e.defaultValues("signedAttrs"))),this.signatureAlgorithm=(0,l.getParametersValue)(t,"signatureAlgorithm",e.defaultValues("signatureAlgorithm")),this.signature=(0,l.getParametersValue)(t,"signature",e.defaultValues("signature")),"unsignedAttrs"in t&&(this.unsignedAttrs=(0,l.getParametersValue)(t,"unsignedAttrs",e.defaultValues("unsignedAttrs"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for CMS_SIGNER_INFO");this.version=r.result["SignerInfo.version"].valueBlock.valueDec;var n=r.result["SignerInfo.sid"];1===n.idBlock.tagClass?this.sid=new v.default({schema:n}):this.sid=n,this.digestAlgorithm=new f.default({schema:r.result["SignerInfo.digestAlgorithm"]}),"SignerInfo.signedAttrs"in r.result&&(this.signedAttrs=new m.default({type:0,schema:r.result["SignerInfo.signedAttrs"]})),this.signatureAlgorithm=new f.default({schema:r.result["SignerInfo.signatureAlgorithm"]}),this.signature=r.result["SignerInfo.signature"],"SignerInfo.unsignedAttrs"in r.result&&(this.unsignedAttrs=new m.default({type:1,schema:r.result["SignerInfo.unsignedAttrs"]}))}},{key:"toSchema",value:function(){if(e.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');var t=[];return t.push(new s.Integer({value:this.version})),this.sid instanceof v.default?t.push(this.sid.toSchema()):t.push(this.sid),t.push(this.digestAlgorithm.toSchema()),"signedAttrs"in this&&e.compareWithDefault("signedAttrs",this.signedAttrs)===!1&&t.push(this.signedAttrs.toSchema()),t.push(this.signatureAlgorithm.toSchema()),t.push(this.signature),"unsignedAttrs"in this&&e.compareWithDefault("unsignedAttrs",this.unsignedAttrs)===!1&&t.push(this.unsignedAttrs.toSchema()),new s.Sequence({value:t})}},{key:"toJSON",value:function(){if(e.compareWithDefault("sid",this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');var t={version:this.version};return this.sid instanceof s.Any||(t.sid=this.sid.toJSON()),t.digestAlgorithm=this.digestAlgorithm.toJSON(),e.compareWithDefault("signedAttrs",this.signedAttrs)===!1&&(t.signedAttrs=this.signedAttrs.toJSON()),t.signatureAlgorithm=this.signatureAlgorithm.toJSON(),t.signature=this.signature.toJSON(),e.compareWithDefault("unsignedAttrs",this.unsignedAttrs)===!1&&(t.unsignedAttrs=this.unsignedAttrs.toJSON()),t}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"sid":return new s.Any;case"digestAlgorithm":return new f.default;case"signedAttrs":return new m.default({type:0});case"signatureAlgorithm":return new f.default;case"signature":return new s.OctetString;case"unsignedAttrs":return new m.default({type:1});default:throw new Error("Invalid member name for SignerInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":return e.defaultValues("version")===r;case"sid":return r instanceof s.Any;case"digestAlgorithm":return r instanceof f.default!=!1&&r.isEqual(e.defaultValues("digestAlgorithm"));case"signedAttrs":return m.default.compareWithDefault("type",r.type)&&m.default.compareWithDefault("attributes",r.attributes)&&m.default.compareWithDefault("encodedValue",r.encodedValue);case"signatureAlgorithm":return r instanceof f.default!=!1&&r.isEqual(e.defaultValues("signatureAlgorithm"));case"signature":case"unsignedAttrs":return m.default.compareWithDefault("type",r.type)&&m.default.compareWithDefault("attributes",r.attributes)&&m.default.compareWithDefault("encodedValue",r.encodedValue);default:throw new Error("Invalid member name for SignerInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:"SignerInfo",value:[new s.Integer({name:t.version||"SignerInfo.version"}),new s.Choice({value:[v.default.schema(t.sid||{names:{blockName:"SignerInfo.sid"}}),new s.Constructed({optional:!0,name:t.sid||"SignerInfo.sid",idBlock:{tagClass:3,tagNumber:0},value:[new s.OctetString]})]}),f.default.schema(t.digestAlgorithm||{names:{blockName:"SignerInfo.digestAlgorithm"}}),m.default.schema(t.signedAttrs||{names:{blockName:"SignerInfo.signedAttrs",tagNumber:0}}),f.default.schema(t.signatureAlgorithm||{names:{blockName:"SignerInfo.signatureAlgorithm"}}),new s.OctetString({name:t.signature||"SignerInfo.signature"}),m.default.schema(t.unsignedAttrs||{names:{blockName:"SignerInfo.unsignedAttrs",tagNumber:1}})]})}}]),e}();t.default=p},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(55),f=n(c),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.type=(0,l.getParametersValue)(t,"type",e.defaultValues("type")),this.attributes=(0,l.getParametersValue)(t,"attributes",e.defaultValues("attributes")),this.encodedValue=(0,l.getParametersValue)(t,"encodedValue",e.defaultValues("encodedValue")),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema({names:{tagNumber:this.type,attributes:"attributes"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for SignedUnsignedAttributes");this.type=r.result.idBlock.tagNumber,this.encodedValue=r.result.valueBeforeDecode;var n=new Uint8Array(this.encodedValue);if(n[0]=49,"attributes"in r.result!=!1)this.attributes=Array.from(r.result.attributes,function(e){return new f.default({schema:e})});else if(0===this.type)throw new Error("Wrong structure of SignedUnsignedAttributes")}},{key:"toSchema",value:function(){if(e.compareWithDefault("type",this.type)||e.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,function(e){return e.toSchema()})})}},{key:"toJSON",value:function(){if(e.compareWithDefault("type",this.type)||e.compareWithDefault("attributes",this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,function(e){return e.toJSON()})}}}],[{key:"defaultValues",value:function(e){switch(e){case"type":return-1;case"attributes":return[];case"encodedValue":return new ArrayBuffer(0);default:throw new Error("Invalid member name for SignedAndUnsignedAttributes class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"type":return r===e.defaultValues("type");case"attributes":return 0===r.length;case"encodedValue":return 0===r.byteLength;default:throw new Error("Invalid member name for SignedAndUnsignedAttributes class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,
l.getParametersValue)(e,"names",{});return new s.Constructed({name:t.blockName||"",optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber},value:[new s.Repeated({name:t.attributes||"",value:f.default.schema()})]})}}]),e}();t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(47),f=r(135),h=n(f),m=r(63),d=n(m),v=r(60),p=n(v),g=r(77),y=n(g),b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.policy=(0,l.getParametersValue)(t,"policy",e.defaultValues("policy")),this.messageImprint=(0,l.getParametersValue)(t,"messageImprint",e.defaultValues("messageImprint")),this.serialNumber=(0,l.getParametersValue)(t,"serialNumber",e.defaultValues("serialNumber")),this.genTime=(0,l.getParametersValue)(t,"genTime",e.defaultValues("genTime")),"accuracy"in t&&(this.accuracy=(0,l.getParametersValue)(t,"accuracy",e.defaultValues("accuracy"))),"ordering"in t&&(this.ordering=(0,l.getParametersValue)(t,"ordering",e.defaultValues("ordering"))),"nonce"in t&&(this.nonce=(0,l.getParametersValue)(t,"nonce",e.defaultValues("nonce"))),"tsa"in t&&(this.tsa=(0,l.getParametersValue)(t,"tsa",e.defaultValues("tsa"))),"extensions"in t&&(this.extensions=(0,l.getParametersValue)(t,"extensions",e.defaultValues("extensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for TST_INFO");this.version=r.result["TSTInfo.version"].valueBlock.valueDec,this.policy=r.result["TSTInfo.policy"].valueBlock.toString(),this.messageImprint=new h.default({schema:r.result["TSTInfo.messageImprint"]}),this.serialNumber=r.result["TSTInfo.serialNumber"],this.genTime=r.result["TSTInfo.genTime"].toDate(),"TSTInfo.accuracy"in r.result&&(this.accuracy=new d.default({schema:r.result["TSTInfo.accuracy"]})),"TSTInfo.ordering"in r.result&&(this.ordering=r.result["TSTInfo.ordering"].valueBlock.value),"TSTInfo.nonce"in r.result&&(this.nonce=r.result["TSTInfo.nonce"]),"TSTInfo.tsa"in r.result&&(this.tsa=new p.default({schema:r.result["TSTInfo.tsa"]})),"TSTInfo.extensions"in r.result&&(this.extensions=Array.from(r.result["TSTInfo.extensions"],function(e){return new y.default({schema:e})}))}},{key:"toSchema",value:function(){var e=[];return e.push(new s.Integer({value:this.version})),e.push(new s.ObjectIdentifier({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new s.GeneralizedTime({valueDate:this.genTime})),"accuracy"in this&&e.push(this.accuracy.toSchema()),"ordering"in this&&e.push(new s.Boolean({value:this.ordering})),"nonce"in this&&e.push(this.nonce),"tsa"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),"extensions"in this&&e.push(new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,function(e){return e.toSchema()})})),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return"accuracy"in this&&(e.accuracy=this.accuracy.toJSON()),"ordering"in this&&(e.ordering=this.ordering),"nonce"in this&&(e.nonce=this.nonce.toJSON()),"tsa"in this&&(e.tsa=this.tsa.toJSON()),"extensions"in this&&(e.extensions=Array.from(this.extensions,function(e){return e.toJSON()})),e}},{key:"verify",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Promise.resolve(),n=void 0,a=void 0,i=void 0,o=(0,c.getCrypto)();if("undefined"==typeof o)return Promise.reject("Unable to create WebCrypto object");if(!("data"in t))return Promise.reject('"data" is a mandatory attribute for TST_INFO verification');n=t.data,"notBefore"in t&&(a=t.notBefore),"notAfter"in t&&(i=t.notAfter);var u=(0,c.getAlgorithmByOID)(this.messageImprint.hashAlgorithm.algorithmId);return"name"in u==!1?Promise.reject("Unsupported signature algorithm: "+this.messageImprint.hashAlgorithm.algorithmId):r=r.then(function(){return o.digest(u.name,new Uint8Array(n))}).then(function(t){return(0,l.isEqualBuffer)(t,e.messageImprint.hashedMessage.valueBlock.valueHex)})}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"policy":return"";case"messageImprint":return new h.default;case"serialNumber":return new s.Integer;case"genTime":return new Date(0,0,0);case"accuracy":return new d.default;case"ordering":return!1;case"nonce":return new s.Integer;case"tsa":return new p.default;case"extensions":return[];default:throw new Error("Invalid member name for TSTInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":case"policy":case"genTime":case"ordering":return r===e.defaultValues(t);case"messageImprint":return h.default.compareWithDefault("hashAlgorithm",r.hashAlgorithm)&&h.default.compareWithDefault("hashedMessage",r.hashedMessage);case"serialNumber":case"nonce":return r.isEqual(e.defaultValues(t));case"accuracy":return d.default.compareWithDefault("seconds",r.seconds)&&d.default.compareWithDefault("millis",r.millis)&&d.default.compareWithDefault("micros",r.micros);case"tsa":return p.default.compareWithDefault("type",r.type)&&p.default.compareWithDefault("value",r.value);case"extensions":return 0===r.length;default:throw new Error("Invalid member name for TSTInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"TSTInfo",value:[new s.Integer({name:t.version||"TSTInfo.version"}),new s.ObjectIdentifier({name:t.policy||"TSTInfo.policy"}),h.default.schema(t.messageImprint||{names:{blockName:"TSTInfo.messageImprint"}}),new s.Integer({name:t.serialNumber||"TSTInfo.serialNumber"}),new s.GeneralizedTime({name:t.genTime||"TSTInfo.genTime"}),d.default.schema(t.accuracy||{names:{blockName:"TSTInfo.accuracy"}}),new s.Boolean({name:t.ordering||"TSTInfo.ordering",optional:!0}),new s.Integer({name:t.nonce||"TSTInfo.nonce",optional:!0}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[p.default.schema(t.tsa||{names:{blockName:"TSTInfo.tsa"}})]}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new s.Repeated({name:t.extensions||"TSTInfo.extensions",value:y.default.schema(t.extension||{})})]})]})}}]),e}();t.default=b},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(43),u=n(o),s=r(44),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.status=(0,s.getParametersValue)(t,"status",e.defaultValues("status")),"statusStrings"in t&&(this.statusStrings=(0,s.getParametersValue)(t,"statusStrings",e.defaultValues("statusStrings"))),"failInfo"in t&&(this.failInfo=(0,s.getParametersValue)(t,"failInfo",e.defaultValues("failInfo"))),"schema"in t&&this.fromSchema(t.schema)}return i(e,[{key:"fromSchema",value:function(t){var r=u.compareSchema(t,t,e.schema({names:{status:"status",statusStrings:"statusStrings",failInfo:"failInfo"}}));if(r.verified===!1)throw new Error("Object's schema was not verified against input data for PKIStatusInfo");var n=r.result.status;if(n.valueBlock.isHexOnly===!0||n.valueBlock.valueDec<0||n.valueBlock.valueDec>5)throw new Error('PKIStatusInfo "status" has invalid value');this.status=n.valueBlock.valueDec,"statusStrings"in r.result&&(this.statusStrings=r.result.statusStrings),"failInfo"in r.result&&(this.failInfo=r.result.failInfo)}},{key:"toSchema",value:function(){var e=[];return e.push(new u.Integer({value:this.status})),"statusStrings"in this&&e.push(new u.Sequence({optional:!0,value:this.statusStrings})),"failInfo"in this&&e.push(this.failInfo),new u.Sequence({value:e})}},{key:"toJSON",value:function(){var e={status:this.status};return"statusStrings"in this&&(e.statusStrings=Array.from(this.statusStrings,function(e){return e.toJSON()})),"failInfo"in this&&(e.failInfo=this.failInfo.toJSON()),e}}],[{key:"defaultValues",value:function(e){switch(e){case"status":return 2;case"statusStrings":return[];case"failInfo":return new u.BitString;default:throw new Error("Invalid member name for PKIStatusInfo class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"status":return r===e.defaultValues(t);case"statusStrings":return 0===r.length;case"failInfo":return r.isEqual(e.defaultValues(t));default:throw new Error("Invalid member name for PKIStatusInfo class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getParametersValue)(e,"names",{});return new u.Sequence({name:t.blockName||"",value:[new u.Integer({name:t.status||""}),new u.Sequence({optional:!0,value:[new u.Repeated({name:t.statusStrings||"",value:new u.Utf8String})]}),new u.BitString({name:t.failInfo||"",optional:!0})]})}}]),e}();t.default=l},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(135),f=n(c),h=r(77),m=n(h),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.version=(0,l.getParametersValue)(t,"version",e.defaultValues("version")),this.messageImprint=(0,l.getParametersValue)(t,"messageImprint",e.defaultValues("messageImprint")),"reqPolicy"in t&&(this.reqPolicy=(0,l.getParametersValue)(t,"reqPolicy",e.defaultValues("reqPolicy"))),"nonce"in t&&(this.nonce=(0,l.getParametersValue)(t,"nonce",e.defaultValues("nonce"))),"certReq"in t&&(this.certReq=(0,l.getParametersValue)(t,"certReq",e.defaultValues("certReq"))),"extensions"in t&&(this.extensions=(0,l.getParametersValue)(t,"extensions",e.defaultValues("extensions"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for TSP_REQUEST");this.version=r.result["TimeStampReq.version"].valueBlock.valueDec,this.messageImprint=new f.default({schema:r.result["TimeStampReq.messageImprint"]}),"TimeStampReq.reqPolicy"in r.result&&(this.reqPolicy=r.result["TimeStampReq.reqPolicy"].valueBlock.toString()),"TimeStampReq.nonce"in r.result&&(this.nonce=r.result["TimeStampReq.nonce"]),"TimeStampReq.certReq"in r.result&&(this.certReq=r.result["TimeStampReq.certReq"].valueBlock.value),"TimeStampReq.extensions"in r.result&&(this.extensions=Array.from(r.result["TimeStampReq.extensions"],function(e){return new m.default({schema:e})}))}},{key:"toSchema",value:function(){var t=[];return t.push(new s.Integer({value:this.version})),t.push(this.messageImprint.toSchema()),"reqPolicy"in this&&t.push(new s.ObjectIdentifier({value:this.reqPolicy})),"nonce"in this&&t.push(this.nonce),"certReq"in this&&e.compareWithDefault("certReq",this.certReq)===!1&&t.push(new s.Boolean({value:this.certReq})),"extensions"in this&&t.push(new s.Constructed({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.extensions,function(e){return e.toSchema()})})),new s.Sequence({value:t})}},{key:"toJSON",value:function(){var t={version:this.version,messageImprint:this.messageImprint.toJSON()};return"reqPolicy"in this&&(t.reqPolicy=this.reqPolicy),"nonce"in this&&(t.nonce=this.nonce.toJSON()),"certReq"in this&&e.compareWithDefault("certReq",this.certReq)===!1&&(t.certReq=this.certReq),"extensions"in this&&(t.extensions=Array.from(this.extensions,function(e){return e.toJSON()})),t}}],[{key:"defaultValues",value:function(e){switch(e){case"version":return 0;case"messageImprint":return new f.default;case"reqPolicy":return"";case"nonce":return new s.Integer;case"certReq":return!1;case"extensions":return[];default:throw new Error("Invalid member name for TimeStampReq class: "+e)}}},{key:"compareWithDefault",value:function(t,r){switch(t){case"version":case"reqPolicy":case"certReq":return r===e.defaultValues(t);case"messageImprint":return f.default.compareWithDefault("hashAlgorithm",r.hashAlgorithm)&&f.default.compareWithDefault("hashedMessage",r.hashedMessage);case"nonce":return r.isEqual(e.defaultValues(t));case"extensions":return 0===r.length;default:throw new Error("Invalid member name for TimeStampReq class: "+t)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"TimeStampReq",value:[new s.Integer({name:t.version||"TimeStampReq.version"}),f.default.schema(t.messageImprint||{names:{blockName:"TimeStampReq.messageImprint"}}),new s.ObjectIdentifier({name:t.reqPolicy||"TimeStampReq.reqPolicy",optional:!0}),new s.Integer({name:t.nonce||"TimeStampReq.nonce",optional:!0}),new s.Boolean({name:t.certReq||"TimeStampReq.certReq",optional:!0}),new s.Constructed({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new s.Repeated({name:t.extensions||"TimeStampReq.extensions",value:m.default.schema()})]})]})}}]),e}();t.default=d},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(43),s=a(u),l=r(44),c=r(148),f=n(c),h=r(66),m=n(h),d=r(144),v=n(d),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.status=(0,l.getParametersValue)(t,"status",e.defaultValues("status")),"timeStampToken"in t&&(this.timeStampToken=(0,l.getParametersValue)(t,"timeStampToken",e.defaultValues("timeStampToken"))),"schema"in t&&this.fromSchema(t.schema)}return o(e,[{key:"fromSchema",value:function(t){var r=s.compareSchema(t,t,e.schema());if(r.verified===!1)throw new Error("Object's schema was not verified against input data for TSP_RESPONSE");this.status=new f.default({schema:r.result["TimeStampResp.status"]}),"TimeStampResp.timeStampToken"in r.result&&(this.timeStampToken=new m.default({schema:r.result["TimeStampResp.timeStampToken"]}))}},{key:"toSchema",value:function(){var e=[];return e.push(this.status.toSchema()),"timeStampToken"in this&&e.push(this.timeStampToken.toSchema()),new s.Sequence({value:e})}},{key:"toJSON",value:function(){var e={status:this.status};return"timeStampToken"in this&&(e.timeStampToken=this.timeStampToken.toJSON()),e}},{key:"sign",value:function(e,t){if("timeStampToken"in this==!1)return Promise.reject("timeStampToken is absent in TSP response");if("1.2.840.113549.1.7.2"!==this.timeStampToken.contentType)return Promise.reject("Wrong format of timeStampToken: "+this.timeStampToken.contentType);var r=new m.default({schema:this.timeStampToken.content});return r.sign(e,0,t)}},{key:"verify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{signer:0,trustedCerts:[],data:new ArrayBuffer(0)};if("timeStampToken"in this==!1)return Promise.reject("timeStampToken is absent in TSP response");if("1.2.840.113549.1.7.2"!==this.timeStampToken.contentType)return Promise.reject("Wrong format of timeStampToken: "+this.timeStampToken.contentType);var t=new v.default({schema:this.timeStampToken.content});return t.verify(e)}}],[{key:"defaultValues",value:function(e){switch(e){case"status":return new f.default;case"timeStampToken":return new m.default;default:throw new Error("Invalid member name for TimeStampResp class: "+e)}}},{key:"compareWithDefault",value:function(e,t){switch(e){case"status":return f.default.compareWithDefault("status",t.status)&&"statusStrings"in t==!1&&"failInfo"in t==!1;case"timeStampToken":return""===t.contentType&&t.content instanceof s.Any;default:throw new Error("Invalid member name for TimeStampResp class: "+e)}}},{key:"schema",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.getParametersValue)(e,"names",{});return new s.Sequence({name:t.blockName||"TimeStampResp",value:[f.default.schema(t.status||{names:{blockName:"TimeStampResp.status"}}),m.default.schema(t.timeStampToken||{names:{blockName:"TimeStampResp.timeStampToken",optional:!0}})]})}}]),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),a=function(){function e(){}return e.error=function(e,t){return t&&"function"==typeof t&&t(e,null),n.Promise.reject(e)},e.response=function(e,t){return t&&"function"==typeof t&&t(null,e),n.Promise.resolve(e)},e}();t.ResponseHandler=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=function(){function e(){}return e.determineOptions=function(e,t){var r={parseCerts:!1};return e?"function"==typeof e?r.callback=e:(r.callback=t,n.has(e,"parseCerts")&&(r.parseCerts=e.parseCerts)):"function"==typeof t&&(r.callback=t),r},e.determineOptionsWithFilter=function(e){var t={parseCerts:!1,params:{}};return n.isArray(e)?e.length&&(t.params.filter=e.join(",")):n.isObject(e)&&(n.has(e,"filters")&&n.isArray(e.filters)&&e.filters.length&&(t.params.filter=e.filters.join(",")),n.has(e,"parseCerts")&&(t.parseCerts=e.parseCerts)),n.isEmpty(t.params)&&delete t.params,t},e}();t.RequestHandler=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(41),o=r(152),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.rnData=function(e){return this.connection.get(this.resolvedReaderURI()+t.RN_DATA,void 0,e)},t.prototype.address=function(e){return this.connection.get(this.resolvedReaderURI()+t.ADDRESS,void 0,e)},t.prototype.picture=function(e){return this.connection.get(this.resolvedReaderURI()+t.PHOTO,void 0,e)},t.prototype.rootCertificate=function(e,r){return this.getCertificate(t.CERT_ROOT,o.RequestHandler.determineOptions(e,r))},t.prototype.citizenCertificate=function(e,r){return this.getCertificate(t.CERT_CITIZEN,o.RequestHandler.determineOptions(e,r))},t.prototype.authenticationCertificate=function(e,r){return this.getCertificate(t.CERT_AUTHENTICATION,o.RequestHandler.determineOptions(e,r))},t.prototype.nonRepudiationCertificate=function(e,r){return this.getCertificate(t.CERT_NON_REPUDIATION,o.RequestHandler.determineOptions(e,r))},t.prototype.rrnCertificate=function(e,r){return this.getCertificate(t.CERT_RRN,o.RequestHandler.determineOptions(e,r))},t.prototype.verifyPin=function(e,r){var n=this,o={private_key_reference:t.VERIFY_PRIV_KEY_REF};return e.pin&&(o.pin=e.pin),i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+a.GenericCertCard.VERIFY_PIN,o,void 0,r)})},t}(a.GenericCertCard);u.RN_DATA="/rn",u.ADDRESS="/address",u.PHOTO="/picture",u.VERIFY_PRIV_KEY_REF="non-repudiation",t.EidBe=u},function(e,t,r){"use strict";function n(e,t){return{filter:e.filter,pin:t}}function a(e){return{pin:e}}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(40),u=r(41),s=r(42),l=r(151),c=r(152),f=function(e){function t(t,r,n,a,i){var o=e.call(this,t,r,n,a)||this;return o.baseUrl=t,o.containerUrl=r,o.connection=n,o.reader_id=a,o.pin=i,o}return i(t,e),t.prototype.allDataFilters=function(){return["authentication-certificate","biometric","non-repudiation-certificate","picture","root-certificates"]},t.prototype.allCertFilters=function(){return["authentication-certificate","non-repudiation-certificate","root-certificates"]},t.prototype.allData=function(e,t){var r=c.RequestHandler.determineOptionsWithFilter(e);return this.connection.get(this.resolvedReaderURI(),n(r.params,this.pin)).then(function(e){return s.CertParser.process(e,r.parseCerts,t)},function(e){return l.ResponseHandler.error(e,t)})},t.prototype.allCerts=function(e,r){var a=c.RequestHandler.determineOptionsWithFilter(e);return this.connection.get(this.resolvedReaderURI()+t.ALL_CERTIFICATES,n(a.params,this.pin)).then(function(e){return s.CertParser.process(e,a.parseCerts,r)},function(e){return l.ResponseHandler.error(e,r)})},t.prototype.biometric=function(e){return this.connection.get(this.resolvedReaderURI()+t.BIOMETRIC,a(this.pin),e)},t.prototype.picture=function(e){return this.connection.get(this.resolvedReaderURI()+t.PHOTO,a(this.pin),e)},t.prototype.rootCertificate=function(e,r){return this.getCertificateArray(t.CERT_ROOT,c.RequestHandler.determineOptions(e,r),a(this.pin))},t.prototype.authenticationCertificate=function(e,r){return this.getCertificate(t.CERT_AUTHENTICATION,c.RequestHandler.determineOptions(e,r),a(this.pin))},t.prototype.nonRepudiationCertificate=function(e,r){return this.getCertificate(t.CERT_NON_REPUDIATION,c.RequestHandler.determineOptions(e,r),a(this.pin))},t.prototype.verifyPin=function(e,r){var n=this;return u.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.VERIFY_PIN,e,a(n.pin),r)})},t.prototype.signData=function(e,r){var n=this;return u.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.SIGN_DATA,e,a(n.pin),r)})},t.prototype.authenticate=function(e,r){var n=this;return u.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.AUTHENTICATE,e,a(n.pin),r)})},t.prototype.signatureImage=function(e){return this.connection.get(this.resolvedReaderURI()+t.SIGNATURE_IMAGE,a(this.pin),e)},t.prototype.getCertificate=function(e,r,n){var a=this;return u.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,n.pin).then(function(){return a.connection.get(a.resolvedReaderURI()+t.ALL_CERTIFICATES+e,n).then(function(e){return s.CertParser.process(e,r.parseCerts,r.callback)},function(e){return l.ResponseHandler.error(e,r.callback)})})},t.prototype.getCertificateArray=function(e,r,n){var a=this;return u.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,n.pin).then(function(){return a.connection.get(a.resolvedReaderURI()+t.ALL_CERTIFICATES+e,n).then(function(e){return s.CertParser.process(e,r.parseCerts,r.callback)},function(e){return l.ResponseHandler.error(e,r.callback)})})},t}(o.GenericSecuredCertCard);f.BIOMETRIC="/biometric",f.ADDRESS="/address",f.PHOTO="/picture",f.SIGNATURE_IMAGE="/signature-image",t.EidLux=f},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i="/card-issuing",o="/contracts",u="/picture",s="/status",l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.cardIssuing=function(e){return this.connection.get(this.resolvedReaderURI()+i,void 0,e)},t.prototype.contracts=function(e){return this.connection.get(this.resolvedReaderURI()+o,void 0,e)},t.prototype.picture=function(e){return this.connection.get(this.resolvedReaderURI()+u,void 0,e)},t.prototype.status=function(e){return this.connection.get(this.resolvedReaderURI()+s,void 0,e)},t}(a.GenericSmartCard);t.Mobib=l},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(152),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.rootCertificate=function(e,r){return this.getCertificate(t.CERT_ROOT,i.RequestHandler.determineOptions(e,r))},t.prototype.authenticationCertificate=function(e,r){return this.getCertificate(t.CERT_AUTHENTICATION,i.RequestHandler.determineOptions(e,r))},t.prototype.signingCertificate=function(e,r){return this.getCertificate(t.CERT_SIGNING,i.RequestHandler.determineOptions(e,r))},t}(a.GenericCertCard);t.LuxTrust=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(41),o=r(6),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.challenge=function(e,r){var n=this;return r&&"function"==typeof r?void i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.CHALLENGE,e,void 0,r)},function(e){return r(e,null)}):new o.Promise(function(r,a){i.PinEnforcer.check(n.connection,n.baseUrl,n.reader_id,e.pin).then(function(){r(n.connection.post(n.resolvedReaderURI()+t.CHALLENGE,e,void 0))},function(e){a(e)})})},t.prototype.readCounter=function(e,r){var n=this;return r&&"function"==typeof r?void i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.READ_COUNTER,e,void 0,r)},function(e){return r(e,null)}):new o.Promise(function(r,a){i.PinEnforcer.check(n.connection,n.baseUrl,n.reader_id,e.pin).then(function(){r(n.connection.post(n.resolvedReaderURI()+t.READ_COUNTER,e,void 0))},function(e){a(e)})})},t}(a.GenericPinCard);u.CHALLENGE="/challenge",u.READ_COUNTER="/read-counter",t.Ocra=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(41),o=r(152),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allDataFilters=function(){return["applet-info","root_certificate","authentication-certificate","encryption_certificate","issuer_certificate","signing_certificate"]},t.prototype.allCertFilters=function(){return["root_certificate","authentication-certificate","encryption_certificate","issuer_certificate","signing_certificate"]},t.prototype.allKeyRefs=function(){return["authenticate","sign","encrypt"]},t.prototype.rootCertificate=function(e,r){return this.getCertificate(t.CERT_ROOT,o.RequestHandler.determineOptions(e,r))},t.prototype.issuerCertificate=function(e,r){return this.getCertificate(t.CERT_ISSUER,o.RequestHandler.determineOptions(e,r))},t.prototype.authenticationCertificate=function(e,r){return this.getCertificate(t.CERT_AUTHENTICATION,o.RequestHandler.determineOptions(e,r))},t.prototype.signingCertificate=function(e,r){return this.getCertificate(t.CERT_SIGNING,o.RequestHandler.determineOptions(e,r))},t.prototype.encryptionCertificate=function(e,r){return this.getCertificate(t.CERT_ENCRYPTION,o.RequestHandler.determineOptions(e,r))},t.prototype.verifyPin=function(e,r){var n=this;return i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.VERIFY_PIN,e,void 0,r)})},t.prototype.resetPin=function(e,r){return this.connection.post(this.resolvedReaderURI()+t.RESET_PIN,e,void 0,r)},t}(a.GenericCertCard);u.DEFAULT_VERIFY_PIN="sign",u.RESET_PIN="/reset-pin",t.Aventra=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(41),o=r(152),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allDataFilters=function(){return["root_certificate","authentication-certificate","encryption_certificate","issuer_certificate","signing_certificate"]},t.prototype.allCertFilters=function(){return["root_certificate","authentication-certificate","encryption_certificate","issuer_certificate","signing_certificate"]},t.prototype.allKeyRefs=function(){return["authenticate","sign","encrypt"]},t.prototype.rootCertificate=function(e,r){return this.getCertificate(t.CERT_ROOT,o.RequestHandler.determineOptions(e,r))},t.prototype.issuerCertificate=function(e,r){return this.getCertificate(t.CERT_ISSUER,o.RequestHandler.determineOptions(e,r))},t.prototype.authenticationCertificate=function(e,r){return this.getCertificate(t.CERT_AUTHENTICATION,o.RequestHandler.determineOptions(e,r))},t.prototype.signingCertificate=function(e,r){return this.getCertificate(t.CERT_SIGNING,o.RequestHandler.determineOptions(e,r))},t.prototype.encryptionCertificate=function(e,r){return this.getCertificate(t.CERT_ENCRYPTION,o.RequestHandler.determineOptions(e,r));
},t.prototype.verifyPin=function(e,r){var n=this;return i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.VERIFY_PIN,e,void 0,r)})},t}(a.GenericCertCard);t.Oberthur=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(41),o=r(6),u=r(152),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.allDataFilters=function(){return["applet-info","root_certificate","authentication-certificate","encryption_certificate","issuer_certificate","signing_certificate"]},t.prototype.allCertFilters=function(){return["authentication-certificate","signing_certificate"]},t.prototype.allKeyRefs=function(){return["authenticate","sign","encrypt"]},t.prototype.printedInformation=function(e,r){var n=this;return r&&"function"==typeof r?void i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.PRINTED_INFORMATION,e,void 0,r)},function(e){return r(e,null)}):new o.Promise(function(r,a){i.PinEnforcer.check(n.connection,n.baseUrl,n.reader_id,e.pin).then(function(){r(n.connection.post(n.resolvedReaderURI()+t.PRINTED_INFORMATION,e,void 0))},function(e){a(e)})})},t.prototype.facialImage=function(e,r){var n=this;return r&&"function"==typeof r?void i.PinEnforcer.check(this.connection,this.baseUrl,this.reader_id,e.pin).then(function(){return n.connection.post(n.resolvedReaderURI()+t.FACIAL_IMAGE,e,void 0,r)},function(e){return r(e,null)}):new o.Promise(function(r,a){i.PinEnforcer.check(n.connection,n.baseUrl,n.reader_id,e.pin).then(function(){r(n.connection.post(n.resolvedReaderURI()+t.FACIAL_IMAGE,e,void 0))},function(e){a(e)})})},t.prototype.authenticationCertificate=function(e,r,n){return this.getCertificate(t.CERT_AUTHENTICATION,e,u.RequestHandler.determineOptions(r,n))},t.prototype.signingCertificate=function(e,r,n){return this.getCertificate(t.CERT_SIGNING,e,u.RequestHandler.determineOptions(r,n))},t}(a.GenericSecuredCertCard);s.PRINTED_INFORMATION="/printed-information",s.FACIAL_IMAGE="/facial-image",t.PIV=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var a=r(40),i=r(152),o=r(42),u=r(151),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.info=function(e){return this.connection.get(this.resolvedReaderURI()+t.INFO,void 0,e)},t.prototype.intermediateCertificate=function(e,r){var n=i.RequestHandler.determineOptions(e,r),a=this;return a.connection.get(a.resolvedReaderURI()+t.ALL_CERTIFICATES+t.CERT_INTERMEDIATE,void 0).then(function(e){return o.CertParser.process(e,n.parseCerts,n.callback)},function(e){return u.ResponseHandler.error(e,n.callback)})},t.prototype.authenticationCertificate=function(e,r,n){return this.getCertificate(t.CERT_AUTHENTICATION,e,i.RequestHandler.determineOptions(r,n))},t.prototype.signingCertificate=function(e,r,n){return this.getCertificate(t.CERT_SIGNING,e,i.RequestHandler.determineOptions(r,n))},t}(a.GenericSecuredCertCard);s.INFO="/info",t.DNI=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(42),i=r(151),o=r(5),u=r(152),s=function(){function e(t,r,n,a){this.baseUrl=t,this.containerUrl=r,this.connection=n,this.moduleConfig=a,o.os.family.indexOf("Win")>-1&&(this.os="win"),o.os.family.indexOf("OS X")>-1&&(this.os="mac"),this.os||(this.os="linux"),a&&a[this.os]?this.modulePath=a[this.os]:this.modulePath=e.DEFAULT_CONFIG[this.os]}return e.prototype.certificates=function(t,r,o){var s=this,l=n.extend(t,{module:this.modulePath}),c=u.RequestHandler.determineOptions(r,o);return this.connection.post(this.resolvedURI()+e.ALL_CERTIFICATES,l,void 0).then(function(e){return a.CertParser.process(e,c.parseCerts,c.callback)},function(r){if(s.moduleConfig){var o=n.extend(t,{module:e.DEFAULT_CONFIG[s.os]});return s.connection.post(s.resolvedURI()+e.ALL_CERTIFICATES,o,void 0).then(function(e){return a.CertParser.process(e,c.parseCerts,c.callback)},function(e){return i.ResponseHandler.error(e,c.callback)})}return i.ResponseHandler.error(r,c.callback)})},e.prototype.info=function(t){var r=this,n={module:this.modulePath};return this.connection.post(this.resolvedURI()+e.INFO,n,void 0).then(function(e){return i.ResponseHandler.response(e,t)},function(n){if(r.moduleConfig){var a={module:e.DEFAULT_CONFIG[r.os]};return r.connection.post(r.resolvedURI()+e.INFO,a,void 0,t)}return i.ResponseHandler.error(n,t)})},e.prototype.slots=function(t){var r=this,n={module:this.modulePath};return this.connection.post(this.resolvedURI()+e.SLOTS,n,void 0).then(function(e){return i.ResponseHandler.response(e,t)},function(n){if(r.moduleConfig){var a={module:e.DEFAULT_CONFIG[r.os]};return r.connection.post(r.resolvedURI()+e.SLOTS,a,void 0,t)}return i.ResponseHandler.error(n,t)})},e.prototype.slotsWithTokenPresent=function(t){var r=this,n={module:this.modulePath};return this.connection.post(this.resolvedURI()+e.SLOTS,n,{"token-present":"true"}).then(function(e){return i.ResponseHandler.response(e,t)},function(n){if(r.moduleConfig){var a={module:e.DEFAULT_CONFIG[r.os]};return r.connection.post(r.resolvedURI()+e.SLOTS,a,{"token-present":"true"},t)}return i.ResponseHandler.error(n,t)})},e.prototype.resolvedURI=function(){return this.baseUrl+this.containerUrl},e}();s.ALL_CERTIFICATES="/certificates",s.INFO="/info",s.SLOTS="/slots",s.DEFAULT_CONFIG={linux:"/usr/local/lib/libeTPkcs11.so",mac:"/usr/local/lib/libeTPkcs11.dylib",win:"C:\\Windows\\System32\\eTPKCS11.dll"},t.SafeNet=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),a=r(153),i=r(151),o=r(1),u=r(164),s=r(158),l=function(){function e(){}return e.authenticateCapable=function(e,t){return e.core().readersCardAvailable().then(this.checkCanAuthenticate).then(function(t){return{client:e,readers:t}}).then(this.filterByAvailableContainers).then(function(e){return i.ResponseHandler.response(e,t)}).catch(function(e){return i.ResponseHandler.error(e,t)})},e.signCapable=function(e,t){return e.core().readersCardAvailable().then(this.checkCanSign).then(function(t){return{client:e,readers:t}}).then(this.filterByAvailableContainers).then(function(e){return i.ResponseHandler.response(e,t)}).catch(function(e){return i.ResponseHandler.error(e,t)})},e.verifyPinCapable=function(e,t){return e.core().readersCardAvailable().then(this.checkCanVerifyPin).then(function(t){return{client:e,readers:t}}).then(this.filterByAvailableContainers).then(function(e){return i.ResponseHandler.response(e,t)}).catch(function(e){return i.ResponseHandler.error(e,t)})},e.authenticate=function(t,r,n,a){return this.checkPrerequisites(t,r,n).then(this.determineAlgorithm).then(e.doAuthenticate).then(function(e){return i.ResponseHandler.response(e,a)}).catch(function(e){return i.ResponseHandler.error(e,a)})},e.sign=function(t,r,n,a){return this.checkPrerequisites(t,r,n).then(this.determineAlgorithm).then(e.doSign).then(function(e){return i.ResponseHandler.response(e,a)}).catch(function(e){return i.ResponseHandler.error(e,a)})},e.verifyPin=function(t,r,n,a){return this.checkPrerequisites(t,r,n).then(e.doVerifyPin).then(function(e){return i.ResponseHandler.response(e,a)}).catch(function(e){return i.ResponseHandler.error(e,a)})},e.checkCanAuthenticate=function(e){return new n.Promise(function(t){e.data=o.filter(e.data,function(e){return u.CardUtil.canAuthenticate(e.card)}),t(e)})},e.checkCanSign=function(e){return new n.Promise(function(t){e.data=o.filter(e.data,function(e){return u.CardUtil.canSign(e.card)}),t(e)})},e.checkCanVerifyPin=function(e){return new n.Promise(function(t){e.data=o.filter(e.data,function(e){return u.CardUtil.canVerifyPin(e.card)}),t(e)})},e.filterByAvailableContainers=function(e){return e.client.core().plugins().then(function(t){return new n.Promise(function(r){e.readers.data=o.filter(e.readers.data,function(e){return o.find(t.data,function(t){return t.id===u.CardUtil.determineContainer(e.card)})}),r(e.readers)})})},e.checkPrerequisites=function(e,t,r){return e.core().readersCardAvailable().then(function(e){return{readerId:t,readers:e}}).then(this.checkReaderPresent).then(this.determineContainerForCard).then(function(t){return{client:e,container:t}}).then(this.checkContainerAvailable).then(function(e){return{client:e.client,readerId:t,container:e.container,data:r}})},e.checkReaderPresent=function(e){return new n.Promise(function(t,r){var n=o.find(e.readers.data,function(t){return t.id===e.readerId});n?t(n):r(e.readerId&&e.readerId.length?"No card found for this ID":"Reader ID is required.")})},e.checkContainerAvailable=function(e){return e.client.core().plugins().then(function(t){return new n.Promise(function(r,n){o.find(t.data,function(t){return t.id===e.container})?r(e):n("Container for this card is not available")})})},e.determineAlgorithm=function(e){return new n.Promise(function(t,r){e.data.algorithm_reference&&e.data.algorithm_reference.length||(e.data.algorithm_reference=u.CardUtil.defaultAlgo(e.container)),e.data.algorithm_reference?t(e):r("No algorithm reference provided and cannot determine default algorithm")})},e.determineContainerForCard=function(e){return new n.Promise(function(t,r){e&&e.card?t(u.CardUtil.determineContainer(e.card)):r("No card present in reader")})},e.doSign=function(e){return"luxeid"===e.container?e.client.luxeid(e.readerId,e.data.pin).signData(e.data):e.client[e.container](e.readerId).signData(e.data)},e.doAuthenticate=function(e){return"luxeid"===e.container?e.client.luxeid(e.readerId,e.data.pin).authenticate(e.data):e.client[e.container](e.readerId).authenticate(e.data)},e.doVerifyPin=function(e){if("luxeid"===e.container)return e.client.luxeid(e.readerId,e.data.pin).verifyPin(e.data);if("beid"===e.container){var t={pin:e.data.pin,private_key_reference:a.EidBe.VERIFY_PRIV_KEY_REF};return e.client.beid(e.readerId).verifyPin(t)}if("aventra"===e.container){var t={pin:e.data.pin,private_key_reference:s.Aventra.DEFAULT_VERIFY_PIN};return e.client.aventra(e.readerId).verifyPin(t)}return e.client[e.container](e.readerId).verifyPin(e.data)},e}();t.GenericService=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=function(){function e(){}return e.canAuthenticate=function(e){var t=this.determineContainer(e);switch(t){case"aventra":case"beid":case"dni":case"luxeid":case"luxtrust":case"oberthur":case"piv":return!0;case"ocra":case"emv":case"mobib":default:return!1}},e.canSign=function(e){var t=this.determineContainer(e);switch(t){case"aventra":case"beid":case"dni":case"luxeid":case"luxtrust":case"oberthur":case"piv":return!0;case"ocra":case"emv":case"mobib":default:return!1}},e.canVerifyPin=function(e){var t=this.determineContainer(e);switch(t){case"aventra":case"beid":case"dni":case"luxeid":case"luxtrust":case"oberthur":case"ocra":case"piv":return!0;case"emv":case"mobib":default:return!1}},e.determineContainer=function(e){function t(e,t){return!!n.find(e,function(e){return e.indexOf(t)>-1})}return n.isEmpty(e)||n.isEmpty(e.description)?void 0:t(e.description,"Belgium Electronic ID card")?"beid":t(e.description,"Grand Duchy of Luxembourg / Identity card with LuxTrust certificate (eID)")?"luxeid":t(e.description,"LuxTrust card")?"luxtrust":t(e.description,"Juridic Person's Token (PKI)")?"ocra":t(e.description,"MOBIB")?"mobib":t(e.description,"Mastercard")?"emv":t(e.description,"Oberthur")?"oberthur":t(e.description,"Aventra")?"aventra":void 0},e.defaultAlgo=function(e){switch(e){case"aventra":case"beid":case"dni":case"oberthur":case"piv":case"luxeid":case"luxtrust":return"sha256";default:return}},e}();t.CardUtil=a}]);
//# sourceMappingURL=GCLLib.min.js.map